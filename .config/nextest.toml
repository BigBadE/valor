# Enable experimental setup scripts
experimental = ["setup-scripts"]

# Define Chrome startup script
[scripts.setup.chrome]
command = "bash scripts/start-chrome.sh"
slow-timeout = { period = "30s" }

[profile.default]
# Run tests in parallel with reasonable thread count
test-threads = 4

# Set timeout for individual tests (chromium tests can be slow)
slow-timeout = { period = "60s", terminate-after = 3 }

# Retry flaky tests
retries = 0

# Show output for failing tests
status-level = "fail"
final-status-level = "fail"

# Run Chrome setup script before chromium tests
[[profile.default.scripts]]
filter = "binary(chromium_tests)"
setup = "chrome"

[profile.ci]
# More conservative settings for CI
test-threads = 2
retries = 1
slow-timeout = { period = "90s", terminate-after = 2 }
