<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <title>Storage Timing</title>
  <style> html, body { margin:0; padding:0; } </style>
</head>
<body>
  <script>
    window._valorRun = async function() {
      try {
        // Use performance.now() for monotonic timing and simple ordering assertions.
        const t0 = performance.now();
        localStorage.setItem('k', 'v');
        const got = localStorage.getItem('k');
        const t1 = performance.now();
        sessionStorage.setItem('s', '1');
        const sgot = sessionStorage.getItem('s');
        const t2 = performance.now();
        _valorAssert('localStorage roundtrip', got === 'v', 'got='+got);
        _valorAssert('sessionStorage roundtrip', sgot === '1', 'sgot='+sgot);
        _valorAssert('timing monotonic', t0 <= t1 && t1 <= t2, `t0=${t0}, t1=${t1}, t2=${t2}`);
      } catch (e) {
        _valorAssert('storage-timing-exception', false, String(e && e.stack || e));
      }
    };
  </script>
</body>
</html>
