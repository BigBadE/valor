# Layouter — Spec Coverage Map (CSS 2.2)

Primary spec: https://www.w3.org/TR/CSS22/

## Scope and maturity

- Status: [Production] with targeted [Approximation]/[TODO] items tracked below.
- Non-production items and caveats:
  - [Approximation] BFC detection is implemented and used; continue to expand test coverage across edge scenarios.
  - [MVP] Inline formatting context and anonymous block synthesis are owned by the inline/text module and Display reorg; Core assumes block-level children.
  - [MVP] Positioned layout beyond relative (absolute/fixed/sticky) is owned by the `position` module; Core provides integration points.
  - [TODO] Box-sizing edge cases (see below under §10.3.3/§10.6.3) to be fully locked by fixtures.

## One-to-one spec mapping

This spec uses integrated per-section status/mapping blocks adjacent to the verbatim spec below. Any additional module-specific notes and TODOs are summarized here to avoid duplicate checklists.

- §10.3.3 Widths of non-replaced blocks — [Production] with caveats
  - [Production] Specified width + auto margins with `box-sizing` conversion: implemented auto margin resolution in the specified-width path.
  - [Approximation] Percent min/max width in content-box with nested containers: conversion and resolution covered in code, expand fixtures.
  - [Approximation] Over-constraint clamping (padding+border vs available width): keep asserts/fixtures to stabilize.
  - Code: `10_visual_details/part_10_3_3_block_widths.rs::{solve_block_horizontal, used_border_box_width, compute_width_constraints, resolve_with_constrained_width, resolve_auto_width}`; parser flags at `css/orchestrator/src/style.rs::apply_edges_and_borders` and model fields `css/orchestrator/src/style_model.rs::ComputedStyle.{margin_left_auto,margin_right_auto}`

- §10.6.3 Heights of non-replaced blocks — [Production] with caveats
  - [Production] Percent/relative heights: root percent resolved to viewport; non-root percent resolved when parent has definite specified height (px); percent min/max constraints applied. Parsing fields in `css/orchestrator/src/style_model.rs::ComputedStyle.{height_percent,min_height_percent,max_height_percent}` with parsing in `css/orchestrator/src/style.rs::apply_dimensions`.
  - [Approximation] `box-sizing` conversions for min/max height under padding/border; expand fixtures.
  - Code: `10_visual_details/part_10_6_3_height_of_blocks.rs::{compute_used_height, compute_child_content_height, compute_root_heights}`

---

## Verbatim Spec (CSS 2.2)

Note: This module embeds and annotates only the parts of CSS 2.2 that are relevant to the layouter:
- Chapters 8–10 (Box model; Visual formatting model; Visual formatting model details).
- Other chapters (e.g., Selectors, Cascade, Syntax, Values & Units, UI) are superseded or owned by their dedicated modules/specs (e.g., Selectors Level 3) and are intentionally not covered here.

Legal notice (required for embedded spec text):

```
$name_of_software: $distribution_URI
Copyright © [$year-of-software] World Wide Web Consortium. All Rights Reserved. This work is distributed under the W3C® Software and Document License [1] in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
[1] https://www.w3.org/Consortium/Legal/copyright-software
```

Begin embedded normative text below (exclude Abstract, Status, general Introduction). Keep chapters in spec order, and clearly indicate the source spec version and URL.

<!-- BEGIN VERBATIM SPEC: DO NOT EDIT BELOW. This block is auto-generated by scripts/vendor_display_spec.ps1 -->

<BODY>
 

<H1>8 <a name="box-model">Box model</a></H1>


<P>The CSS box model describes the rectangular boxes that are
generated for elements in the <a href="conform.html#doctree">document
tree</a> and laid out according to the <a href="visuren.html">visual formatting
model</a>.

<H2>8.1 <a name="box-dimensions">Box dimensions</a></H2>
<div data-valor-status="box-dimensions">
 <p><strong>Status:</strong> [Production]</p>
 <p><strong>Code:</strong> <code>10_visual_details/part_10_3_3_block_widths.rs::solve_block_horizontal</code>, <code>src/sizing.rs</code></p>
 <p><strong>Spec:</strong> https://www.w3.org/TR/CSS22/box.html#box-dimensions</p>
 <p><strong>Fixtures:</strong> <code>crates/css/modules/box/tests/fixtures/layout/box/margins_padding_borders.html</code></p>
</div>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<P>Each box has a
<span class="index-def" title="box::content|content::of a box">
<a name="box-content-area"><dfn>content area</dfn></a></span> (e.g.,
text, an image, etc.) and optional surrounding 
<span class="index-def" title="box::padding|padding::of a box">
<a name="box-padding-area"><dfn>padding</dfn></a></span>,
<span class="index-def" title="box::border|border::of a box">
<a name="box-border-area"><dfn>border</dfn></a></span>, and 
<span class="index-def" title="box::margin|margin::of a box">
<a name="box-margin-area"><dfn>margin</dfn></a></span> areas; the size
of each area is specified by properties defined below.  The following
diagram shows how these areas relate and the terminology used to refer
to pieces of margin, border, and padding:</P>

<div class="figure">
<P><img src="./images/boxdim.png"
     alt="Image illustrating the relationship between content, padding, borders, and margins."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-boxdim" href="images/longdesc/boxdim-desc.html" title="Long description of illustration of box areas">[D]</A></SPAN></P>
</div>

<P>The margin, border, and padding can be broken down into top, right,
bottom, and left segments (e.g., in the diagram, "LM" for left margin,
"RP" for right padding, "TB" for top border, etc.).

<P>The perimeter of each of the four areas (content, padding, border,
and margin) is called an "edge", so each box has four edges:</P>

<dl>
<dt><span class="index-def"
title="content edge"><a name="content-edge"><strong>content edge</strong></a></span>
or <span class="index-def" title="inner edge"><a name="inner-edge"><strong>inner edge</strong></a></span>
<dd>The content edge surrounds the rectangle given by the <a
href="visudet.html#Computing_widths_and_margins">width</a> and <a
href="visudet.html#Computing_heights_and_margins">height</a>
of the box, which often depend on the element's <a
href="conform.html#rendered-content">rendered content</a>.
The four content edges define the
box's <dfn><a name="x10"><span class="index-def">content box</span></a></dfn>.
<dt><span class="index-def" title="padding edge"><a name="padding-edge"><strong>padding edge</strong></a></span>
<dd>The padding edge surrounds the box padding. If the padding
has 0 width, the padding edge is the same as the content edge.
The four padding edges define the
box's <dfn><a name="x12"><span class="index-def">padding box</span></a></dfn>.
<dt><span class="index-def" title="border edge"><a name="border-edge"><strong>border edge</strong></a></span>
<dd>The border edge surrounds the box's border. If the border
has 0 width, the border edge is the same as the padding edge.
The four border edges define the box's <dfn><a name="x14"><span class="index-def">border
box</span></a></dfn>.
<dt><span class="index-def" title="margin edge"><a name="margin-edge"><strong>margin edge</strong></a></span>
or <span class="index-def" title="outer edge"><a name="outer-edge"><strong>outer
edge</strong></a></span>
<dd>The margin edge surrounds the box margin. If the margin
has 0 width, the margin edge is the same as the border edge.
The four margin edges define the box's <dfn><a name="x17"><span class="index-def">margin
box</span></a></dfn>.
</dl>

<P>Each edge may be broken down into a top, right, bottom, and left
edge.

<P>The dimensions of the content area of a box &mdash; the <span
class="index-def" title="box::content width"><a
name="content-width"><dfn>content width</dfn></a></span> and <span
class="index-def" title="box::content height"><a
name="content-height"><dfn>content height</dfn></a></span> &mdash; 
depend on several factors: whether the element generating
the box has the <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>
or <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a> property
set, whether the box contains text or other boxes, whether the
box is a table, etc. Box widths and heights are discussed
in the chapter on <a href="visudet.html">visual formatting
model details</a>.

<P>The background style of the content, padding, and border areas of a
box is specified by the <a href="colors.html#propdef-background" class="noxref"><span
class="propinst-background">'background'</span></a> property of the
generating element. Margin backgrounds are always transparent.

</details>
<H2>8.2 <a name="mpb-examples">Example of margins, padding, and borders</a></H2>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<P>This example illustrates how margins, padding, and borders
interact. The example HTML document:

<pre class="html example">
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"&gt;
&lt;HTML&gt;
  &lt;HEAD&gt;
    &lt;TITLE&gt;Examples of margins, padding, and borders&lt;/TITLE&gt;
    &lt;STYLE type="text/css"&gt;
      UL { 
        background: yellow; 
        margin: 12px 12px 12px 12px;
        padding: 3px 3px 3px 3px;
                                     /* No borders set */
      }
      LI { 
        color: white;                /* text color is white */ 
        background: blue;            /* Content, padding will be blue */
        margin: 12px 12px 12px 12px;
        padding: 12px 0px 12px 12px; /* Note 0px padding right */
        list-style: none             /* no glyphs before a list item */
                                     /* No borders set */
      }
      LI.withborder {
        border-style: dashed;
        border-width: medium;        /* sets border width on all sides */
        border-color: lime;
      }
    &lt;/STYLE&gt;
  &lt;/HEAD&gt;
  &lt;BODY&gt;
    &lt;UL&gt;
      &lt;LI&gt;First element of list
      &lt;LI class="withborder"&gt;Second element of list is
           a bit longer to illustrate wrapping.
    &lt;/UL&gt;
  &lt;/BODY&gt;
&lt;/HTML&gt;
</pre>

<P>results in a <a href="conform.html#doctree">document tree</a> with
(among other relationships) a UL element that has two LI
children. 

<P>The first of the following diagrams illustrates what this example
would produce. The second illustrates the relationship between the
margins, padding, and borders of the UL elements and those of its
children LI elements. (Image is not to scale.)</P>

<div class="figure">
<P><img src="./images/boxdimeg.png"
     alt="Image illustrating how parent and child margins, borders,
and padding relate."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-boxdimeg" href="images/longdesc/boxdimeg-desc.html" title="Long description of list box example showing margins,
padding, and borders">[D]</A></SPAN></p>
</div>

<P>Note that:</p>

<ul>

<li>The <a href="#content-width">content width</a> for each LI box is
calculated top-down; the <a href="visuren.html#containing-block">containing
block</a> for each LI box is established by the UL element.

<li>The margin box height of each LI box depends on its <a
href="#content-height">content height</a>, plus top and bottom
padding, borders, and margins. Note that vertical margins between the
LI boxes <a href="#collapsing-margins">collapse.</a>

<li>The right padding of the LI boxes has been set to zero width
(the <a href="box.html#propdef-padding" class="noxref"><span class="propinst-padding">'padding'</span></a> property). The
effect is apparent in the second illustration.

<li>The margins of the LI boxes are transparent &mdash; margins are always
transparent &mdash; so the background color (yellow) of the UL padding and
content areas shines through them. 

<li>The second LI element specifies a dashed border (the
<a href="box.html#propdef-border-style" class="noxref"><span class="propinst-border-style">'border-style'</span></a> property).
</ul>

</details>
<H2>8.3 <a name="margin-properties">Margin properties</a>:
<a href="box.html#propdef-margin-top" class="noxref"><span class="propinst-margin-top">'margin-top'</span></a>, 
<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a>, 
<a href="box.html#propdef-margin-bottom" class="noxref"><span class="propinst-margin-bottom">'margin-bottom'</span></a>,
<a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a>, and
<a href="box.html#propdef-margin" class="noxref"><span class="propinst-margin">'margin'</span></a></H2>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<P>Margin properties specify the width of the <a
href="#box-margin-area">margin area</a> of a box.  The <a href="box.html#propdef-margin" class="noxref"><span
class="propinst-margin">'margin'</span></a> shorthand property sets the
margin for all four sides while the other margin properties only set
their respective side.  These properties apply to all elements, but
vertical margins will not have any effect on non-replaced inline
elements.

<P>The properties defined in this section refer to the <span
class="index-def" title="&lt;margin-width&gt;::definition of"><a
name="value-def-margin-width"><strong>&lt;margin-width&gt;</strong></a></span>
value type, which may take one of the following values:</p>

<dl>
<dt><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></a>
<dd>Specifies a fixed width.
<dt><a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></a>
<dd>The percentage is calculated
with respect to the <em>width</em> of the generated box's 
<a href="visuren.html#containing-block">containing block</a>.
<span class="note">Note that this is true for <a href="box.html#propdef-margin-top" class="noxref"><span
class="propinst-margin-top">'margin-top'</span></a> and <a href="box.html#propdef-margin-bottom" class="noxref"><span
class="propinst-margin-bottom">'margin-bottom'</span></a> as well.</span>
If the containing block's width depends on this element, then the
resulting layout is undefined in CSS&nbsp;2.2.
<dt><strong>auto</strong>
<dd>See the section on <a
href="visudet.html#Computing_widths_and_margins">calculating widths and 
margins</a> for behavior.
</dl>

<P>Negative values for margin properties are allowed, but there may be
implementation-specific limits. 

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x21"><span class="index-def" title="'margin-top'"><dfn id="propdef-margin-top">margin-top</dfn></span></a>, <a name="x22"><span class="index-def" title="'margin-bottom'"><dfn id="propdef-margin-bottom">margin-bottom</dfn></span></a><tr><th>Value:<td><a href="box.html#value-def-margin-width" class="noxref"><span class="value-inst-margin-width">&lt;margin-width&gt;</span></a> | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>0
<tr><th>Applies to:<td>all elements except elements with table display
    types other than table-caption, table and inline-table
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>refer to width of containing block
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>the percentage as specified or the absolute length
</table>

<p class="note">These properties have no effect on non-replaced inline
elements.</p>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x23"><span class="index-def" title="'margin-right'"><dfn id="propdef-margin-right">margin-right</dfn></span></a>, <a name="x24"><span class="index-def" title="'margin-left'"><dfn id="propdef-margin-left">margin-left</dfn></span></a><tr><th>Value:<td><a href="box.html#value-def-margin-width" class="noxref"><span class="value-inst-margin-width">&lt;margin-width&gt;</span></a> | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>0
<tr><th>Applies to:<td>all elements except elements with table display
    types other than table-caption, table and inline-table
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>refer to width of containing block
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>the percentage as specified or the absolute length
</table>

<P>These properties set the top, right, bottom, and left margin of a
box.

<div class="example"><P style="display:none">Example(s):</P><P>
<PRE>
h1 { margin-top: 2em }
</PRE>
</div>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x25"><span class="index-def" title="'margin'"><dfn id="propdef-margin">margin</dfn></span></a><tr><th>Value:<td><a href="box.html#value-def-margin-width" class="noxref"><span class="value-inst-margin-width">&lt;margin-width&gt;</span></a>{1,4} | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>see individual properties
<tr><th>Applies to:<td>all elements except elements with table display
    types other than table-caption, table and inline-table
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>refer to width of containing block
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>see individual properties
</table>

<P> The <a href="box.html#propdef-margin" class="noxref"><span class="propinst-margin">'margin'</span></a> property is a
shorthand property for setting <a href="box.html#propdef-margin-top" class="noxref"><span
class="propinst-margin-top">'margin-top'</span></a>, <a href="box.html#propdef-margin-right" class="noxref"><span
class="propinst-margin-right">'margin-right'</span></a>, <a href="box.html#propdef-margin-bottom" class="noxref"><span
class="propinst-margin-bottom">'margin-bottom'</span></a>, and <a href="box.html#propdef-margin-left" class="noxref"><span
class="propinst-margin-left">'margin-left'</span></a> at the same place in
the style sheet.

<P> If there is only one component value, it applies to all
sides. If there are two values, the top and bottom margins
are set to the first value and the right and left margins are
set to the second. If there are three values, the top is
set to the first value, the left and right are set to the
second, and the bottom is set to the third. If there are
four values, they apply to the top, right, bottom, and left,
respectively.

<div class="example"><P style="display:none">Example(s):</P><P>
<PRE>
body { margin: 2em }         /* all margins set to 2em */
body { margin: 1em 2em }     /* top &amp; bottom = 1em, right &amp; left = 2em */
body { margin: 1em 2em 3em } /* top=1em, right=2em, bottom=3em, left=2em */
</PRE>

<P> The last rule of the example above is equivalent to the example
below:

<PRE>
body {
  margin-top: 1em;
  margin-right: 2em;
  margin-bottom: 3em;
  margin-left: 2em;        /* copied from opposite side (right) */
}
</PRE>
</div>

</details>
<H3>8.3.1 <a name="collapsing-margins">Collapsing margins</a></H3>
<div data-valor-status="collapsing-margins">
 <p><strong>Status:</strong> [Production]</p>
 <p><strong>Code:</strong> <code>8_box_model/part_8_3_1_collapsing_margins.rs::apply_leading_top_collapse_public</code>, <code>8_box_model/part_8_3_1_collapsing_margins.rs::collapse_margins_pair</code>, <code>8_box_model/part_8_3_1_collapsing_margins.rs::collapse_margins_list</code>, <code>8_box_model/part_8_3_1_collapsing_margins.rs::compute_margin_bottom_out</code>, <code>8_box_model/part_8_3_1_collapsing_margins.rs::compute_first_placed_empty_margin_bottom</code></p>
 <p><strong>Spec:</strong> https://www.w3.org/TR/CSS22/box.html#collapsing-margins</p>
 <p><strong>Fixtures:</strong> multiple under <code>crates/css/modules/box/tests/fixtures/layout/box/</code></p>
</div>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<P>In CSS, the adjoining margins of two or more boxes (which might or
might not be siblings) can combine to form a single margin. Margins
that combine this way are said to <dfn><a name="x26"><span
class="index-def">collapse</span></a></dfn>, and the
resulting combined margin is called a <dfn><a name="x27"><span class="index-def"
title="collapsing margin">collapsed margin</span></a></dfn>.

<P>Adjoining vertical margins collapse, except:

<UL>
  <LI>Margins of the root element's box do not collapse.

  <LI>If the top and bottom margins of an element with <a
  href="visuren.html#clearance">clearance</a> are adjoining, its
  margins collapse with the adjoining margins of following siblings
  but that resulting margin does not collapse with the bottom margin
  of the parent block.

  <LI>If the top margin of a box with non-zero computed
  'min-height' and 'auto' computed 'height' collapses with the
  bottom margin of its last in-flow child, then the child's bottom
  margin does not collapse with the parent's bottom margin.
</UL>

<P>Horizontal margins never collapse.

<P ID="what-is-adjoining">Two margins are <a name="x28"><span class="index-def"
title="adjoining margins"><DFN>adjoining</DFN></span></a> if and only if:

<UL>
  <LI>both belong to in-flow <a
  href="visuren.html#block-boxes">block-level boxes</a> that
  participate in the same <a
  href="visuren.html#block-formatting">block formatting context</a>

  <LI>no line boxes, no clearance, no padding and no border separate
  them <span class="note">(Note that <a
  href="visuren.html#phantom-line-box">certain zero-height line
  boxes</a> (see <a href="visuren.html#inline-formatting">9.4.2</a>)
  are ignored for this purpose.)</span>

  <LI>both belong to vertically-adjacent box edges, i.e. form one of
  the following pairs:

  <UL>
    <LI>top margin of a box and top margin of its first in-flow child

    <LI>bottom margin of box and top margin of its next in-flow
    following sibling

    <LI>bottom margin of a last in-flow child and bottom margin of its
    parent if the parent has 'auto' computed height

    <LI>top and bottom margins of a box that does not establish a new
    block formatting context and that has zero computed <a href="visudet.html#propdef-min-height" class="noxref"><span
    class="propinst-min-height">'min-height'</span></a>, zero or 'auto'
    computed <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>, and no
    in-flow children
  </UL>
</UL>

<P>A collapsed margin is considered adjoining to another margin if any
of its component margins is adjoining to that margin.

<P CLASS=note><STRONG>Note.</STRONG> Adjoining margins can be
generated by elements that are not related as siblings or ancestors.

<DIV CLASS=note>
<P><STRONG>Note</STRONG> the above rules imply that:

<UL>
  <LI>Margins between a <a href="visuren.html#floats">floated</a> box
  and any other box do not collapse (not even between a float and its
  in-flow children).

  <LI>Margins of elements that establish new block formatting contexts
  (such as floats and elements with <a href="visufx.html#propdef-overflow" class="noxref"><span
  class="propinst-overflow">'overflow'</span></a> other than 'visible') do
  not collapse with their in-flow children.

  <LI>Margins of <a
  href="visuren.html#absolutely-positioned">absolutely positioned</a>
  boxes do not collapse (not even with their in-flow children).

  <LI>Margins of inline-block boxes do not collapse (not even with
  their in-flow children).

  <LI>The bottom margin of an in-flow block-level element always
  collapses with the top margin of its next in-flow block-level
  sibling, unless that sibling has clearance.

  <LI>The top margin of an in-flow block element collapses with its
  first in-flow block-level child's top margin if the element has no
  top border, no top padding, and the child has no clearance.

  <LI>The bottom margin of an in-flow block box with a 'height' of
  'auto' collapses with its last in-flow block-level child's bottom
  margin, if:
   <UL>
      <LI>the box has no bottom padding, and
      <LI>the box has no bottom border, and
      <LI>the child's bottom margin neither collapses with a top margin
           that has clearance, nor (if the box's min-height is non-zero)
           with the box's top margin.
   </UL>

  <LI>A box's own margins collapse if the <a href="visudet.html#propdef-min-height" class="noxref"><span
  class="propinst-min-height">'min-height'</span></a> property is zero,
  and it has neither top or bottom borders nor top or bottom padding,
  and it has a <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a> of either
  0 or 'auto', and it does not contain a line box, and all of its
  in-flow children's margins (if any) collapse.
</UL>
</DIV>

<P>When two or more margins collapse, the resulting margin width is
the maximum of the collapsing margins' widths. In the case of negative
margins, the maximum of the absolute values of the negative adjoining
margins is deducted from the maximum of the positive adjoining
margins.  If there are no positive margins, the maximum of the
absolute values of the adjoining margins is deducted from zero.

<P ID="collapsed-through">If the top and bottom margins of a box are
adjoining, then it is possible for margins to <DFN><a name="x29"><span
class="index-def">collapse through</span></a></DFN> it. In this case,
the position of the element depends on its relationship with the other
elements whose margins are being collapsed.

<UL>
  <LI>If the element's margins are collapsed with its parent's top
  margin, the top border edge of the box is defined to be the same as
  the parent's.

  <LI>Otherwise, either the element's parent is not taking part in the
  margin collapsing, or only the parent's bottom margin is
  involved. The position of the element's top border edge is the same
  as it would have been if the element had a non-zero bottom border.
</UL>

<P>Note that the positions of elements that have been collapsed
through have no effect on the positions of the other elements with
whose margins they are being collapsed; the top border edge position
is only required for laying out descendants of these elements.

</details>
<H2>8.4 <a name="padding-properties">Padding properties</a>:
<a href="box.html#propdef-padding-top" class="noxref"><span class="propinst-padding-top">'padding-top'</span></a>,
<a href="box.html#propdef-padding-right" class="noxref"><span class="propinst-padding-right">'padding-right'</span></a>,
<a href="box.html#propdef-padding-bottom" class="noxref"><span class="propinst-padding-bottom">'padding-bottom'</span></a>,
<a href="box.html#propdef-padding-left" class="noxref"><span class="propinst-padding-left">'padding-left'</span></a>, and
<a href="box.html#propdef-padding" class="noxref"><span class="propinst-padding">'padding'</span></a>
</H2>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<P>The padding properties specify the width of the <a
href="#box-padding-area">padding area</a> of a box. The <a href="box.html#propdef-padding" class="noxref"><span
class="propinst-padding">'padding'</span></a> shorthand property sets the
padding for all four sides while the other padding properties only set
their respective side. 

<P>The properties defined in this section refer to the <span
class="index-def" title="&lt;padding-width&gt;::definition of"><a
name="value-def-padding-width"><strong>&lt;padding-width&gt;</strong>
</a></span> value type, which may take one of the following values:</p>

<dl>
<dt><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></a>
<dd>Specifies a fixed width.
<dt><a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></a>
<dd>The percentage is calculated with
respect to the <em>width</em> of the generated box's <a
href="visuren.html#containing-block">containing block</a>, even for
<a href="box.html#propdef-padding-top" class="noxref"><span class="propinst-padding-top">'padding-top'</span></a> and <a href="box.html#propdef-padding-bottom" class="noxref"><span
class="propinst-padding-bottom">'padding-bottom'</span></a>.
If the containing block's width depends on this element, then the
resulting layout is undefined in CSS&nbsp;2.2.
</dl>

<P>Unlike margin properties, values for padding values cannot be
negative. Like margin properties, percentage values for padding
properties refer to the width of the generated box's containing block.

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x31"><span class="index-def" title="'padding-top'"><dfn id="propdef-padding-top">padding-top</dfn></span></a>, <a name="x32"><span class="index-def" title="'padding-right'"><dfn id="propdef-padding-right">padding-right</dfn></span></a>, <a name="x33"><span class="index-def" title="'padding-bottom'"><dfn id="propdef-padding-bottom">padding-bottom</dfn></span></a>, <a name="x34"><span class="index-def" title="'padding-left'"><dfn id="propdef-padding-left">padding-left</dfn></span></a><tr><th>Value:<td><a href="box.html#value-def-padding-width" class="noxref"><span class="value-inst-padding-width">&lt;padding-width&gt;</span></a> | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>0
<tr><th>Applies to:<td>all elements except table-row-group, table-header-group, table-footer-group, table-row, table-column-group and table-column
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>refer to width of containing block
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>the percentage as specified or the absolute length
</table>

<P>These properties set the top, right, bottom, and left padding of
a box.

<div class="example"><P style="display:none">Example(s):</P><P>
<PRE>
blockquote { padding-top: 0.3em }
</PRE>
</div>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x35"><span class="index-def" title="'padding'"><dfn id="propdef-padding">padding</dfn></span></a><tr><th>Value:<td><a href="box.html#value-def-padding-width" class="noxref"><span class="value-inst-padding-width">&lt;padding-width&gt;</span></a>{1,4} | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>see individual properties
<tr><th>Applies to:<td>all elements except table-row-group, table-header-group, table-footer-group, table-row, table-column-group and table-column
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>refer to width of containing block
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>see individual properties
</table>

<P> The <a href="box.html#propdef-padding" class="noxref"><span class="propinst-padding">'padding'</span></a> property is a
shorthand property for setting <a href="box.html#propdef-padding-top" class="noxref"><span
class="propinst-padding-top">'padding-top'</span></a>, <a href="box.html#propdef-padding-right" class="noxref"><span
class="propinst-padding-right">'padding-right'</span></a>, <a href="box.html#propdef-padding-bottom" class="noxref"><span
class="propinst-padding-bottom">'padding-bottom'</span></a>, and <a href="box.html#propdef-padding-left" class="noxref"><span
class="propinst-padding-left">'padding-left'</span></a> at the same place
in the style sheet.

<P> If there is only one component value, it applies to all
sides. If there are two values, the top and bottom paddings
are set to the first value and the right and left paddings are
set to the second. If there are three values, the top is
set to the first value, the left and right are set to the
second, and the bottom is set to the third. If there are
four values, they apply to the top, right, bottom, and left,
respectively.

<P> The surface color or image of the padding area is specified via
the <a href="colors.html#propdef-background" class="noxref"><span class="propinst-background">'background'</span></a> property:

<div class="example"><P style="display:none">Example(s):</P><P>
<PRE>
h1 { 
  background: white; 
  padding: 1em 2em;
} 
</PRE>

<P> The example above specifies a '1em' vertical padding (<a href="box.html#propdef-padding-top" class="noxref"><span
class="propinst-padding-top">'padding-top'</span></a> and <a href="box.html#propdef-padding-bottom" class="noxref"><span
class="propinst-padding-bottom">'padding-bottom'</span></a>) and a '2em'
horizontal padding (<a href="box.html#propdef-padding-right" class="noxref"><span
class="propinst-padding-right">'padding-right'</span></a> and <a href="box.html#propdef-padding-left" class="noxref"><span
class="propinst-padding-left">'padding-left'</span></a>). The 'em' unit is
<a href="syndata.html#absrel-units">relative</a> 
to the element's font size: '1em' is equal to the size of the
font in use.
</div>

</details>
<H2>8.5 <a name="border-properties">Border properties</a></H2>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<P>The border properties specify the width, color, and style of the <a
href="#box-border-area">border area</a> of a box. These properties
apply to all elements.


<div class="note"><P>
<em><strong>Note.</strong>
Notably for HTML, 
user agents may render borders for certain user interface elements (e.g.,
buttons, menus, etc.) differently than for
"ordinary" elements.
</em>
</div>

</details>
<H3>8.5.1 <a name="border-width-properties">Border width</A>: <a href="box.html#propdef-border-top-width" class="noxref"><span
class="propinst-border-top-width">'border-top-width'</span></a>, <a href="box.html#propdef-border-right-width" class="noxref"><span
class="propinst-border-right-width">'border-right-width'</span></a>, <a href="box.html#propdef-border-bottom-width" class="noxref"><span
class="propinst-border-bottom-width">'border-bottom-width'</span></a>,
<a href="box.html#propdef-border-left-width" class="noxref"><span class="propinst-border-left-width">'border-left-width'</span></a>, and
<a href="box.html#propdef-border-width" class="noxref"><span class="propinst-border-width">'border-width'</span></a></H3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<P>The border width properties specify the width of the <a
href="#box-border-area">border area</a>.  The properties
defined in this section refer to the <span class="index-def"
title="&lt;border-width&gt;::definition of"><a
name="value-def-border-width"
class="value-def"><strong>&lt;border-width&gt;</strong></a></span>
value type, which may take one of the following values:</P>

<dl>
<dt><strong>thin</strong>
<dd>A thin border.
<dt><strong>medium</strong>
<dd>A medium border.
<dt><strong>thick</strong>
<dd>A thick border.
<dt><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></a>
<dd>The border's thickness has an explicit value. Explicit
border widths cannot be negative.
</dl>

<P>The interpretation of the first three values depends on the user
agent. The following relationships must hold, however:

<P>'thin' &lt;='medium' &lt;= 'thick'.  

<P>Furthermore, these widths must be constant throughout a document.

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x37"><span class="index-def" title="'border-top-width'"><dfn id="propdef-border-top-width">border-top-width</dfn></span></a>, <a name="x38"><span class="index-def" title="'border-right-width'"><dfn id="propdef-border-right-width">border-right-width</dfn></span></a>, <a name="x39"><span class="index-def" title="'border-bottom-width'"><dfn id="propdef-border-bottom-width">border-bottom-width</dfn></span></a>, <a name="x40"><span class="index-def" title="'border-left-width'"><dfn id="propdef-border-left-width">border-left-width</dfn></span></a><tr><th>Value:<td><a href="box.html#value-def-border-width" class="noxref"><span class="value-inst-border-width">&lt;border-width&gt;</span></a> | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>medium
<tr><th>Applies to:<td>all elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>absolute length; '0' if the border style is 'none' or 'hidden'
</table>

<P>These properties set the width of the top, right, bottom,
and left border of a box.

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x41"><span class="index-def" title="'border-width'"><dfn id="propdef-border-width">border-width</dfn></span></a><tr><th>Value:<td><a href="box.html#value-def-border-width" class="noxref"><span class="value-inst-border-width">&lt;border-width&gt;</span></a>{1,4} | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>see individual properties
<tr><th>Applies to:<td>all elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>see individual properties
</table>

<P> This property is a shorthand property for setting
<a href="box.html#propdef-border-top-width" class="noxref"><span class="propinst-border-top-width">'border-top-width'</span></a>, 
<a href="box.html#propdef-border-right-width" class="noxref"><span class="propinst-border-right-width">'border-right-width'</span></a>, 
<a href="box.html#propdef-border-bottom-width" class="noxref"><span class="propinst-border-bottom-width">'border-bottom-width'</span></a>,
 and
<a href="box.html#propdef-border-left-width" class="noxref"><span class="propinst-border-left-width">'border-left-width'</span></a> at
the same place in the style sheet. 

<P> If there is only one component value, it applies to all
sides. If there are two values, the top and bottom borders
are set to the first value and the right and left are
set to the second. If there are three values, the top is
set to the first value, the left and right are set to the
second, and the bottom is set to the third. If there are
four values, they apply to the top, right, bottom, and left,
respectively.

<div class="example"><P style="display:none">Example(s):</P><P>
In the examples below, the comments indicate the resulting widths
of the top, right, bottom, and left borders:

<PRE>
h1 { border-width: thin }                   /* thin thin thin thin */
h1 { border-width: thin thick }             /* thin thick thin thick */
h1 { border-width: thin thick medium }      /* thin thick medium thick */
</PRE>
</div>

</details>
<H3>8.5.2 <A name="border-color-properties">Border color</A>:
<a href="box.html#propdef-border-top-color" class="noxref"><span class="propinst-border-top-color">'border-top-color'</span></a>,
<a href="box.html#propdef-border-right-color" class="noxref"><span class="propinst-border-right-color">'border-right-color'</span></a>,
<a href="box.html#propdef-border-bottom-color" class="noxref"><span class="propinst-border-bottom-color">'border-bottom-color'</span></a>,
<a href="box.html#propdef-border-left-color" class="noxref"><span class="propinst-border-left-color">'border-left-color'</span></a>, and
<a href="box.html#propdef-border-color" class="noxref"><span class="propinst-border-color">'border-color'</span></a>
</H3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<P>The border color properties specify the color of a box's border.

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x42"><span class="index-def" title="'border-top-color'"><dfn id="propdef-border-top-color">border-top-color</dfn></span></a>, <a name="x43"><span class="index-def" title="'border-right-color'"><dfn id="propdef-border-right-color">border-right-color</dfn></span></a>, <a name="x44"><span class="index-def" title="'border-bottom-color'"><dfn id="propdef-border-bottom-color">border-bottom-color</dfn></span></a>, <a name="x45"><span class="index-def" title="'border-left-color'"><dfn id="propdef-border-left-color">border-left-color</dfn></span></a><tr><th>Value:<td><a href="syndata.html#value-def-color" class="noxref"><span class="value-inst-color">&lt;color&gt;</span></a> | transparent | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>the value of the 'color' property
<tr><th>Applies to:<td>all elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>when taken from the 'color' property, the computed value of 'color';
   otherwise, as specified
</table>
<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x46"><span class="index-def" title="'border-color'"><dfn id="propdef-border-color">border-color</dfn></span></a><tr><th>Value:<td>[ <a href="syndata.html#value-def-color" class="noxref"><span class="value-inst-color">&lt;color&gt;</span></a> | transparent ]{1,4} | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>see individual properties
<tr><th>Applies to:<td>all elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>see individual properties
</table>

<P>The <a href="box.html#propdef-border-color" class="noxref"><span class="propinst-border-color">'border-color'</span></a>
property sets the color of the four borders. Values have the following
meanings:</p>

<dl>
<dt><span class="index-inst" title="&lt;color&gt;"><a name="x47" href="syndata.html#value-def-color" class="noxref"><span
class="value-inst-color"><strong>&lt;color&gt;</strong></span></a></span>
<dd>Specifies a color value.
<dt><strong>transparent</strong>
<dd>The border is transparent (though it may have width).
</dl>


<P>The <a href="box.html#propdef-border-color" class="noxref"><span class="propinst-border-color">'border-color'</span></a>
property can have from one to four component values, and the values
are set on the different sides as for <a href="box.html#propdef-border-width" class="noxref"><span
class="propinst-border-width">'border-width'</span></a>.

<P>If an element's border color is not specified 
with a border property, user agents must use the value
of the element's <a href="colors.html#propdef-color" class="noxref"><span
class="propinst-color">'color'</span></a> property as the 
<a href="cascade.html#computed-value">computed value</a> 
for the border color.

<div class="example"><P style="display:none">Example(s):</P>
<P>In this  example, the border will be a solid black line.
<PRE>
p { 
  color: black; 
  background: white; 
  border: solid;
}
</PRE>
</div>

</details>
<H3>8.5.3 <A name="border-style-properties">Border style</a>:
<a href="box.html#propdef-border-top-style" class="noxref"><span class="propinst-border-top-style">'border-top-style'</span></a>,
<a href="box.html#propdef-border-right-style" class="noxref"><span class="propinst-border-right-style">'border-right-style'</span></a>,
<a href="box.html#propdef-border-bottom-style" class="noxref"><span class="propinst-border-bottom-style">'border-bottom-style'</span></a>,
<a href="box.html#propdef-border-left-style" class="noxref"><span class="propinst-border-left-style">'border-left-style'</span></a>, and
<a href="box.html#propdef-border-style" class="noxref"><span class="propinst-border-style">'border-style'</span></a></H3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<P>The border style properties specify the line style of a box's
border (solid, double, dashed, etc.). The properties defined in this
section refer to the <span class="index-def"
title="&lt;border-style&gt;, definition of"><a
name="value-def-border-style"><strong>&lt;border-style&gt;</strong></a></span>
value type, which may take one of the following values:</p>

<dl>
<dt><strong><span class="index-def" title="'none'::as border style"><a name="value-def-bo-none" class="value-def">none</a></span></strong>
<dd>No border; the computed border width is zero.
<dt><strong><span class="index-def" title="'hidden'"><a name="value-def-hidden" class="value-def">hidden</a></span></strong>
<dd>Same as 'none', except in terms of <a
href="tables.html#border-conflict-resolution">border conflict
resolution</a> for <a href="tables.html">table elements</a>.
<dt><strong><span class="index-def" title="'dotted'"><a name="value-def-dotted" class="value-def">dotted</a></span></strong>
<dd>The border is a series of dots.
<dt><strong><span class="index-def" title="'dashed'"><a name="value-def-dashed" class="value-def">dashed</a></span></strong>
<dd>The border is a series of short line segments.
<dt><strong><span class="index-def" title="'solid'"><a name="value-def-solid" class="value-def">solid</a></span></strong>
<dd>The border is a single line segment.
<dt><strong><span class="index-def" title="'double'"><a name="value-def-double" class="value-def">double</a></span></strong>
<dd>The border is two solid lines. The sum of
the two lines and the space between them
equals the value of <a href="box.html#propdef-border-width" class="noxref"><span
class="propinst-border-width">'border-width'</span></a>.
<dt><strong><span class="index-def" title="'groove'"><a name="value-def-groove" class="value-def">groove</a></span></strong>
<dd>The border looks as though it were carved
into the canvas.
<dt><strong><span class="index-def" title="'ridge'"><a name="value-def-ridge" class="value-def">ridge</a></span></strong>
<dd>The opposite of 'groove': the border
looks as though it were coming out of the canvas.
<dt><strong><span class="index-def" title="'inset'"><a name="value-def-inset" class="value-def">inset</a></span></strong>
<dd>The border makes the box look as though
it were embedded in the canvas.
<dt><strong><span class="index-def" title="'outset'"><a name="value-def-outset" class="value-def">outset</a></span></strong>
<dd>The opposite of 'inset': the
border makes the box look as though
it were coming out of the canvas.
</dl>

<P>All borders are drawn on top of the box's background. The color of
borders drawn for values of 'groove', 'ridge', 'inset', and 'outset'
depends on the element's <a href="#border-color-properties">border
color properties</a>, but UAs may choose their own algorithm to
calculate the actual colors used. For instance, if the 'border-color'
has the value 'silver', then a UA could use a gradient of colors from
white to dark gray to indicate a sloping border.




<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x59"><span class="index-def" title="'border-top-style'"><dfn id="propdef-border-top-style">border-top-style</dfn></span></a>, <a name="x60"><span class="index-def" title="'border-right-style'"><dfn id="propdef-border-right-style">border-right-style</dfn></span></a>, <a name="x61"><span class="index-def" title="'border-bottom-style'"><dfn id="propdef-border-bottom-style">border-bottom-style</dfn></span></a>, <a name="x62"><span class="index-def" title="'border-left-style'"><dfn id="propdef-border-left-style">border-left-style</dfn></span></a><tr><th>Value:<td><a href="box.html#value-def-border-style" class="noxref"><span class="value-inst-border-style">&lt;border-style&gt;</span></a> | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>none
<tr><th>Applies to:<td>all elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>as specified
</table>
<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x63"><span class="index-def" title="'border-style'"><dfn id="propdef-border-style">border-style</dfn></span></a><tr><th>Value:<td><a href="box.html#value-def-border-style" class="noxref"><span class="value-inst-border-style">&lt;border-style&gt;</span></a>{1,4} | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>see individual properties
<tr><th>Applies to:<td>all elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>see individual properties
</table>

<P> The <a href="box.html#propdef-border-style" class="noxref"><span class="propinst-border-style">'border-style'</span></a>
property sets the style of the four borders. It can have from one to
four component values, and the values are set on the different sides as for
<a href="box.html#propdef-border-width" class="noxref"><span class="propinst-border-width">'border-width'</span></a> above.

<div class="example"><P style="display:none">Example(s):</P><P>
<PRE>
#xy34 { border-style: solid dotted }
</PRE>
<P> In the above example, the horizontal borders will be 'solid' and
the vertical borders will be 'dotted'.
</div>

<P> Since the initial value of the border styles is 'none', no borders
will be visible unless the border style is set.

</details>
<H3>8.5.4 <A name="border-shorthand-properties">Border shorthand properties</a>:
<a href="box.html#propdef-border-top" class="noxref"><span class="propinst-border-top">'border-top'</span></a>,
<a href="box.html#propdef-border-right" class="noxref"><span class="propinst-border-right">'border-right'</span></a>,
<a href="box.html#propdef-border-bottom" class="noxref"><span class="propinst-border-bottom">'border-bottom'</span></a>,
<a href="box.html#propdef-border-left" class="noxref"><span class="propinst-border-left">'border-left'</span></a>, and
<a href="box.html#propdef-border" class="noxref"><span class="propinst-border">'border'</span></a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x64"><span class="index-def" title="'border-top'"><dfn id="propdef-border-top">border-top</dfn></span></a>, <a name="x65"><span class="index-def" title="'border-right'"><dfn id="propdef-border-right">border-right</dfn></span></a>, <a name="x66"><span class="index-def" title="'border-bottom'"><dfn id="propdef-border-bottom">border-bottom</dfn></span></a>, <a name="x67"><span class="index-def" title="'border-left'"><dfn id="propdef-border-left">border-left</dfn></span></a><tr><th>Value:<td>[ <a href="box.html#value-def-border-width" class="noxref"><span class="value-inst-border-width">&lt;border-width&gt;</span></a> || <a href="box.html#value-def-border-style" class="noxref"><span class="value-inst-border-style">&lt;border-style&gt;</span></a> || <a href="box.html#propdef-border-top-color" class="noxref"><span class="propinst-border-top-color">&lt;'border-top-color'&gt;</span></a> ] | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>see individual properties
<tr><th>Applies to:<td>all elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>see individual properties
</table>

<P> This is a shorthand property for setting the width, style, and
color of the top, right, bottom, and left border of a box.

<div class="example"><P style="display:none">Example(s):</P><P>
<PRE>
h1 { border-bottom: thick solid red }
</PRE>

<P> The above rule will set the width, style, and color of the border
<strong>below</strong> the H1 element. Omitted values are set to
their <a href="about.html#initial-value">initial values</a>. Since
the following rule does not specify a border color, the border will
have the color specified by the <a href="colors.html#propdef-color" class="noxref"><span class="propinst-color">
'color'</span></a> property:

<PRE>
H1 { border-bottom: thick solid }
</PRE>
</div>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x68"><span class="index-def" title="'border'"><dfn id="propdef-border">border</dfn></span></a><tr><th>Value:<td>[ <a href="box.html#value-def-border-width" class="noxref"><span class="value-inst-border-width">&lt;border-width&gt;</span></a> || <a href="box.html#value-def-border-style" class="noxref"><span class="value-inst-border-style">&lt;border-style&gt;</span></a> || <a href="box.html#propdef-border-top-color" class="noxref"><span class="propinst-border-top-color">&lt;'border-top-color'&gt;</span></a> ] | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>see individual properties
<tr><th>Applies to:<td>all elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>see individual properties
</table>

<P> The <a href="box.html#propdef-border" class="noxref"><span class="propinst-border">'border'</span></a> property is a
shorthand property for setting the same width, color, and style for
all four borders of a box.  Unlike the shorthand <a href="box.html#propdef-margin" class="noxref"><span
class="propinst-margin">'margin'</span></a> and <a href="box.html#propdef-padding" class="noxref"><span
class="propinst-padding">'padding'</span></a> properties, the <a href="box.html#propdef-border" class="noxref"><span
class="propinst-border">'border'</span></a> property cannot set different
values on the four borders. To do so, one or more of the other border
properties must be used.

<div class="example"><P style="display:none">Example(s):</P><P>
For example, the first rule below is
equivalent to the set of four rules shown after it:

<PRE>
p { border: solid red }
p {
  border-top: solid red;
  border-right: solid red;
  border-bottom: solid red;
  border-left: solid red
}
</PRE>
</div>

<P> Since, to some extent, the properties have overlapping
functionality, the order in which the rules are specified is
important.

<div class="example"><P style="display:none">Example(s):</P><P>
Consider this example:
<PRE>
blockquote {
  border: solid red;
  border-left: double;
  color: black;
}
</PRE>

<P> In the above example, the color of the left border is black,
while the other borders are red. This is due to <a href="box.html#propdef-border-left" class="noxref"><span
class="propinst-border-left">'border-left'</span></a> setting the
width, style, and color. Since the color value is not given by the
<a href="box.html#propdef-border-left" class="noxref"><span class="propinst-border-left">'border-left'</span></a> property, it
will be taken from the <a href="colors.html#propdef-color" class="noxref"><span class="propinst-color">'color'</span></a>
property. The fact that the <a href="colors.html#propdef-color" class="noxref"><span
class="propinst-color">'color'</span></a> property is set after the <a href="box.html#propdef-border-left" class="noxref"><span
class="propinst-border-left">'border-left'</span></a> property is not
relevant.
</div>

</details>
<h2>8.6 <a name="bidi-box-model">The box model for inline elements in bidirectional context</a></h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p>For each line box, UAs must take the inline boxes generated for
each element and render the margins, borders and padding in visual
order (not logical order).

<p>When the element's <a href="visuren.html#propdef-direction" class="noxref"><span
class=propinst-direction>'direction'</span></a> property is 'ltr', the
left-most generated box of the first line box in which the element
appears has the left margin, left border and left padding, and the
right-most generated box of the last line box in which the element
appears has the right padding, right border and right margin.

<p>When the element's <a href="visuren.html#propdef-direction" class="noxref"><span
class=propinst-direction>'direction'</span></a> property is 'rtl', the
right-most generated box of the first line box in which the element
appears has the right padding, right border and right margin, and the
left-most generated box of the last line box in which the element
appears has the left margin, left border and left padding.

<hr class="navbar">

<div class="navbar">
<p><a href="media.html">previous</a> &nbsp;
<a href="visuren.html">next</a> &nbsp;
<a href="Overview.html#minitoc">contents</a> &nbsp;
<a href="propidx.html">properties</a> &nbsp;
<a href="indexlist.html">index</a> &nbsp;
</div>
</BODY>

<body>
<div class="navbar">
<p><a href="box.html">previous</a> &nbsp;
<a href="visudet.html">next</a> &nbsp;
<a href="Overview.html#minitoc">contents</a> &nbsp;
<a href="propidx.html">properties</a> &nbsp;
<a href="indexlist.html">index</a> &nbsp;
</div>
<hr class="navbar">

<h1><a name="q0">9 Visual formatting model</a></h1>
<div id="toc" class="subtoc">
<p><strong>Contents</strong>
  <ul class="toc">
    <li><a href="visuren.html#visual-model-intro" class="tocxref">9.1 Introduction to the visual formatting model</a>
    <ul class="toc">
      <li><a href="visuren.html#viewport" class="tocxref">9.1.1 The viewport</a>
      <li><a href="visuren.html#containing-block" class="tocxref">9.1.2 <span class="index-def" title="containing block"> Containing blocks</span></a>
    </ul>
    <li><a href="visuren.html#box-gen" class="tocxref">9.2 Controlling box generation</a>
    <ul class="toc">
      <li><a href="visuren.html#block-boxes" class="tocxref">9.2.1 Block-level elements and block boxes</a>
      <ul class="toc">
        <li><a href="visuren.html#anonymous-block-level" class="tocxref">9.2.1.1 Anonymous block boxes</a>
      </ul>
      <li><a href="visuren.html#inline-boxes" class="tocxref">9.2.2 Inline-level elements and inline boxes</a>
      <ul class="toc">
        <li><a href="visuren.html#anonymous" class="tocxref">9.2.2.1 Anonymous inline boxes</a>
      </ul>
      <li><a href="visuren.html#run-in" class="tocxref">9.2.3 Run-in boxes</a>
      <li><a href="visuren.html#display-prop" class="tocxref">9.2.4 The <span class="propinst-display">'display'</span> property</a>
    </ul>
    <li><a href="visuren.html#positioning-scheme" class="tocxref">9.3 Positioning schemes</a>
    <ul class="toc">
      <li><a href="visuren.html#choose-position" class="tocxref">9.3.1 Choosing a positioning scheme: <span class="propinst-position">'position'</span> property</a>
      <li><a href="visuren.html#position-props" class="tocxref">9.3.2 Box offsets: <span class="propinst-top">'top'</span>, <span class="propinst-right">'right'</span>, <span class="propinst-bottom">'bottom'</span>, <span class="propinst-left">'left'</span></a>
    </ul>
    <li><a href="visuren.html#normal-flow" class="tocxref">9.4 Normal flow</a>
    <ul class="toc">
      <li><a href="visuren.html#block-formatting" class="tocxref">9.4.1 Block formatting contexts</a>
      <li><a href="visuren.html#inline-formatting" class="tocxref">9.4.2 Inline formatting contexts</a>
      <li><a href="visuren.html#relative-positioning" class="tocxref">9.4.3 Relative positioning</a>
    </ul>
    <li><a href="visuren.html#floats" class="tocxref">9.5 Floats</a>
    <ul class="toc">
      <li><a href="visuren.html#float-position" class="tocxref">9.5.1 Positioning the float: the <span class="propinst-float">'float'</span> property</a>
      <li><a href="visuren.html#flow-control" class="tocxref">9.5.2 Controlling flow next to floats: the <span class="propinst-clear">'clear'</span> property</a>
    </ul>
    <li><a href="visuren.html#absolute-positioning" class="tocxref">9.6 Absolute positioning</a>
    <ul class="toc">
      <li><a href="visuren.html#fixed-positioning" class="tocxref">9.6.1 Fixed positioning</a>
    </ul>
    <li><a href="visuren.html#dis-pos-flo" class="tocxref">9.7 Relationships between 'display', 'position', and 'float'</a>
    <li><a href="visuren.html#comparison" class="tocxref">9.8 Comparison of normal flow, floats,   and absolute positioning</a>
    <ul class="toc">
      <li><a href="visuren.html#comp-normal-flow" class="tocxref">9.8.1 Normal flow</a>
      <li><a href="visuren.html#comp-relpos" class="tocxref">9.8.2 Relative positioning</a>
      <li><a href="visuren.html#comp-float" class="tocxref">9.8.3 Floating a box</a>
      <li><a href="visuren.html#comp-abspos" class="tocxref">9.8.4 Absolute positioning</a>
    </ul>
    <li><a href="visuren.html#layers" class="tocxref">9.9 Layered presentation</a>
    <ul class="toc">
      <li><a href="visuren.html#z-index" class="tocxref">9.9.1 Specifying the stack level: the <span class="propinst-z-index">'z-index'</span> property</a>
    </ul>
    <li><a href="visuren.html#direction" class="tocxref">9.10 Text direction: the <span class="propinst-direction">'direction'</span> and <span class="propinst-unicode-bidi">'unicode-bidi'</span> properties</a>
  </ul>
</div>

</details>
<h2>9.1 <a name="visual-model-intro">Introduction to the visual formatting model</a></h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p>This chapter and the next describe the <a name="x0"><span class="index-def"
title="visual formatting model">visual formatting model</span></a>: how user
agents process the <a href="conform.html#doctree">document tree</a>
for visual <a href="media.html">media</a>.
</p>

<p>In the visual formatting model, each element in the document tree
generates zero or more boxes according to the <a href="box.html">box
model</a>. The layout of these boxes is governed by:</p>

<ul>
<li><a href="box.html#box-dimensions">box dimensions</a> and <a
href="#box-gen">type</a>.
</li><li><a href="#positioning-scheme">positioning scheme</a>
(normal flow, float, and absolute positioning).
</li><li>relationships between elements
in the <a href="conform.html#doctree">document tree.</a>
</li><li>external information (e.g., viewport size, <a
href="conform.html#intrinsic">intrinsic</a> dimensions of images, etc.).
</li></ul>

<p>The properties defined in this chapter and the next apply to both
<a href="media.html#continuous-media-group">continuous media</a> and
<a href="media.html#paged-media-group">paged media</a>. <span class="paged">
However, the
meanings of the <a href="box.html#margin-properties">margin
properties</a> vary when applied to paged media (see the <a
href="page.html#page-margins">page model</a> for details).
</span>
</p>

<p>The visual formatting model does not specify all aspects of
formatting (e.g., it does not specify a letter-spacing algorithm). <a
href="conform.html#conformance">Conforming user agents</a> may behave
differently for those formatting issues not covered by this
specification.
</p>

</details>
<h3>9.1.1 <a name="viewport">The viewport</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>User agents for <a
href="media.html#continuous-media-group">continuous media</a>
generally offer users a <a name="x1"><span class="index-def" title="viewport">
<dfn>viewport</dfn></span></a> (a window or other
viewing area on the screen) through which users consult a
document. User agents may change the document's layout when the
viewport is resized (see the <a
href="visudet.html#containing-block-details">initial containing block</a>).
</p>
<p>
When the viewport is smaller than the area of the canvas on which
the document is rendered, the user agent should offer a scrolling
mechanism.

There is at most
one viewport per <a href="intro.html#canvas">canvas</a>, but user
agents may render to more than one canvas (i.e., provide different
views of the same document).
</p>

</details>
<h3>9.1.2 <span class="index-def" title="containing block">
<a name="containing-block">Containing blocks</a></span>
</h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>In CSS&nbsp;2.2, many box positions and sizes are calculated with respect
to the edges
of a rectangular box called a <a name="x3"><span class="index-def"
title="containing block"><dfn>containing block</dfn></span></a>.  In
general, generated boxes act as containing blocks for descendant
boxes; we say that a box "establishes" the containing block for its
descendants. The phrase "a box's containing block" means "the
containing block in which the box lives," not the one it generates.
</p>
<p>Each box is given a position with respect to its containing block,
but it is not confined by this containing block; it may <a
href="visufx.html#overflow">overflow</a>.
</p>

<p>The <a href="visudet.html#containing-block-details">details</a> of
how a containing block's dimensions are calculated are described in
the <a href="visudet.html">next chapter</a>.
</p>

</details>
<h2>9.2 <a name="box-gen">Controlling box generation</a></h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p>The following sections describe the types of boxes that may be
generated in CSS&nbsp;2.2. A box's type affects, in part, its behavior in the
visual formatting model. The <a href="visuren.html#propdef-display" class="noxref"><span
class="propinst-display">'display'</span></a> property, described below,
specifies a box's type.
</p>

<p>Certain values of the <a href="visuren.html#propdef-display" class="noxref"><span
class="propinst-display">'display'</span></a> property cause an element of
the source document to generate a <span class="index-def"
title="principal box"><a name="principal-box"><dfn>principal
box</dfn></a></span> that contains descendant boxes and generated
content and is also the box involved in any positioning scheme. Some
elements may generate additional boxes in addition to the principal
box: 'list-item' elements. These additional boxes are placed with
respect to the principal box.

</details>
<h3>9.2.1 <a name="block-boxes">Block-level elements and block boxes</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p><span class="index-def" title="block-level element"><a
name="block-level"><dfn>Block-level elements</dfn></a></span> &ndash;
those elements of the source document that are formatted visually as
blocks (e.g., paragraphs) &ndash; are elements which generate a
block-level principal box. Values of the <a href="visuren.html#propdef-display" class="noxref"><span
class="propinst-display">'display'</span></a> property that make an
element block-level include: 'block', 'list-item', and 'table'. <a name="x6"><span
class="index-def" title="block-level box"><dfn>Block-level
boxes</dfn></span></a> are boxes that participate in a <a
href="#block-formatting">block formatting context.</a>

<p>In CSS&nbsp;2.2, a block-level box is also a block container box
unless it is a table box or the principal box of a replaced element.
A <span class="index-def" title="block container box"><a
name="block-container-box"><dfn >block container box</dfn></a></span>
either contains only block-level boxes or establishes an <a
href="#inline-formatting" >inline formatting context</a> and thus
contains only <a href="#anonymous-block-level" >inline-level
boxes.</a> An element whose principal box is a block container box is
a <span class="index-def" title="block container element" ><a
name="block-container-element" ><dfn >block container
element.</dfn></a></span> Values of the 'display' property which make
a non-replaced element generate a block container include 'block',
'list-item' and 'inline-block'. Not all block container boxes are
block-level boxes: non-replaced inline blocks and non-replaced table
cells are block containers but are not block-level. Block-level boxes
that are also block containers are called <a name="x9"><span class="index-def"
title="block box"><dfn>block boxes</dfn></span></a>.

<p>The three terms "block-level box," "block container box," and
"block box" are sometimes abbreviated as "block" where unambiguous.

<h4>9.2.1.1 <a name="anonymous-block-level">Anonymous block boxes</a></h4>

<p>In a document like this:
</p>
<pre><code class="html">
&lt;DIV&gt;
  Some text
  &lt;P&gt;More text
&lt;/DIV&gt;
</code></pre>
<p>
(and assuming the DIV and the P both have 'display: block'), the
DIV appears to have both inline content and block content. To make it
easier to define the formatting, we assume that there is an <em><a name="x10"><span
class="index-def" title="anonymous">anonymous block box</span></a></em>
around "Some text".
</p>
<div class="figure">
<p><img src="images/anon-block.png" alt="diagram showing the three
boxes for the example above"><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-anon-block" href="images/longdesc/anon-block-desc.html" title="Long description for anonymous block box">[D]</A></SPAN> 
</p><p class="caption">Diagram showing the
three boxes, of which one is anonymous, for the example above.
</p></div>

<p>In other words: if a block container box (such as that generated
for the DIV above) has a block-level box inside it (such as the P
above), then we force it to have <em>only</em> block-level boxes
inside it.

<p>When an inline box contains an in-flow block-level box, the inline box
(and its inline ancestors within the same line box) is broken around
the block-level box (and any block-level siblings that are consecutive
or separated only by collapsible whitespace and/or out-of-flow
elements), splitting the inline box into two boxes (even if either
side is empty), one on each side of the block-level box(es). The line
boxes before the break and after the 
break are enclosed in anonymous block boxes, and the block-level box 
becomes a sibling of those anonymous boxes. When such an inline box is 
affected by relative positioning, any resulting translation also
affects the block-level box contained in the inline box.

<div class="example"><P style="display:none">Example(s):</P>
<p>This model would apply in the following example if the following
rules:</p>

<pre><code class="css">
p    { display: inline }
span { display: block }
</code></pre>

<p>were used with this HTML document:</p>

<pre class="html example"><code class="html">
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"&gt;
&lt;HEAD&gt;
&lt;TITLE&gt;Anonymous text interrupted by a block&lt;/TITLE&gt;
&lt;/HEAD&gt;
&lt;BODY&gt;
&lt;P&gt;
<em>This is anonymous text before the SPAN.</em>
&lt;SPAN&gt;This is the content of SPAN.&lt;/SPAN&gt;
<em>This is anonymous text after the SPAN.</em>
&lt;/P&gt;
&lt;/BODY&gt;
</code></pre>

<p>The P element contains a chunk (C1) of anonymous text followed
by a block-level element followed by another chunk (C2) of anonymous
text. The resulting boxes would be a block box representing the BODY,
containing an anonymous block box around C1, the SPAN block box, and
another anonymous block box around C2.
</p></div>

<p>The properties of anonymous boxes are inherited from the
enclosing non-anonymous box (e.g., in the example just below the subsection heading "Anonymous block boxes", the one for DIV). 
Non-inherited properties have their initial value. For example,
the font of the anonymous box is inherited from the DIV, but the
margins will be 0.
</p>
<p>
Properties set on elements that cause anonymous block boxes to be 
generated still apply to the boxes and content of that element. For 
example, if a border had been set on the P element in the above 
example, the border would be drawn around C1 (open at the end of the 
line) and C2 (open at the start of the line).
</p>
<p>
Some user agents have implemented borders on inlines containing 
blocks in other ways, e.g., by wrapping such nested blocks inside 
"anonymous line boxes" and thus drawing inline borders around such 
boxes. As CSS1 and CSS2 did not define this behavior, CSS1-only and 
CSS2-only user agents may implement this alternative model and still 
claim conformance to this part of CSS&nbsp;2.2. This does not apply to UAs 
developed after this specification was released.
</p>

<p>Anonymous block boxes are ignored when resolving percentage values
that would refer to it: the closest non-anonymous ancestor box is used
instead. For example, if the child of the anonymous block box inside
the DIV above needs to know the height of its containing block to
resolve a percentage height, then it will use the height of the
containing block formed by the DIV, not of the anonymous block box.

</details>
<h3>9.2.2 <a name="inline-boxes">Inline-level elements and inline boxes</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p><span class="index-def" title="inline-level element">
<a name="inline-level"><dfn>Inline-level
elements</dfn></a></span> are those elements of the source document that
do not form new blocks of content; the content is distributed in lines
 (e.g., emphasized pieces of text
within a paragraph, inline images,
etc.). The following values of the <a href="visuren.html#propdef-display" class="noxref"><span
class="propinst-display">'display'</span></a> property make an element
inline-level: 'inline', 'inline-table', and 'inline-block'. 

Inline-level elements generate <a name="x12"><span class="index-def"
title="inline-level box"><dfn>inline-level
boxes</dfn></span></a>, which are boxes that participate in an inline
formatting context.

<p>An <span class="index-def" title="inline box"><a
name="inline-box"><dfn>inline
box</dfn></a></span> is one that is both inline-level and whose
contents participate in its containing inline formatting context. A
non-replaced element with a 'display' value of 'inline' generates an
inline box.
Inline-level boxes that are not inline boxes (such as replaced
inline-level elements, inline-block elements, and inline-table
elements) are called <a name="x14"><span class="index-def" title="atomic
inline-level box"><dfn>atomic inline-level boxes</dfn></span></a> because
they participate in their inline formatting context as a single opaque
box.

<h4>9.2.2.1 <a name="anonymous">Anonymous inline boxes</a></h4>

<p>Any text that is directly contained inside a block container element (not
inside an inline element) must be treated as an anonymous inline
element.

<p>In a document with HTML markup like this:</p>

<div class="html example">
<pre><code class="html">
&lt;p&gt;Some &lt;em&gt;emphasized&lt;/em&gt; text&lt;/p&gt;
</code></pre>
</div>

<p>the <code>&lt;p&gt;</code> generates a block box, with several inline boxes inside
it. The box for "emphasized" is an inline box generated by an inline
element (<code>&lt;em&gt;</code>), but the other boxes ("Some" and "text") are inline boxes generated by a block-level element (<code>&lt;p&gt;</code>). The latter are called <a name="x15"><span
class="index-def" title="anonymous inline boxes">anonymous inline
boxes</span></a>, because they do not have an associated inline-level element.
</p>
<p>Such anonymous inline boxes inherit inheritable properties from
their block parent box. Non-inherited properties have their initial
value. In the example, the color of the anonymous inline boxes is
inherited from the P, but the background is transparent.
</p>

<p>
White space content that would subsequently be collapsed away according to the <a href="text.html#propdef-white-space" class="noxref"><span class="propinst-white-space">'white-space'</span></a> property does not generate any anonymous inline boxes.
</p>

<p>If it is clear from the context which type of anonymous box is
meant, both anonymous inline boxes and anonymous block boxes are
simply called anonymous boxes in this specification.
</p>
<p>There are more types of anonymous boxes that arise when formatting
<a href="tables.html#anonymous-boxes">tables</a>.
</p>

</details>
<h3>9.2.3 <a name="run-in">Run-in boxes</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>[This section exists so that the section numbers are the same as in
previous drafts. <a name="x16"><span class="index-def" title="run-in">'Display:
run-in'</span></a> is now defined in CSS level&nbsp;3 (see <a
href="https://www.w3.org/TR/css3-box/">CSS basic box model</a>).]

</details>
<h3>9.2.4 <a name="display-prop">The</a> <a href="visuren.html#propdef-display" class="noxref"><span
class="propinst-display">'display'</span></a> property</h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x17"><span class="index-def" title="'display'"><dfn id="propdef-display">display</dfn></span></a><tr><th>Value:<td>inline | block | list-item | inline-block |
table | inline-table | table-row-group | table-header-group |
table-footer-group | table-row | table-column-group | table-column |
table-cell | table-caption | none | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>inline
<tr><th>Applies to:<td>all elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#all-media-group" class="noxref">all</a>
<tr><th>Computed&nbsp;value:<td>see text
</table>

<p>The values of this property have the following meanings:</p>

<dl>
<dt><span class="index-def" title="'block', definition of"><a
name="value-def-block"><strong>block</strong></a></span>
</dt>
<dd>This value causes an element to generate a principal block box.
</dd>
<dt><span class="index-def" title="'inline-block', definition of"><a
name="value-def-inline-block"><strong>inline-block</strong></a></span>
</dt>
<dd>This value causes an element to generate a principal inline-level block
container.
(The inside of an inline-block is formatted as a block box, and the 
element itself is formatted as an atomic inline-level box.)
</dd>
<dt><span class="index-def" title="'inline', definition of"><a
name="value-def-inline"><strong>inline</strong></a></span>
</dt>
<dd>This value causes an element to generate one or more inline boxes.
</dd>
<dt><span class="index-def" title="'list-item', definition of"><a
name="value-def-list-item"><strong>list-item</strong></a></span>
</dt>
<dd>This value causes an element (e.g., LI in HTML) to generate a
principal block box and a marker box. For information about
lists and examples of list formatting, please consult the section on
<a href="generate.html#lists">lists</a>.
</dd>
<dt><strong>none</strong></dt>

<dd><a name="x22"><span class="index-def" title="'none'::as display value">This
value</span></a> causes an element to not appear in the <a
href="intro.html#formatting-structure">formatting structure</a> (i.e.,
in visual media the element generates no boxes and has no effect on
layout). Descendant elements do not generate any boxes either; the
element and its content are removed from the formatting structure
entirely. This behavior <strong>cannot</strong> be overridden by
setting the <a href="visuren.html#propdef-display" class="noxref"><span class="propinst-display">'display'</span></a> property
on the descendants.

<p>Please note that a display of 'none' does not create an invisible
box; it creates no box at all. CSS includes mechanisms that enable an
element to generate boxes in the formatting structure that affect
formatting but are not visible themselves. Please consult the section
on <a href="visufx.html#visibility">visibility</a> for details.
</p>
</dd>
<dt>
<a href="tables.html#value-def-table" class="noxref"><span class="value-inst-table">table</span></a>,
<a href="tables.html#value-def-inline-table" class="noxref"><span class="value-inst-inline-table">inline-table</span></a>,
<a href="tables.html#value-def-table-row-group" class="noxref"><span class="value-inst-table-row-group">table-row-group</span></a>,
<a href="tables.html#value-def-table-column" class="noxref"><span class="value-inst-table-column">table-column</span></a>,
<a href="tables.html#value-def-table-column-group" class="noxref"><span class="value-inst-table-column-group">table-column-group</span></a>,
<a href="tables.html#value-def-table-header-group" class="noxref"><span class="value-inst-table-header-group">table-header-group</span></a>,
<a href="tables.html#value-def-table-footer-group" class="noxref"><span class="value-inst-table-footer-group">table-footer-group</span></a>,
<a href="tables.html#value-def-table-row" class="noxref"><span class="value-inst-table-row">table-row</span></a>,
<a href="tables.html#value-def-table-cell" class="noxref"><span class="value-inst-table-cell">table-cell</span></a>, and
<a href="tables.html#value-def-table-caption" class="noxref"><span class="value-inst-table-caption">table-caption</span></a>
</dt>
<dd>These values cause an element to behave like a table element
(subject to restrictions described in the chapter on <a
href="tables.html">tables</a>).
</dd>
</dl>

<p>The computed value is the same as the specified value, except for
positioned and floating elements (see <a
href="#dis-pos-flo">Relationships between 'display', 'position', and
'float'</a>) and for the root element. 

For the root element, the computed value is changed as described in 
the section on the <a href="#dis-pos-flo">relationships between 'display', 'position', and 'float'</a>.
</p>

<p>Note that although the <a href="about.html#initial-value">initial
value</a> of <a href="visuren.html#propdef-display" class="noxref"><span class="propinst-display">'display'</span></a> is
'inline', rules in the user agent's <a
href="cascade.html#default-style-sheet">default style sheet</a> may <a
href="cascade.html">override</a> this value. See the <a
href="sample.html">sample style sheet</a> for HTML 4 in the
appendix.
</p>
<div class="example"><P style="display:none">Example(s):</P>
<p>Here are some examples of the <a href="visuren.html#propdef-display" class="noxref"><span
class="propinst-display">'display'</span></a> property:
</p>
<pre><code class="css">
p   { display: block }
em  { display: inline }
li  { display: list-item } 
img { display: none }      /* Do not display images */
</code></pre>
</div>

</details>
<h2>9.3 <a name="positioning-scheme">Positioning schemes</a></h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p>In CSS&nbsp;2.2, a box may be laid out according to three <a name="x23"><span
class="index-def" title="positioning scheme"><dfn>positioning
schemes:</dfn></span></a></p>

<ol>
<li><a href="#normal-flow">Normal flow</a>. In CSS&nbsp;2.2, normal
flow includes <a href="#block-formatting">block formatting</a>
of block-level boxes, 
<a href="#inline-formatting">inline formatting</a>
of inline-level boxes, and <a
href="#relative-positioning">relative positioning</a> of
block-level and inline-level boxes.
</li>
<li><a href="#floats">Floats</a>. In the float model,
a box is first laid out according to the normal flow, then 
taken out of the flow and shifted
to the left or right as far as possible. Content may
flow along the side of a float.
</li>
<li><a href="#absolute-positioning">Absolute positioning</a>. 
In the absolute positioning model, a box is removed from
the normal flow entirely (it has no impact on later siblings)
and assigned a position with respect to a containing block.
</li>
</ol>

<p>An element is called <dfn><a name="x24"><span class="index-def">out of
flow</span></a></dfn> if it is floated, absolutely positioned, or is the
root element. An element is called <dfn><a name="x25"><span
class="index-def">in-flow</span></a></dfn> if it is not out-of-flow. The
<dfn><a name="x26"><span class="index-def">flow of an element</span></a></dfn>
<var>A</var> is the set consisting of <var>A</var> and all in-flow
elements whose nearest out-of-flow ancestor is <var>A</var>.

<div class="note">
<em><strong>Note.</strong>
CSS&nbsp;2.2's positioning schemes help authors make their documents
more accessible by allowing them to avoid mark-up tricks
(e.g., invisible images) used for layout effects.
</em>
</div>

</details>
<h3>9.3.1 <a name="choose-position">Choosing a positioning scheme:</a> <a href="visuren.html#propdef-position" class="noxref"><span
class="propinst-position">'position'</span></a> property</h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>The <a href="visuren.html#propdef-position" class="noxref"><span class="propinst-position">'position'</span></a> and <a href="visuren.html#propdef-float" class="noxref"><span
class="propinst-float">'float'</span></a> properties determine which 
of the CSS&nbsp;2.2 positioning algorithms is used to calculate 
the position of a box.
</p>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x27"><span class="index-def" title="'position'"><dfn id="propdef-position">position</dfn></span></a><tr><th>Value:<td>static | relative | absolute | fixed | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>static
<tr><th>Applies to:<td>all elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>as specified
</table>

<p>The values of this property have the following meanings:</p>

<dl>
<dt><strong>static</strong></dt>

<dd>The box is a normal box, laid out according to the <a
href="#normal-flow">normal flow</a>. The 
<a href="visuren.html#propdef-top" class="noxref"><span class="propinst-top">'top'</span></a>, 
<a href="visuren.html#propdef-right" class="noxref"><span class="propinst-right">'right'</span></a>, 
<a href="visuren.html#propdef-bottom" class="noxref"><span class="propinst-bottom">'bottom'</span></a>,
and <a href="visuren.html#propdef-left" class="noxref"><span class="propinst-left">'left'</span></a>
properties do not apply. 
</dd>
<dt><strong>relative</strong></dt>

<dd>The box's position is calculated according to the <a
href="#normal-flow">normal flow</a> (this is called the position in
normal flow). Then the box is offset <a
href="#relative-positioning">relative</a> to its normal position. When
a box B is relatively positioned, the position of the following box is
calculated as though B were not offset.  The effect of 'position:relative' on table-row-group, table-header-group, table-footer-group, table-row, table-column-group, table-column, table-cell, and table-caption elements is undefined.
</dd>
<dt><strong>absolute</strong></dt>
<dd> The box's position (and possibly size) is specified
with the <a href="visuren.html#propdef-top" class="noxref"><span class="propinst-top">'top'</span></a>,
<a href="visuren.html#propdef-right" class="noxref"><span class="propinst-right">'right'</span></a>, 
<a href="visuren.html#propdef-bottom" class="noxref"><span class="propinst-bottom">'bottom'</span></a>, and
<a href="visuren.html#propdef-left" class="noxref"><span class="propinst-left">'left'</span></a>
properties.
These properties specify offsets with respect to the box's 
<a href="#containing-block">containing block</a>. Absolutely
positioned boxes are taken out of the normal flow. This means
they have no impact on the layout of later siblings. Also,
though <a href="#absolutely-positioned">absolutely positioned</a> 
boxes have margins, they
do not <a href="box.html#collapsing-margins">collapse</a>
with any other margins.
</dd>
<dt><strong>fixed</strong></dt>
<dd> The box's position is calculated according to the 'absolute'
model, but in addition, the box is <a
href="#fixed-positioning">fixed</a> with respect to some reference.  
As with the 'absolute' model, the box's margins do not collapse with any other margins.
In the case of handheld, projection, screen, tty, and tv media types, 
the box is fixed with respect to the <a href="#viewport">viewport</a> 
and does not move when 
scrolled. In the case of the print media type, the box is rendered on every page, and is fixed with respect to the page box, even if the page is seen through a <a href="#viewport">viewport</a> 
(in the case of a print-preview, for example). For other media 
types, the presentation is undefined. 
Authors may wish to specify 'fixed' in a
media-dependent way.  For instance, an author may want a box to remain
at the top of the <a href="#viewport">viewport</a> on the screen, but
not at the top of each printed page. The two specifications may be
separated by using an <a href="media.html#at-media-rule">@media
rule</a>, as in:

<div class="example"><P style="display:none">Example(s):</P>
<pre><code class="css">   
@media screen { 
  h1#first { position: fixed } 
}
@media print { 
  h1#first { position: static }
}
</code></pre>   
</div>
<p>UAs must not paginate the content of fixed boxes. <span
class="note">Note that UAs may print invisible content in other
ways. See <a href="page.html#outside-page-box">"Content outside the
page box"</a> in chapter&nbsp;13.</span>
</dd>
</dl>
<p>
User agents may treat position as 'static' on the root element.
</p>

</details>
<h3>9.3.2 <a name="position-props">Box offsets</a>: <a href="visuren.html#propdef-top" class="noxref"><span
class="propinst-top">'top'</span></a>, <a href="visuren.html#propdef-right" class="noxref"><span
class="propinst-right">'right'</span></a>, <a href="visuren.html#propdef-bottom" class="noxref"><span
class="propinst-bottom">'bottom'</span></a>, <a href="visuren.html#propdef-left" class="noxref"><span
class="propinst-left">'left'</span></a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>An element is said to be <span class="index-def" title="positioned
element/box"><a name="positioned-element"><dfn>positioned</dfn></a></span>
if its <a href="visuren.html#propdef-position" class="noxref"><span class="propinst-position">'position'</span></a> property has
a value other than 'static'. Positioned elements generate
positioned boxes, laid out according to four properties:</p>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x29"><span class="index-def" title="'top'"><dfn id="propdef-top">top</dfn></span></a><tr><th>Value:<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | auto | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>auto
<tr><th>Applies to:<td>positioned elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>refer to height of containing block
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>if
  specified as a length, the corresponding absolute length; if
  specified as a percentage, the specified value; otherwise, 'auto'.
</table>

<p>This property specifies how far an <a
href="#absolutely-positioned">absolutely positioned</a> box's top
margin edge is offset below the top edge of the box's <a
href="#containing-block">containing block</a>. For relatively
positioned boxes, the offset is with respect to the top edges of the
box itself (i.e., the box is given a position in the normal flow, then
offset from that position according to these properties).
</p>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x30"><span class="index-def" title="'right'"><dfn id="propdef-right">right</dfn></span></a><tr><th>Value:<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | auto | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>auto
<tr><th>Applies to:<td>positioned elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>refer to width of containing block
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>if
  specified as a length, the corresponding absolute length; if
  specified as a percentage, the specified value; otherwise,
  'auto'.
</table>

<p>Like 'top', but specifies how far a box's right margin edge is
offset to the left of the right edge of the box's <a
href="#containing-block">containing block</a>.  For relatively
positioned boxes, the offset is with respect to the right edge of the
box itself.
</p>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x31"><span class="index-def" title="'bottom'"><dfn id="propdef-bottom">bottom</dfn></span></a><tr><th>Value:<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | auto | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>auto
<tr><th>Applies to:<td>positioned elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>refer to height of containing block
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>if
  specified as a length, the corresponding absolute length; if
  specified as a percentage, the specified value; otherwise, 'auto'.
</table>

<p>Like 'top', but specifies how far a box's bottom margin edge is
offset above the bottom of the box's <a
href="#containing-block">containing block</a>. For relatively
positioned boxes, the offset is with respect to the bottom edge of the
box itself.
</p>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x32"><span class="index-def" title="'left'"><dfn id="propdef-left">left</dfn></span></a><tr><th>Value:<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | auto | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>auto
<tr><th>Applies to:<td>positioned elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>refer to width of containing block
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>if
  specified as a length, the corresponding absolute length; if
  specified as a percentage, the specified value; otherwise,
  'auto'.
</table>

<p>Like 'top', but specifies how far a box's left margin edge is
offset to the right of the left edge of the box's <a
href="#containing-block">containing block</a>.  For relatively
positioned boxes, the offset is with respect to the left edge of the
box itself.
</p>

<p>The values for the four properties have the following meanings:</p>

<dl>
<dt><strong><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a></strong></dt>
<dd>The offset is a fixed distance from the reference edge. Negative values are allowed.
</dd>
<dt><strong><a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a></strong></dt>

<dd>The offset is a percentage of the containing block's width (for <a href="visuren.html#propdef-left" class="noxref"><span class="propinst-left">'left'</span></a> or <a href="visuren.html#propdef-right" class="noxref"><span
class="propinst-right">'right'</span></a>) or height (for <a href="visuren.html#propdef-top" class="noxref"><span
class="propinst-top">'top'</span></a> and <a href="visuren.html#propdef-bottom" class="noxref"><span
class="propinst-bottom">'bottom'</span></a>). Negative values are allowed.
</dd>
<dt><strong>auto</strong></dt>
<dd>For non-replaced elements, the effect of this value 
depends on which of related properties have the value 'auto' as
well. See the sections on the 
<a href="visudet.html#abs-non-replaced-width">width</a>
and <a href="visudet.html#abs-non-replaced-height">height</a>
of <a href="#absolutely-positioned">absolutely positioned</a>, 
non-replaced elements for details.  For replaced elements, the
effect of this value depends only on the intrinsic dimensions of the
replaced content. See the sections on the <a
href="visudet.html#abs-replaced-width">width</a> and <a
href="visudet.html#abs-replaced-height">height</a> of absolutely
positioned, replaced elements for details.
</dd>
</dl>

</details>
<h2>9.4 <a name="normal-flow">Normal flow</a></h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p>Boxes in the normal flow belong to a <a name="x33"><span class="index-def"
title="formatting context">formatting context</span></a>, which in CSS&nbsp;2.2
may be table, block or inline. In future levels of CSS, other types of
formatting context will be introduced. <a
href="#block-level">Block-level</a> boxes participate in a <a
href="#block-formatting">block formatting</a> context.  <a
href="#inline-level">Inline-level boxes</a> participate in an <a
href="#inline-formatting">inline formatting</a> context. Table
formatting contexts are described in the <a href="tables.html"
>chapter on tables.</a>
</p>

</details>
<h3>9.4.1 <a name="block-formatting">Block formatting contexts</a></h3>
<div data-valor-status="block-formatting">
 <p><strong>Status:</strong> [Production]</p>
 <p><strong>Code:</strong> <code>src/orchestrator/mod.rs::layout_root_impl</code>, <code>src/lib.rs::layout_block_children</code>, <code>src/lib.rs::place_block_children_loop</code>, <code>src/lib.rs::compute_clearance_floor_for_child</code>, <code>src/lib.rs::compute_float_bands_for_y</code>, <code>src/lib.rs::build_parent_edge_context</code></p>
 <p><strong>Spec:</strong> https://www.w3.org/TR/CSS22/visuren.html#block-formatting</p>
 <p><strong>Fixtures:</strong> <code>crates/css/modules/box/tests/fixtures/layout/**</code>, <code>crates/valor/tests/fixtures/layout/clearance/04_clear_left_inside_bfc_ignores_external_floats.html</code></p>
</div>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>Floats, absolutely positioned elements, block containers (such as
inline-blocks, table-cells, and table-captions) that are not block
boxes, and block boxes with 'overflow' other than 'visible'
(except when that value has been propagated to the viewport) establish
new block formatting contexts for their contents.</p>

<p>In a block formatting context, boxes are laid out one after the
other, vertically, beginning at the top of a containing block. The
vertical distance between two sibling boxes is determined by the <a href="box.html#propdef-margin" class="noxref"><span
class="propinst-margin">'margin'</span></a> properties. Vertical margins
between adjacent block-level boxes in a block formatting context <a
href="box.html#collapsing-margins">collapse</a>.
</p>

<p>
In a block formatting context, each box's left outer edge touches the
left edge of the containing block (for right-to-left formatting, right
edges touch).  This is true even in the presence of floats (although a
box's <em>line boxes</em> may shrink due to the floats), unless the box
establishes a new block formatting context (in which case the box itself
<a href="#bfc-next-to-float"><em>may</em> become narrower</a> due to
the floats).
</p>

<p>For information about page breaks in paged media, please consult
the section on <a href="page.html#allowed-page-breaks">allowed
page breaks</a>.
</p>

</details>
<h3>9.4.2 <a name="inline-formatting">Inline formatting contexts</a></h3>
<div data-valor-status="inline-formatting">
 <p><strong>Status:</strong> [TODO]</p>
 <p><strong>Notes:</strong> Inline formatting context (line boxes, anonymous inline handling) is not implemented in this module. Inline content is currently treated simplistically.</p>
 <p><strong>Spec:</strong> https://www.w3.org/TR/CSS22/visuren.html#inline-formatting</p>
 <p><strong>Fixtures:</strong> <em>None</em></p>
</div>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>An inline formatting context is established by a block container
box that contains no block-level boxes.
In an inline formatting context, boxes are laid out horizontally,
one after the other, beginning at the top of a containing
block. Horizontal margins, borders, and padding are respected between
these boxes. The boxes may be aligned vertically in different ways: their
bottoms or tops may be aligned, or the baselines of text within them
may be aligned. The rectangular area that contains the boxes that form
a line is called a <span class="index-def" title="line box"><a
name="line-box"><dfn>line box</dfn></a></span>. 
</p>
<p>The width of a line box is determined by a <a
href="#containing-block">containing block</a> and the presence of floats.  
The height of a line
box is determined by the rules given in the section on <a
href="visudet.html#line-height">line height calculations</a>. 
</p>
<p>A line box is always tall enough for all of the boxes it contains. 
However, it may be taller than the tallest box it contains 
(if, for example, boxes are aligned so that baselines line up). 
When the height of a box B is less than the height of the line box containing it, 
the vertical alignment of B within the line box is determined by 
the <a href="visudet.html#propdef-vertical-align" class="noxref"><span class="propinst-vertical-align">'vertical-align'</span></a> property.
When several inline-level boxes cannot fit horizontally within a single
line box, they are distributed among two or more vertically-stacked
line boxes. Thus, a paragraph is a vertical stack of line boxes. Line
boxes are stacked with no vertical separation (except as specified
elsewhere) and they never overlap.
</p>
<p>In general, the left edge of a line box touches the left edge
of its containing block and the right edge touches the right edge of
its containing block. However, floating boxes may come between the
containing block edge and the line box edge.  Thus, although line
boxes in the same inline formatting context generally have the same
width (that of the containing block), they may vary in width if
available horizontal space is reduced due to <a
href="#floats">floats</a>. Line boxes in the same inline formatting
context generally vary in height (e.g., one line might contain a tall
image while the others contain only text).
</p>
<p>When the total width of the inline-level boxes on a line is less than the
width of the line box containing them, their horizontal distribution
within the line box is determined by the <a href="text.html#propdef-text-align" class="noxref"><span
class="propinst-text-align">'text-align'</span></a> property.  If that
property has the value 'justify', the user agent may stretch spaces
and words in inline boxes (but not inline-table and inline-block
boxes) as well.
</p>

<p>
When an inline box exceeds the width of a line box, it is split into several boxes and these boxes are distributed across several line boxes.  If an inline box cannot be split (e.g., if the inline box contains a single character, or language specific word breaking rules disallow a break within the inline box, or if the inline box is affected by a white-space value of nowrap or pre), then the inline box overflows the line box.
</p>
<p>
When an inline box is split, margins,
borders, and padding have no visual effect where the split occurs (or
at any split, when there are several).
</p>
<p>Inline boxes may also be split into several boxes <em>within the
same line box</em> due to <a href="#direction">bidirectional text
processing</a>.
</p>
<p id="phantom-line-box">Line boxes are created as needed to hold
inline-level content within an inline formatting context. Line boxes
that contain no text, no <a
href="text.html#white-space-prop">preserved white space,</a> no inline
elements with non-zero margins, padding, or borders, and no other <a
href="#positioning-scheme">in-flow</a> content (such as images, inline
blocks or inline tables), and do not end with a preserved newline must
be treated as zero-height line boxes for the purposes of determining
the positions of any elements inside of them, and must be treated as
not existing for any other purpose.
</p>
<div class="html example"><p> 
Here is an example of inline box construction. The following paragraph
(created by the HTML block-level element P) contains anonymous text
interspersed with the elements EM and STRONG:
</p>
<pre><code class="html">
&lt;P&gt;Several &lt;EM&gt;emphasized words&lt;/EM&gt; appear
&lt;STRONG&gt;in this&lt;/STRONG&gt; sentence, dear.&lt;/P&gt;
</code></pre>

<p>The P element generates a block box that contains five inline
boxes, three of which are anonymous:</p>

<ul>
<li>Anonymous: "Several"</li>
<li>EM: "emphasized words"</li>
<li>Anonymous: "appear"</li>
<li>STRONG: "in this"</li>
<li>Anonymous: "sentence, dear."</li>
</ul>
 
<p>To format the paragraph, the user agent flows the five boxes into
line boxes. In this example, the box generated for the P element
establishes the containing block for the line boxes. If the containing
block is sufficiently wide, all the inline boxes will fit into a
single line box:
</p>
<pre>
 Several <em>emphasized words</em> appear <strong>in this</strong> sentence, dear.
</pre>

<p>If not, the inline boxes will be split up and distributed across
several line boxes. The previous paragraph might be split as follows:
</p>
<pre>
Several <em>emphasized words</em> appear
<strong>in this</strong> sentence, dear.
</pre>

or like this:

<pre>
Several <em>emphasized</em>  
<em>words</em> appear <strong>in this</strong> 
sentence, dear.
</pre>

</div>

<p>In the previous example, the EM box was split into two EM boxes
(call them "split1" and "split2"). Margins, borders,
padding, or text decorations have no visible effect after split1 or
before split2.
</p>
<div class="html example"><p>
Consider the following example:
</p>
<pre><code class="html">
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"&gt;
&lt;HTML&gt;
  &lt;HEAD&gt;
    &lt;TITLE&gt;Example of inline flow on several lines&lt;/TITLE&gt;
    &lt;STYLE type="text/css"&gt;
      EM {
        padding: 2px; 
        margin: 1em;
        border-width: medium;
        border-style: dashed;
        line-height: 2.4em;
      }
    &lt;/STYLE&gt;
  &lt;/HEAD&gt;
  &lt;BODY&gt;
    &lt;P&gt;Several &lt;EM&gt;emphasized words&lt;/EM&gt; appear here.&lt;/P&gt;
  &lt;/BODY&gt;
&lt;/HTML&gt;
</code></pre>

<p>Depending on the width of the P, the boxes may be distributed as
follows:</p>

<div class="figure">
<p><img src="./images/inline-layout.png"
     alt="Image illustrating the effect of line breaking on the
display of margins, borders, and padding."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-inline-layout" href="images/longdesc/inline-layout-desc.html" title="Long description for illustration of margin/border
behavior on split inline box">[D]</A></SPAN></p>
</div>

<ul>
<li> The margin is inserted before "emphasized" and after "words". </li>

<li> The padding is inserted before, above, and below
"emphasized" and after, above, and below "words". A
dashed border is rendered on three sides in each case.</li>
</ul>
</div>

</details>
<h3>9.4.3 <a name="relative-positioning">Relative positioning</a></h3>
<div data-valor-status="relative-positioning">
 <p><strong>Status:</strong> [MVP]</p>
 <p><strong>Code:</strong> <code>src/lib.rs::apply_relative_offsets</code> (used in <code>src/lib.rs::prepare_child_position</code>)</p>
 <p><strong>Spec:</strong> https://www.w3.org/TR/CSS22/visuren.html#relative-positioning</p>
 <p><strong>Fixtures:</strong> <em>None yet</em></p>
</div>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>Once a box has been laid out according to the <a
href="#normal-flow">normal flow</a> or floated, it may be shifted relative to
this position. This is called <a name="x35"><span class="index-def" title="relative
positioning"><dfn>relative positioning</dfn></span></a>. Offsetting a box
(B1) in this way has no effect on the box (B2) that follows: B2 is
given a position as if B1 were not offset and B2 is not re-positioned
after B1's offset is applied. This implies that relative positioning
may cause boxes to overlap.
However, if relative positioning causes an 'overflow:auto' or
'overflow:scroll' box to have
overflow, the UA must allow the user to access this content (at its offset
position), which, through the creation of scrollbars, may affect layout.
</p>
<p>A relatively positioned box keeps its normal flow size, including
line breaks and the space originally reserved for it. The section on
<a href="#containing-block">containing blocks</a> explains when a
relatively positioned box establishes a new containing block.
</p>
<p>For relatively positioned elements, 'left' and 'right' move the
box(es) horizontally, without changing their size. 'Left' moves the
boxes to the right, and 'right' moves them to the left. Since boxes
are not split or stretched as a result of 'left' or 'right', the
used values are always: left = -right.
</p>
<p>If both 'left' and 'right' are 'auto' (their initial values), the
used values are '0' (i.e., the boxes stay in their original
position).
</p>
<p>If 'left' is 'auto', its used value is minus the value of 'right'
(i.e., the boxes move to the left by the value of 'right').
</p>
<p>If 'right' is specified as 'auto', its used value is minus the
value of 'left'.
</p>
<p>If neither 'left' nor 'right' is 'auto', the position is
over-constrained, and one of them has to be ignored. If the 'direction' property of the containing block is 'ltr', the value of 'left' wins and 'right'
becomes -'left'. If 'direction' of the containing block is 'rtl', 'right' wins and 'left' is ignored.
</p>
<div class="example"><P style="display:none">Example(s):</P>
<p><strong>Example.</strong> The following three rules are equivalent:
</p>
<pre><code class="css">
div.a8 { position: relative; direction: ltr; left: -1em; right: auto }
div.a8 { position: relative; direction: ltr; left: auto; right: 1em }
div.a8 { position: relative; direction: ltr; left: -1em; right: 5em }
</code></pre>
</div>

<p>The 'top' and 'bottom' properties move relatively positioned
element(s) up or down without changing their size. 'Top' moves the
boxes down, and 'bottom' moves them up. Since boxes
are not split or stretched as a result of 'top' or 'bottom', the
used values are always: top = -bottom.
If both are 'auto', their used values are both '0'. If one of them is
'auto', it becomes the negative of the other. If neither is 'auto',
'bottom' is ignored (i.e., the used value of 'bottom' will be
minus the value of 'top').
</p>

<p class="note">
Note. 
Dynamic movement of relatively positioned boxes can produce
animation effects in scripting environments (see also the <a href="visufx.html#propdef-visibility" class="noxref"><span
class="propinst-visibility">'visibility'</span></a> property). 
Although relative positioning may be used as a form of superscripting and 
subscripting, the line height is not automatically adjusted to take the 
positioning into consideration. See the description of <a
href="visudet.html#line-height">line height calculations</a> for more
information.
</p>
<p>Examples of relative positioning are provided in the section <a
href="#comparison">comparing normal flow, floats, and absolute
positioning</a>.
</p>

</details>
<h2>9.5 <a name="floats">Floats</a></h2>
<div data-valor-status="floats">
 <p><strong>Status:</strong> [Production] (clearance floors, avoidance bands) + [MVP] (full float geometry/line wrapping)</p>
 <p><strong>Code:</strong> <code>src/lib.rs::update_clearance_floors_for_float</code>, <code>src/lib.rs::compute_clearance_floor_for_child</code>, <code>src/lib.rs::compute_float_bands_for_y</code>, <code>src/lib.rs::prepare_child_position</code></p>
 <p><strong>Spec:</strong> https://www.w3.org/TR/CSS22/visuren.html#floats</p>
 <p><strong>Fixtures:</strong> <code>crates/valor/tests/fixtures/layout/clearance/0{1,2,3,4}_*.html</code></p>
</div>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p>A float is a box that is shifted to the left or right on the
current line. The most interesting characteristic of a float (or
"floated" or "floating" box) is that content may flow along its side
(or be prohibited from doing so by the <a href="visuren.html#propdef-clear" class="noxref"><span
class="propinst-clear">'clear'</span></a> property). Content flows down
the right side of a left-floated box and down the left side of a
right-floated box. The following is an introduction to float
positioning and content flow; the exact <a
href="#float-rules">rules</a> governing float behavior are given in
the description of the <a href="visuren.html#propdef-float" class="noxref"><span class="propinst-float">'float'</span></a>
property.
</p>
<p>
A floated box is
shifted to the left or right until its outer edge touches the
containing block edge or the outer edge of another float. 
If there is a line box, the outer top of the floated box is aligned with 
the top of the current line box.
</p>
<p>
If there is not enough horizontal room for the
float, it is shifted downward until either it fits or there are no
more floats present.
</p>
<p>Since a float is not in the flow, non-positioned block boxes
created before and after the float box flow vertically as if the float
did not exist. However,
the current and subsequent
line boxes created next to the float are
shortened
as necessary
to make room for the margin box of the float.

<p>A line box is next to a float when there exists a vertical position
that satisfies all of these four conditions: (a) at or below the top
of the line box, (b) at or above the bottom of the line box, (c) below
the top margin edge of the float, and (d) above the bottom margin edge
of the float.

<p class=note>Note: this means that floats with zero outer height or
negative outer height do not shorten line boxes.

<p>If a shortened line box is too small to contain any content, then
the line box is shifted downward (and its width recomputed) until
either some content fits or there are no more floats present.
Any content in the current line before a floated box is reflowed 
in the same line on the other side of the float.
In other words, if inline-level boxes are placed 
on the line before a left float is encountered that fits in the remaining line box space, 
the left float is placed on that line, aligned with the top of the line box, and then the inline-level boxes already on the line are moved accordingly to the right of the float (the right being the other side of the left float) and vice versa for rtl and right floats.
</p>

<p id="bfc-next-to-float">
The border box of a table, a block-level replaced element, or an element in the normal flow that establishes a new <a href="visuren.html#block-formatting">block formatting context</a> 
(such as an element with 'overflow' other than 'visible')
must not overlap the margin box of any floats in the same block
formatting context as
the element itself. If necessary, implementations should clear the
said element by placing it below any preceding floats, but may place
it adjacent to such floats if there is sufficient space.
They may even make the border box of said element narrower than
defined by <a href="visudet.html#blockwidth">section&nbsp;10.3.3.</a>
CSS2 does not define when a UA may put said element next to the float
or by how much said element may become narrower.
</p>
<div class="example"><P style="display:none">Example(s):</P>
<p><strong>Example.</strong> 
In the following document fragment, the containing block is too narrow 
to contain the content next to the float, 
so the content gets moved to below the floats 
where it is aligned in the line box according to the text-align 
property.
</p>
<pre><code class="css">
p { width: 10em; border: solid aqua; }
span { float: left; width: 5em; height: 5em; border: solid blue; }
</code>

...

<code class="html">
&lt;p&gt;
  &lt;span&gt; &lt;/span&gt;
  Supercalifragilisticexpialidocious
&lt;/p&gt;
</code></pre>
<p>This fragment might look like this:</p>
<div class="figure"><p>
<img style="display:block" src="images/supercal.png" 
 alt="Image illustrating the effect of an unbreakable piece of content 
 being reflowed to just after a float which left insufficient room next to it 
 for the content to fit." >
</p>
</div>
</div>

<p>Several floats may be adjacent, and this model also applies to
adjacent floats in the same line.
</p>
<div class="example"><P style="display:none">Example(s):</P><p>
The following rule floats all IMG boxes with
<samp>class="icon"</samp> to the left (and
sets the left margin to '0'):</p>

<pre><code class="css">
img.icon { 
  float: left;
  margin-left: 0;
}
</code></pre>
</div>


<div class="html example"><p>
Consider the following HTML source and style sheet:</p>

<pre><code class="html">  
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"&gt;
&lt;HTML&gt;
  &lt;HEAD&gt;
    &lt;TITLE&gt;Float example&lt;/TITLE&gt;
    &lt;STYLE type="text/css"&gt;
      IMG { float: left }
      BODY, P, IMG { margin: 2em }
    &lt;/STYLE&gt;
  &lt;/HEAD&gt;
  &lt;BODY&gt;
    &lt;P&gt;&lt;IMG src=img.png alt="This image will illustrate floats"&gt;
       Some sample text that has no other...
  &lt;/BODY&gt;
&lt;/HTML&gt;
</code></pre>

<p>The IMG box is floated to the left. The content that follows is
formatted to the right of the float, starting on the same line as the
float. The line boxes to the right of the float are shortened due to
the float's presence, but resume their "normal" width (that of the
containing block established by the P element) after the float.  This
document might be formatted as:</p>

<div class="figure">
<p><img src="./images/floateg.png"
     alt="Image illustrating how floating boxes interact with
margins."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-floateg" href="images/longdesc/floateg-desc.html" title="Long description of float and text flow example">[D]</A></SPAN></p>
</div>

<p>Formatting would have been exactly the same if the document had
been:
</p>
<pre><code class="html">
&lt;BODY&gt;
  &lt;P&gt;Some sample text 
  &lt;IMG src=img.png alt="This image will illustrate floats"&gt;
           that has no other...
&lt;/BODY&gt;
</code></pre>

<p>because the content to the left of the float is displaced by
the float and reflowed down its right side.
</p></div>

<p>As stated in <a href="box.html#collapsing-margins">section 8.3.1</a>, 
the margins of floating boxes never <a
href="box.html#collapsing-margins">collapse</a> with margins of
adjacent boxes. Thus, in the previous example, vertical margins do not
<a href="box.html#collapsing-margins">collapse</a> between the P box
and the floated IMG box.
</p>
<p>
The contents of floats are stacked as if floats generated new 
stacking contexts, except that any positioned elements and elements
that actually create new
stacking contexts take part in the float's parent stacking context. 
A float can overlap other boxes in the normal flow (e.g., when a 
normal flow box next to a float has negative margins). When this 
happens, floats are rendered in front of non-positioned in-flow 
blocks, but behind in-flow inlines.
</p>
<div class="example"><P style="display:none">Example(s):</P>
<p>Here is another illustration, showing what happens when a float
overlaps borders of elements in the normal flow.
</p>
<div class="figure">
<p><img src="images/float2p.png" alt="Image showing a floating image
that overlaps the borders of two paragraphs: the borders are
interrupted by the image."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-float2p" href="images/longdesc/float2p-desc.html" title="Long description of how floats overlap with boxes in normal
      flow">[D]</A></SPAN>
</p>
<p class="caption">A floating image obscures borders
of block boxes it overlaps.
</p>
</div>
</div>

<p>The following example illustrates the use of the <a href="visuren.html#propdef-clear" class="noxref"><span
class="propinst-clear">'clear'</span></a> property to prevent content
from flowing next to a float.
</p>
<div class="example"><P style="display:none">Example(s):</P>
<p>Assuming a rule such as this:
</p>
<pre><code class="css">
p { clear: left }
</code></pre>

<p>formatting might look like this:
</p>
<div class="figure">
<p><img src="images/floatclear.png" alt="Image showing a floating
image and the effect of 'clear: left' on the two paragraphs."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-floatclear" href="images/longdesc/floatclear-desc.html" title="Long description of how floats overlap with boxes in normal
      flow">[D]</A></SPAN>
</p>
<p class="caption">Both paragraphs have set 'clear: left', which
causes the second paragraph to be "pushed down" to a position below
the float &mdash; "clearance" is added above its top margin to
accomplish this (see the <a href="visuren.html#propdef-clear" class="noxref"><span
class="propinst-clear">'clear'</span></a> property).
</p>
</div>
</div>

</details>
<h3>9.5.1 <a name="float-position">Positioning the float:</a> the
<a href="visuren.html#propdef-float" class="noxref"><span class="propinst-float">'float'</span></a> property</h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x36"><span class="index-def" title="'float'"><dfn id="propdef-float">float</dfn></span></a><tr><th>Value:<td>left | right | none | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>none
<tr><th>Applies to:<td>all, but see <a href="visuren.html#dis-pos-flo">9.7</a>
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>as specified
</table>

<p>This property specifies whether a box should float to the left,
right, or not at all. It may be set for any element, but only applies to 
elements that generate boxes that are not 
<a href="#absolutely-positioned">absolutely positioned</a>.  
The values of this property have
the following meanings:</p>

<dl>
<dt><strong>left</strong></dt>

<dd>The element generates a <a href="#block-boxes">block</a> box that is
floated to the left. Content flows on the right side of the box,
starting at the top (subject to the <a href="visuren.html#propdef-clear" class="noxref"><span
class="propinst-clear">'clear'</span></a> property). 
</dd>
<dt><strong>right</strong></dt>

<dd>Similar to 'left', except the box is floated to the right, and content flows on the left side of the box, starting at the top.</dd>

<dt><strong>none</strong></dt>

<dd>The box is not floated.</dd>
</dl>

<p>
User agents may treat float as 'none' on the root element. 
</p>


<p><span class="index-def" title="float rules"><a
name="float-rules">Here are the precise rules</a></span> that
govern the behavior of floats:</p>

<ol>
<li> The left <a href="box.html#outer-edge">outer edge</a> of a
left-floating box may not be to the left of the left edge of its <a
href="#containing-block">containing block</a>. An
analogous rule holds for right-floating elements.
</li>
<li> If the current box is left-floating, and there are any left-floating 
boxes generated by elements earlier in the source document,
then for each such earlier box, either the left <a
href="box.html#outer-edge">outer edge</a> of the current box must be
to the right of the right <a href="box.html#outer-edge">outer edge</a>
of the earlier box, or its top must be lower than the bottom of the
earlier box. Analogous rules hold for right-floating boxes.
</li>
<li>The right <a href="box.html#outer-edge">outer edge</a> of a
left-floating box may not be to the right of the left <a
href="box.html#outer-edge">outer edge</a> of any right-floating
box that is next to it. Analogous rules hold for
right-floating elements.
</li>
<li>A floating box's <a href="box.html#outer-edge">outer top</a>
may not be higher than the top of its <a
href="#containing-block">containing block</a>.
When the float occurs between two collapsing margins, the
float is positioned as if it had an otherwise empty <a
href="#anonymous-block-level">anonymous block parent</a> taking part in
the flow. The position of such a parent is defined by <a
href="box.html#collapsed-through">the rules</a> in the section on margin
collapsing.
</li>
<li> The <a href="box.html#outer-edge">outer top</a> of a floating box
may not be higher than the outer top of any <a
href="#block-boxes">block</a> or <a
href="#floats">floated</a> box generated by an element
earlier in the source document.
</li>
<li>The <a href="box.html#outer-edge">outer top</a> of an element's
floating box may not be higher than the top of any <span
class="index-inst" title="line-box"><a name="x38"
href="#line-box">line-box</a></span> containing a box
generated by an element earlier in the source document.
</li>
<li>A left-floating box that has another left-floating box to its left
may not have its right outer edge to the right of its containing
block's right edge. (Loosely: a left float may not stick out at the
right edge, unless it is already as far to the left as possible.) An
analogous rule holds for right-floating elements.
</li>
<li> A floating box must be placed as high as possible.
</li>
<li> A left-floating box must be put as far to the left as
possible, a right-floating box as far to the right as possible. A
higher position is preferred over one that is further to the
left/right.
</li>
</ol>

<p>But in CSS&nbsp;2.2, if, within the block formatting context, there
is an in-flow negative vertical margin such that the float's position
is above the position it would be at were all such negative margins
set to zero, the position of the float is undefined.

<p>References to other elements in these rules refer only to other elements in the same <a href="#block-formatting">block formatting context</a> as the float.
</p>

<div class=example><P style="display:none">Example(s):</P>
<p>This HTML fragment results in the b floating to the right.

<pre>&lt;P>a&lt;SPAN style="float: right">b&lt;/SPAN>&lt;/P></pre>

<p>If the P element's width is enough, the a and the b will be side by
side. It might look like this:

<div class=figure>
<p><img src="images/float-right.png"
alt="An a at the left side of a box and a b at the right side">
</div>
</div>

</details>
<h3>9.5.2 <a name="flow-control">Controlling flow next to floats:</a>
the <a href="visuren.html#propdef-clear" class="noxref"><span class="propinst-clear">'clear'</span></a> property</h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x39"><span class="index-def" title="'clear'"><dfn id="propdef-clear">clear</dfn></span></a><tr><th>Value:<td>none | left | right | both | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>none
<tr><th>Applies to:<td>block-level elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>as specified
</table>

<p>This property indicates which sides of an element's box(es) may
<em>not</em> be adjacent to an earlier floating box. The 'clear'
property does not consider floats inside the element itself or in
other <a href="visuren.html#block-formatting">block formatting
contexts.</a>
</p>

<p>Values have the following meanings when applied to non-floating
block-level boxes:</p>

<dl>
<dt><strong>left</strong></dt>

<dd>Requires that the top border edge of the box be below the bottom
outer edge of any left-floating boxes that resulted from elements
earlier in the source document.
</dd>

<dt><strong>right</strong></dt>

<dd>Requires that the top border edge of the box be below the bottom
outer edge of any right-floating boxes that resulted from elements
earlier in the source document.
</dd>

<dt><strong>both</strong></dt>

<dd>Requires that the top border edge of the box be below the bottom
outer edge of any right-floating and left-floating boxes that resulted
from elements earlier in the source document.
</dd>

<dt><strong>none</strong></dt>

<dd>No constraint on the box's position with respect to floats.</dd>
</dl>

<p>Values other than 'none' potentially introduce <dfn><span
class="index-def"><a name="clearance">clearance</a></span>.</dfn>
Clearance inhibits margin collapsing
and acts as spacing above the margin-top of an element. It is used to
push the element vertically past the float.

<p>Computing the clearance of an element on which 'clear' is set is
done by first determining the hypothetical position of the element's
top border edge. This position is
where the actual top border edge would have been if the element's
'clear' property had been 'none'.

<p>If this hypothetical position of the element's top border edge is
not past the relevant floats, then clearance is introduced, and
margins collapse according to the rules in 8.3.1.

<p>Then the amount of clearance is set to the greater of:

<ol>
  <li>The amount necessary to place the border edge of the block even
  with the bottom outer edge of the lowest float that is to be
  cleared.
 
  <li>The amount necessary to place the top border edge of the block
  at its hypothetical position.
</ol>

<p>Alternatively, clearance is set exactly to the amount necessary to
place the border edge of the block even with the bottom outer edge of
the lowest float that is to be cleared.

<p class="note"><em><strong>Note:</strong> Both behaviors are allowed
pending evaluation of their compatibility with existing Web content. A
future CSS specification will require either one or the other.</em>

<p class=note>
Note: The clearance can be negative or zero.

<div class=example><P style="display:none">Example(s):</P>
<p>Example 1. Assume (for the sake of simplicity), that we have just
three boxes, in this order: block B1 with a bottom margin of M1 (B1
has no children and no padding or border), floating block F with a
height H, and block B2 with a top margin of M2 (no padding or border,
no children). B2 has 'clear' set to 'both'. We also assume B2 is not
empty.

<p>Without considering the 'clear' property on B2, we have the situation in 
the diagram below. The margins of B1 and B2 collapse. Let's say the 
bottom border edge of B1 is at y = 0, then the top of F is at y = M1, 
the top border edge of B2 is at y = max(M1,M2), and the bottom of F is 
at y = M1 + H.

<div class="figure">
<p><img src="./images/clearance.png"
     alt="Float F extends into the margin above M2."></p>
</div>

<p>We also assume that B2 is not below F, i.e., we are in the
situation described in the spec where we need to add clearance. That
means:

<blockquote>
<p>max(M1,M2) &lt; M1 + H
</blockquote>

<p>We need to compute clearance C twice, C1 and C2, and 
keep the greater of the two: C = max(C1,C2). The first way is to put 
the top of B2 flush with the bottom of F, i.e., at y = M1 + H. That 
means, because the margins no longer collapse with a clearance between 
them:

<blockquote class=math>
<p> <span>bottom of F</span> <span>= top border edge of B2</span> <span>&#8660;</span>
<p>      <span>M1 + H</span> <span>= M1 + C1 + M2</span>          <span>&#8660;</span>
<p>          <span>C1</span> <span>= M1 + H - M1 - M2</span>
<p>            <span></span> <span>= H - M2</span>
</blockquote>

<p>The second computation is to keep the top of B2 where it is, i.e., at y 
= max(M1,M2). That means:

<blockquote class=math>
<p> <span>max(M1,M2)</span> <span>= M1 + C2 + M2</span>          <span>&#8660;</span>
<p>         <span>C2</span> <span>= max(M1,M2) - M1 - M2</span>
</blockquote>

<p>We assumed that max(M1,M2) &lt; M1 + H, which implies

<blockquote class=math>
<p> <span>C2 = max(M1,M2) - M1 - M2</span> <span>&lt; M1 + H - M1 - M2 = H - M2</span> <span>&#8658;</span>
<p>                        <span>C2</span> <span>&lt; H - M2</span>
</blockquote>

<p>And, as C1 = H - M2, it follows that

<blockquote class=math>
<p> <span>C2 &lt; C1</span>
</blockquote>

<p>and hence

<blockquote class=math>
<p> <span>C = max(C1,C2) = C1</span>
</blockquote>
</div>

<div class=example><P style="display:none">Example(s):</P>
<p>Example 2. An example of negative clearance is this situation, in
which the
clearance is -1em. (Assume none of the elements have borders or
padding):

<pre class=html>
&lt;p style="<b>margin-bottom: 4em</b>">
  First paragraph.

&lt;p style="<b>float: left; height: 2em; margin: 0</b>">
  Floating paragraph.

&lt;p style="<b>clear: left; margin-top: 3em</b>">
  Last paragraph.
</pre>

<p>Explanation: Without the 'clear', the first and last paragraphs'
margins would collapse and the last paragraph's top border edge would
be flush with the top of the floating paragraph. But the 'clear'
requires the top border edge to be <em>below</em> the float, i.e., 2em
lower. This means that clearance must be introduced.  Accordingly, the
margins no longer collapse and the amount of clearance is set so that
clearance + margin-top = 2em, i.e., clearance = 2em - margin-top = 2em
- 3em = -1em.
</div>

<p>When the property is set on floating elements, it results in a
modification of the <a href="#float-rules">rules</a> for
positioning the float. An extra constraint (#10) is added:
</p>

<ul>
<li>The top <a href="box.html#outer-edge">outer edge</a> 
of the float must be below the bottom outer
edge of all earlier left-floating boxes (in the case of 'clear:
left'), or all earlier right-floating boxes (in the case of 'clear:
right'), or both ('clear: both').</li>
</ul>

<div class="note"><p>
<em><strong>Note.</strong>
This property <a href="https://www.w3.org/TR/REC-CSS1/#clear">applied to all elements in CSS1</a>. Implementations 
may therefore have supported this property on all elements. In CSS2 
and CSS&nbsp;2.2 the 'clear' property only applies to block-level elements. 
Therefore authors should only use this property on block-level
elements.  If an implementation does support clear on inline elements, 
rather than setting a clearance as explained above, 
the implementation should force a break and effectively insert one or more empty line boxes (or shifting the new line box downward as described in <a href="#floats">section 9.5</a>) to move the top of the cleared inline's line box to below the respective floating box(es).
</em>
</p>
</div>

</details>
<h2>9.6 <a name="absolute-positioning">Absolute positioning</a></h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p>In the absolute positioning model, a box is explicitly offset with
respect to its containing block.  It is removed from the normal flow
entirely (it has no impact on later siblings).  An absolutely
positioned box establishes a new containing block for normal flow
children and absolutely (but not fixed) positioned descendants.  However, the contents of an
absolutely positioned element do not flow around any other boxes. They
may obscure the contents of another box (or be obscured themselves), 
depending on the
<a href="#stack-level">stack levels</a> of the overlapping boxes.
</p>
<p>References in this specification to an <span class="index-def"
title="absolutely positioned element">
<a name="absolutely-positioned"><dfn>absolutely positioned
element</dfn></a></span> (or its box) imply that the element's <a href="visuren.html#propdef-position" class="noxref"><span
class="propinst-position">'position'</span></a> property has the value
'absolute' or 'fixed'.
</p>

</details>
<h3>9.6.1 <a name="fixed-positioning">Fixed positioning</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>Fixed positioning is a subcategory of absolute positioning. The
only difference is that for a fixed positioned box, the containing
block is established by the <a href="#viewport">viewport</a>.  For <a
href="media.html#continuous-media-group">continuous media</a>, fixed
boxes do not move when the document is scrolled. In this respect, they
are similar to <a href="colors.html#background-properties">fixed
background images</a>.  For <a href="page.html">paged media</a>, boxes
with fixed positions are repeated on every page. This is useful for
placing, for instance, a signature at the bottom of each page.
Boxes with fixed position that are larger than the page area are
clipped. Parts of the fixed position box that are not visible in the
initial containing block will not print.
</p>
<div class="html example">
<p>Authors may use fixed positioning to create frame-like presentations.
Consider the following frame layout:</p>

<div class="figure">
<p><img src="./images/frame.png"
     alt="Image illustrating a frame-like layout with position='fixed'."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-frame" href="images/longdesc/frame-desc.html" title="Long description for frame layout example">[D]</A></SPAN></p>
</div>

<p>This might be achieved with the following HTML document and
style rules:</p>

<pre><code class="html">
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"&gt;
&lt;HTML&gt;
  &lt;HEAD&gt;
    &lt;TITLE&gt;A frame document with CSS&lt;/TITLE&gt;
    &lt;STYLE type="text/css" media="screen"&gt;
      BODY { height: 8.5in } /* Required for percentage heights below */
      #header {
        position: fixed;
        width: 100%;
        height: 15%;
        top: 0;
        right: 0;
        bottom: auto;
        left: 0;
      }
      #sidebar {
        position: fixed;
        width: 10em;
        height: auto;
        top: 15%;
        right: auto;
        bottom: 100px;
        left: 0;
      }
      #main {
        position: fixed;
        width: auto;
        height: auto;
        top: 15%;
        right: 0;
        bottom: 100px;
        left: 10em;
      }
      #footer {
        position: fixed;
        width: 100%;
        height: 100px;
        top: auto;
        right: 0;
        bottom: 0;
        left: 0;
      }
    &lt;/STYLE&gt;
  &lt;/HEAD&gt;
  &lt;BODY&gt;
    &lt;DIV id="header"&gt; ...  &lt;/DIV&gt;
    &lt;DIV id="sidebar"&gt; ...  &lt;/DIV&gt;
    &lt;DIV id="main"&gt; ...  &lt;/DIV&gt;
    &lt;DIV id="footer"&gt; ...  &lt;/DIV&gt;
  &lt;/BODY&gt;
&lt;/HTML&gt;
</code></pre>
</div>

</details>
<h2>9.7 <a name="dis-pos-flo">Relationships between 'display', 'position',
and 'float'</a></h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p>The three properties that affect box generation and layout &mdash; 
<a href="visuren.html#propdef-display" class="noxref"><span class="propinst-display">'display'</span></a>, 
<a href="visuren.html#propdef-position" class="noxref"><span class="propinst-position">'position'</span></a>, and 
<a href="visuren.html#propdef-float" class="noxref"><span class="propinst-float">'float'</span></a> &mdash; interact as follows:</p>

<ol>
<li>If <a href="visuren.html#propdef-display" class="noxref"><span class="propinst-display">'display'</span></a>
has the value 'none', then 
<a href="visuren.html#propdef-position" class="noxref"><span class="propinst-position">'position'</span></a> and
<a href="visuren.html#propdef-float" class="noxref"><span class="propinst-float">'float'</span></a> do not apply. 
In this case, the element generates no box.</li>

<li>Otherwise, if <a href="visuren.html#propdef-position" class="noxref"><span class="propinst-position">'position'</span></a>
has the value 'absolute' or 'fixed', the box is absolutely positioned, 
the computed
value of <a href="visuren.html#propdef-float" class="noxref"><span class="propinst-float">'float'</span></a> is 'none',  
and display is set according to the table below.  
The position of the box will be determined by the <a href="visuren.html#propdef-top" class="noxref"><span
class="propinst-top">'top'</span></a>, <a href="visuren.html#propdef-right" class="noxref"><span
class="propinst-right">'right'</span></a>, <a href="visuren.html#propdef-bottom" class="noxref"><span
class="propinst-bottom">'bottom'</span></a> and <a href="visuren.html#propdef-left" class="noxref"><span
class="propinst-left">'left'</span></a> properties and the box's 
containing block.
</li>

<li>Otherwise, if 'float' has a value other than 'none', the box is
floated and 'display' is set according to the table below.
</li>

<li>Otherwise, if the element is the root element, 
'display' is set according to the table below, except that it is
undefined in CSS&nbsp;2.2 whether a specified value of 'list-item'
becomes a computed value of 'block' or 'list-item'.</li>

<li>Otherwise, the remaining <a href="visuren.html#propdef-display" class="noxref"><span
class="propinst-display">'display'</span></a> property values apply
as specified.
</li>
</ol>

<table border="1">
<tr><th>Specified value </th><th style="width:30%">Computed value</th></tr>
<tr><td>inline-table </td><td>table</td></tr>
<tr><td>inline, table-row-group, table-column,
table-column-group, table-header-group, table-footer-group, table-row,
table-cell, table-caption, inline-block </td><td>block</td></tr>
<tr><td>others </td><td>same as specified</td></tr>
</table>

</details>
<h2>9.8 <a name="comparison">Comparison of normal flow, floats,  
and absolute positioning</a></h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p>To illustrate the differences between normal flow, relative
positioning, floats, and absolute positioning, we provide a series of
examples based on the following HTML:
</p>
<pre class="html example"><code class="html">
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"&gt;
&lt;HTML&gt;
  &lt;HEAD&gt;
    &lt;TITLE&gt;Comparison of positioning schemes&lt;/TITLE&gt;
  &lt;/HEAD&gt;
  &lt;BODY&gt;
    &lt;P&gt;Beginning of body contents.
      &lt;SPAN id="outer"&gt; Start of outer contents.
      &lt;SPAN id="inner"&gt; Inner contents.&lt;/SPAN&gt;
      End of outer contents.&lt;/SPAN&gt;
      End of body contents.
    &lt;/P&gt;
  &lt;/BODY&gt;
&lt;/HTML&gt;
</code></pre>

<p>In this document, we assume the following rules:</p>

<pre class="example"><code class="css">
body { display: block; font-size:12px; line-height: 200%; 
       width: 400px; height: 400px }
p    { display: block }
span { display: inline }
</code></pre>

<p>The final positions of boxes generated by the <em>outer</em> and
<em>inner</em> elements vary in each example. In each illustration,
the numbers to the left of the illustration indicate the <a
href="#normal-flow">normal flow</a> position of the double-spaced (for
clarity) lines. </p>

<p class="note">
Note. The diagrams in this section are illustrative and not to 
scale. They are meant to highlight the differences between the 
various positioning schemes in CSS 2.2, and are not intended to be 
reference renderings of the examples given.
</p>

</details>
<h3>9.8.1 <a name="comp-normal-flow">Normal flow</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>Consider the following CSS declarations for <em>outer</em> and
<em>inner</em> that do not alter the <a href="#normal-flow">normal
flow</a> of boxes:</p>

<pre class="example"><code class="css">
#outer { color: red }
#inner { color: blue }
</code></pre>

<p>The P element contains all inline content: <a
href="#anonymous">anonymous inline text</a> and two SPAN
elements. Therefore, all of the content will be laid out
in an inline formatting context, within a containing block
established by the P element, producing something like:</p>

<div class="figure">
<p><img src="./images/flow-generic.png"
     alt="Image illustrating the normal flow of text between parent and sibling boxes."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-flow-generic" href="images/longdesc/flow-generic-desc.html" title="Long description for normal flow example">[D]</A></SPAN></p>
</div>

</details>
<h3>9.8.2 <a name="comp-relpos">Relative positioning</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>To see the effect of <a href="#relative-positioning">relative
positioning</a>, we specify:</p>

<pre class="example"><code class="css">
#outer { position: relative; top: -12px; color: red }
#inner { position: relative; top: 12px; color: blue }
</code></pre>

<p>Text flows normally up to the <em>outer</em> element.  The
<em>outer</em> text is then flowed into its normal flow position and
dimensions at the end of line 1. Then, the inline boxes containing the
text (distributed over three lines) are shifted as a unit by '-12px'
(upwards).
</p>

<p>The contents of <em>inner</em>, as a child of <em>outer</em>, would
normally flow immediately after the words "of outer contents" (on line
1.5). However, the <em>inner</em> contents are themselves offset
relative to the <em>outer</em> contents by '12px' (downwards), back to
their original position on line 2.
</p>

<p>Note that the content following <em>outer</em> is not affected by the
relative positioning of <em>outer</em>.</p>

<div class="figure">
<p><img src="./images/flow-relative.png"
     alt="Image illustrating the effects of relative positioning on a
box's content."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-flow-relative" href="images/longdesc/flow-relative-desc.html" title="Long description for relative flow example">[D]</A></SPAN></p>
</div>

<p>Note also that had the offset of <em>outer</em> been '-24px', the
text of <em>outer</em> and the body text would have overlapped.
</p>

</details>
<h3>9.8.3 <a name="comp-float">Floating a box</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>Now consider the effect of <a href="#floats">floating</a> the
<em>inner</em> element's text to the right by means of the following
rules:
</p>
<pre class="example"><code class="css">
#outer { color: red }
#inner { float: right; width: 130px; color: blue }
</code></pre>

<p>Text flows normally up to the <em>inner</em> box, which is pulled
out of the flow and floated to the right margin (its <a href="visudet.html#propdef-width" class="noxref"><span
class="propinst-width">'width'</span></a> has been assigned explicitly).
Line boxes to the left of the float are shortened, and the 
document's remaining text flows into them.</p>

<div class="figure">
<p><img src="./images/flow-float.png"
     alt="Image illustrating the effects of floating a box."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-flow-float" href="images/longdesc/flow-float-desc.html" title="Long description of example illustrating floating">[D]</A></SPAN></p>
</div>

<p>To show the effect of the <a href="visuren.html#propdef-clear" class="noxref"><span
class="propinst-clear">'clear'</span></a> property, we add a <em>sibling</em>
element to the example:
</p>
<pre class="html example"><code class="html">
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"&gt;
&lt;HTML&gt;
  &lt;HEAD&gt;
    &lt;TITLE&gt;Comparison of positioning schemes II&lt;/TITLE&gt;
  &lt;/HEAD&gt;
  &lt;BODY&gt;
    &lt;P&gt;Beginning of body contents.
      &lt;SPAN id=outer&gt; Start of outer contents.
      &lt;SPAN id=inner&gt; Inner contents.&lt;/SPAN&gt;
      &lt;SPAN id=sibling&gt; Sibling contents.&lt;/SPAN&gt;
      End of outer contents.&lt;/SPAN&gt;
      End of body contents.
    &lt;/P&gt;
  &lt;/BODY&gt;
&lt;/HTML&gt;
</code></pre>

<p>The following rules:
</p>
<pre class="example"><code class="css">
#inner { float: right; width: 130px; color: blue }
#sibling { color: red }
</code></pre>

<p>cause the <em>inner</em> box to float to the right as before and the
document's remaining text to flow into the vacated space:</p>

<div class="figure">
<p><img src="./images/flow-clear.png"
     alt="Image illustrating the effects of floating a box without
setting the clear property to control the flow of text around the
box."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-flow-clear" href="images/longdesc/flow-clear-desc.html" title="Long description of example illustrating floating
without clear">[D]</A></SPAN></p>
</div>

<p>However, if the <a href="visuren.html#propdef-clear" class="noxref"><span class="propinst-clear">'clear'</span></a>
property on the <em>sibling</em> element is set to 'right' (i.e., the
generated <em>sibling</em> box will not accept a position next to
floating boxes to its right), the <em>sibling</em> content begins to
flow below the float:
</p>
<pre class="example"><code class="css">
#inner { float: right; width: 130px; color: blue }
#sibling { clear: right; color: red }
</code></pre>

<div class="figure">
<p><img src="./images/flow-clear2.png" 
alt="Image illustrating the effects of floating an element with setting the clear property to control the flow of text around the element."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-flow-clear2" href="images/longdesc/flow-clear2-desc.html" title="Long description of example illustrating floating
with clear">[D]</A></SPAN></p>
</div>

</details>
<h3>9.8.4 <a name="comp-abspos">Absolute positioning</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>Finally, we consider the effect of <a
href="#absolute-positioning">absolute positioning</a>.
Consider the following CSS declarations for <em>outer</em> and
<em>inner</em>:</p>

<pre class="example"><code class="css">
#outer { 
    position: absolute; 
    top: 200px; left: 200px; 
    width: 200px; 
    color: red;
}
#inner { color: blue }
</code></pre>

<p>which cause the top of the <em>outer</em> box to be positioned with
respect to its containing block. The containing block for a positioned
box is established by the nearest positioned ancestor (or, if none
exists, the <a href="visudet.html#containing-block-details">initial containing
block</a>, as in our example). The top side of the <em>outer</em> box
is '200px' below the top of the containing block and the left side is
'200px' from the left side. The child box of <em>outer</em> is flowed
normally with respect to its parent.</p>

<div class="figure">
<p><img src="./images/flow-absolute.png"
   alt="Image illustrating the effects of absolutely positioning a box."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-flow-absolute" href="images/longdesc/flow-absolute-desc.html" title="Long description for example illustrating absolute positioning">[D]</A></SPAN></p>
</div>

<p>The following example shows an absolutely positioned box that is a
child of a relatively positioned box. Although the parent
<em>outer</em> box is not actually offset, setting its <a href="visuren.html#propdef-position" class="noxref"><span
class="propinst-position">'position'</span></a> property to 'relative'
means that its box may serve as the containing block for positioned
descendants. Since the <em>outer</em> box is an inline box that is
split across several lines, the first inline box's top and left edges
(depicted by thick dashed lines in the illustration below)
serve as references for <a href="visuren.html#propdef-top" class="noxref"><span class="propinst-top">'top'</span></a> and
<a href="visuren.html#propdef-left" class="noxref"><span class="propinst-left">'left'</span></a> offsets.
</p>
<pre class="example"><code class="css">
#outer { 
  position: relative; 
  color: red 
}
#inner { 
  position: absolute; 
  top: 200px; left: -100px; 
  height: 130px; width: 130px; 
  color: blue;
}
</code></pre>

<p>This results in something like the following:</p>

<div class="figure">
<p><img src="./images/flow-abs-rel.png"
     alt="Image illustrating the effects of absolutely positioning a
box with respect to a containing block."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-flow-abs-rel" href="images/longdesc/flow-abs-rel-desc.html" title="Long description for example illustrating positioning
with respect to a positioned ancestor">[D]</A></SPAN></p>
</div>

<p>If we do not position the <em>outer</em> box:</p>

<pre class="example"><code class="css">
#outer { color: red }
#inner {
  position: absolute; 
  top: 200px; left: -100px; 
  height: 130px; width: 130px; 
  color: blue;
}
</code></pre>

<p>the containing block for <em>inner</em> becomes the <a
href="visudet.html#containing-block-details">initial containing block</a> (in our
example). The following illustration shows where the <em>inner</em>
box would end up in this case.</p>


<div class="figure">
<p><img src="./images/flow-static.png"
     alt="Image illustrating the effects of absolutely positioning a box with respect to a containing block established by a normally positioned parent."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-flow-static" href="images/longdesc/flow-static-desc.html" title="Long description illustrating absolute positioning
with respect to the initial containing block">[D]</A></SPAN></p>
</div>

<div class="html example"><p>
Relative and absolute positioning may be used to implement change
bars, as shown in the following example. The following fragment:
</p>
<pre><code class="html">
&lt;P style=&quot;position: relative; margin-right: 10px; left: 10px;&quot;&gt;
I used two red hyphens to serve as a change bar. They
will &quot;float&quot; to the left of the line containing THIS
&lt;SPAN style=&quot;position: absolute; top: auto; left: -1em; color: red;&quot;&gt;--&lt;/SPAN&gt;
word.&lt;/P&gt;
</code></pre>

<p>might result in something like:</p>

<div class="figure">
<p><img src="./images/changebar.png"
     alt="Image illustrating the use of floats to create a changebar effect."><SPAN class="dlink">&nbsp;&nbsp;&nbsp;<A name="img-changebar" href="images/longdesc/changebar-desc.html" title="Long description for change bar example">[D]</A></SPAN></p>
</div>

<p>First, the paragraph (whose containing block sides are shown in the
illustration) is flowed normally. Then it is offset '10px' from the
left edge of the containing block (thus, a right margin of '10px' has
been reserved in anticipation of the offset).  The two hyphens acting
as change bars are taken out of the flow and positioned at the current
line (due to 'top: auto'), '-1em' from the left edge of its containing
block (established by the P in its final position).  The result is
that the change bars seem to "float" to the left of the current
line.</p>
</div>

</details>
<h2>9.9 <a name="layers">Layered presentation</a></h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

</details>
<h3>9.9.1 <a name="z-index">Specifying the stack level</a>: the <a href="visuren.html#propdef-z-index" class="noxref"><span
 class="propinst-z-index">'z-index'</span></a> property</h3>
<div data-valor-status="z-index">
 <p><strong>Status:</strong> [TODO]</p>
 <p><strong>Notes:</strong> No stacking context computation yet. This module does not handle painting order or z-index.</p>
 <p><strong>Spec:</strong> https://www.w3.org/TR/CSS22/visuren.html#z-index</p>
 <p><strong>Fixtures:</strong> <em>None</em></p>
</div>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x42"><span class="index-def" title="'z-index'"><dfn id="propdef-z-index">z-index</dfn></span></a><tr><th>Value:<td>auto | <a href="syndata.html#value-def-integer" class="noxref"><span class="value-inst-integer">&lt;integer&gt;</span></a> | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>auto
<tr><th>Applies to:<td>positioned elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>as specified
</table>

<p>For a positioned box, the <a href="visuren.html#propdef-z-index" class="noxref"><span
class="propinst-z-index">'z-index'</span></a> property specifies:

<ol>
  <li>The stack level of the box in the current stacking context.

  <li>Whether the box establishes a stacking context.
</ol>

<p>Values have the following meanings:

<dl>
  <dt><span class="index-inst" title="&lt;integer&gt;"><a name="x43" href="syndata.html#value-def-integer" class="noxref"><span
  class="value-inst-integer"><strong>&lt;integer&gt;</strong></span></a></span>

  <dd>This integer is the stack level of the generated box in the
  current stacking context. The box also establishes a new stacking
  context.

  <dt><strong>auto</strong>

  <dd>The stack level of the generated box in the current stacking
  context is 0. If the box has 'position: fixed' or if it is the root,
  it also establishes a new stacking context.
</dl>

<p><em>In this section, the expression "in front of" 
means closer to the user as the user faces the screen.</em></p>

<p>In CSS&nbsp;2.2, each box has a position in three dimensions. In addition
to their horizontal and vertical positions, boxes lie along a "z-axis"
and are formatted one on top of the other.  Z-axis positions are
particularly relevant when boxes overlap visually. This section
discusses how boxes may be positioned along the z-axis.
</p>
<p>
The order in which the rendering tree is painted onto the canvas is 
described in terms of stacking contexts. Stacking contexts can 
contain further stacking contexts. A stacking context is atomic from 
the point of view of its parent stacking context; boxes in other 
stacking contexts may not come between any of its boxes.
</p>
<p>Each box belongs to one <a name="x44"><span class="index-def" title="stacking
context"><dfn>stacking context</dfn></span></a>. Each positioned box in a
given stacking context has an integer <span class="index-def"
title="stack level"><a name="stack-level"><dfn>stack
level</dfn></a></span>, which is its position on the z-axis relative
other stack levels within the same stacking context. Boxes with
greater stack levels are always formatted
in front of boxes with lower stack levels.  Boxes may have negative
stack levels.  Boxes with the same stack level in a stacking context
are stacked back-to-front according to document tree order.
</p>

<p>
The root element forms the root stacking context. Other stacking 
contexts are generated by any positioned element (including 
relatively positioned elements) having a computed value of 'z-index' 
other than 'auto'. Stacking contexts are not necessarily related to 
containing blocks. In future levels of CSS, other properties may 
introduce stacking contexts, for example '<a href="https://www.w3.org/TR/css3-color/#transparency">opacity</a>'
<a href="refs.html#ref-CSS3COLOR" rel="biblioentry" class="noxref"><span class="informref">[CSS3COLOR]</span></a>.
</p>

<p>Within each stacking context, the following layers are painted in
back-to-front order:

<ol>
  <li>the background and borders of the element forming the stacking
  context.

  <li>the child stacking contexts with negative stack levels (most
  negative first).

  <li>the in-flow, non-inline-level, non-positioned descendants.

  <li>the non-positioned floats.

  <li>the in-flow, inline-level, non-positioned descendants, including
  inline tables and inline blocks.

  <li>the child stacking contexts with stack level 0 and the
  positioned descendants with stack level 0.

  <li>the child stacking contexts with positive stack levels (least
  positive first).
</ol>

<p>Within each stacking context, positioned elements with stack level
0 (in layer&nbsp;6), non-positioned floats (layer&nbsp;4), inline
blocks (layer&nbsp;5), and inline tables (layer&nbsp;5), are painted
as if those elements themselves generated new stacking contexts,
except that their positioned descendants and any would-be child
stacking contexts take part in the current stacking context.

<p>This painting order is applied recursively to each stacking
context. This description of stacking context painting order
constitutes an overview of the detailed normative definition in
<a href="zindex.html">Appendix&nbsp;E.</a>

<div class="html example">
<p>In the following example, the stack levels of
the boxes (named with their "id" attributes) are:
"text2"=0, "image"=1, "text3"=2, and "text1"=3. The
"text2" stack level is inherited from the root box. The
others are specified with the <a href="visuren.html#propdef-z-index" class="noxref"><span
class="propinst-z-index">'z-index'</span></a> property.
</p>
<pre><code class="html">
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"&gt;
&lt;HTML&gt;
  &lt;HEAD&gt;
    &lt;TITLE&gt;Z-order positioning&lt;/TITLE&gt;
    &lt;STYLE type="text/css"&gt;
      .pile { 
        position: absolute; 
        left: 2in; 
        top: 2in; 
        width: 3in; 
        height: 3in; 
      }
    &lt;/STYLE&gt;
  &lt;/HEAD&gt;
  &lt;BODY&gt;
    &lt;P&gt;
      &lt;IMG id="image" class="pile" 
           src="butterfly.png" alt="A butterfly image"
           style="z-index: 1"&gt;

    &lt;DIV id="text1" class="pile" 
         style="z-index: 3"&gt;
      This text will overlay the butterfly image.
    &lt;/DIV&gt;

    &lt;DIV id="text2"&gt;
      This text will be beneath everything.
    &lt;/DIV&gt;

    &lt;DIV id="text3" class="pile" 
         style="z-index: 2"&gt;
      This text will underlay text1, but overlay the butterfly image
    &lt;/DIV&gt;
  &lt;/BODY&gt;
&lt;/HTML&gt;
</code></pre>
</div>


<p>This example demonstrates the notion of
<em>transparency</em>. The default behavior of the background is to allow boxes behind it to be visible. 
In the example, each box transparently overlays the boxes below it. This
behavior can be overridden by using one of the existing
<a href="colors.html#background-properties">
background properties</a>.
</p>

</details>
<h2>9.10 <a name="direction">Text direction:</a>
the <a href="visuren.html#propdef-direction" class="noxref"><span class="propinst-direction">'direction'</span></a>
and <a href="visuren.html#propdef-unicode-bidi" class="noxref"><span class="propinst-unicode-bidi">'unicode-bidi'</span></a>
properties
</h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p><a href="conform.html#conformance">Conforming</a> user agents that do
not support bidirectional text may ignore the <a href="visuren.html#propdef-direction" class="noxref"><span
class="propinst-direction">'direction'</span></a> and <a href="visuren.html#propdef-unicode-bidi" class="noxref"><span
class="propinst-unicode-bidi">'unicode-bidi'</span></a> properties
described in this section. This exception includes UAs that render
right-to-left characters simply because a font on the system contains them
but do not support the concept of right-to-left text direction.

<p>The characters in certain scripts are written from right to
left. In some documents, in particular those written with the Arabic
or Hebrew script, and in some mixed-language contexts, text in a
single (visually displayed) block may appear with mixed
directionality. This phenomenon is called <a name="x46"><span class="index-def"
title="bidirectionality (bidi)"><dfn>bidirectionality</dfn></span></a>, or
"bidi" for short.
</p>
<p>The Unicode standard (<a href="refs.html#ref-UNICODE" rel="biblioentry" class="noxref"><span class="normref">[UNICODE]</span></a>, <a href="refs.html#ref-UAX9" rel="biblioentry" class="noxref"><span class="normref">[UAX9]</span></a>) defines a complex
algorithm for determining the proper directionality of text. The
algorithm consists of an implicit part based on character properties,
as well as explicit controls for embeddings and overrides. CSS&nbsp;2.2 relies
on this algorithm to achieve proper bidirectional rendering. The <a href="visuren.html#propdef-direction" class="noxref"><span
class="propinst-direction">'direction'</span></a> and <a href="visuren.html#propdef-unicode-bidi" class="noxref"><span
class="propinst-unicode-bidi">'unicode-bidi'</span></a> properties allow
authors to specify how the elements and attributes of a document
language map to this algorithm.
</p>
<p>User agents that support bidirectional text must apply the Unicode
bidirectional algorithm to every sequence of inline-level boxes uninterrupted
by a forced (<a
href="http://www.unicode.org/reports/tr9/#Bidirectional_Character_Types">bidi
class&nbsp;B</a>) break or block boundary. This sequence forms the
"paragraph" unit in the bidirectional algorithm. The paragraph embedding
level is set according to the value of the <a href="visuren.html#propdef-direction" class="noxref"><span
class="propinst-direction">'direction'</span></a> property of the containing
block rather than by the heuristic given in steps P2 and P3 of the Unicode
algorithm.</p>
<p>Because the directionality of a text depends on the structure and
semantics of the document language, these properties should in most
cases be used only by designers of document type descriptions (DTDs),
or authors of special documents. If a default style sheet specifies
these properties, authors and users should not specify rules to
override them. 
</p>
<p>The HTML 4 specification ([HTML4], section 8.2) defines
bidirectionality behavior for HTML elements. The style sheet
rules that would achieve the bidi behavior specified in <a href="refs.html#ref-HTML4" rel="biblioentry" class="noxref"><span class="normref">[HTML4]</span></a> are
given in <a href="sample.html#bidi">the sample style sheet</a>. The
HTML 4 specification also contains more information on
bidirectionality issues.
</p>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x47"><span class="index-def" title="'direction'"><dfn id="propdef-direction">direction</dfn></span></a><tr><th>Value:<td>ltr | rtl | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>ltr
<tr><th>Applies to:<td>all elements, but see prose
<tr><th>Inherited:<td>yes
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>as specified
</table>

<p>This property specifies the base writing direction of blocks and
the direction of embeddings and overrides (see <a href="visuren.html#propdef-unicode-bidi" class="noxref"><span
class="propinst-unicode-bidi">'unicode-bidi'</span></a>) for the Unicode
bidirectional algorithm. In addition, it specifies such things as the
direction of <a
href="tables.html">table</a> column layout, the direction of
horizontal <a href="visufx.html#overflow">overflow</a>, the
position of an incomplete last line in a block in case of 'text-align:
justify'.
</p>

<p>Values for this property have the following meanings:</p>

<dl>
<dt><strong>ltr</strong></dt>
<dd>Left-to-right direction.</dd>
<dt><strong>rtl</strong></dt>
<dd> Right-to-left direction.</dd>
</dl>

<p>For the <a href="visuren.html#propdef-direction" class="noxref"><span class="propinst-direction">'direction'</span></a>
property to affect reordering in inline elements, the <a href="visuren.html#propdef-unicode-bidi" class="noxref"><span
class="propinst-unicode-bidi">'unicode-bidi'</span></a> property's value
must be 'embed' or 'override'.
</p>
<div class="note"><p>
<em><strong>Note.</strong> 
The <a href="visuren.html#propdef-direction" class="noxref"><span class="propinst-direction">'direction'</span></a> property, when
specified for table column elements, is not inherited by cells in the
column since columns are not the ancestors of the cells in the document tree. 
Thus, CSS cannot easily capture the "dir" attribute inheritance rules described
in <a href="refs.html#ref-HTML4" rel="biblioentry" class="noxref"><span class="normref">[HTML4]</span></a>, section 11.3.2.1.
</em></p></div>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x48"><span class="index-def" title="'unicode-bidi'"><dfn id="propdef-unicode-bidi">unicode-bidi</dfn></span></a><tr><th>Value:<td>normal | embed | bidi-override | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>normal
<tr><th>Applies to:<td>all elements, but see prose
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>N/A
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>as specified
</table>

<p>Values for this property have the following meanings:</p>

<dl>
<dt><strong>normal</strong></dt>
<dd>The element does not open an additional level of embedding with
respect to the bidirectional algorithm. For inline elements,
implicit reordering works across element boundaries.
</dd>
<dt><strong>embed</strong></dt>

<dd>If the element is inline, this value
opens an additional level of embedding with respect to the
bidirectional algorithm. The direction of this embedding level is
given by the <a href="visuren.html#propdef-direction" class="noxref"><span class="propinst-direction">'direction'</span></a>
property. Inside the element, reordering is done implicitly. This
corresponds to adding a LRE (U+202A; for 'direction: ltr') or RLE
(U+202B; for 'direction: rtl') at the start of the element and a PDF
(U+202C) at the end of the element.
</dd>
<dt><strong>bidi-override</strong></dt>

<dd>
For inline elements this creates an override.
For block container elements 
this creates an override for inline-level descendants not within 
another block container
element.
This means that inside the element, reordering is strictly in sequence
according to the <a href="visuren.html#propdef-direction" class="noxref"><span class="propinst-direction">'direction'</span></a>
property; the implicit part of the bidirectional algorithm is
ignored. This corresponds to adding a LRO (U+202D; for 'direction:
ltr') or RLO (U+202E; for 'direction: rtl') at the start of the
element or at the start of each anonymous child block box, if any, and
a PDF (U+202C) at the end of the element.
</dd>
</dl>

<p>The final order of characters in each block container is the
same as if the bidi control codes had been added as described above,
markup had been stripped, and the resulting character sequence had
been passed to an implementation of the Unicode bidirectional
algorithm for plain text that produced the same line-breaks as the
styled text.
In this process, replaced elements with 'display: inline'
are treated as
neutral characters, unless their <a href="visuren.html#propdef-unicode-bidi" class="noxref"><span
class="propinst-unicode-bidi">'unicode-bidi'</span></a> property has a
value other than 'normal', in which case they are treated as strong
characters in the <a href="visuren.html#propdef-direction" class="noxref"><span class="propinst-direction">'direction'</span></a>
specified for the element.
All other atomic inline-level boxes are treated as neutral characters
always.




</p>
<p>Please note that in order to be able to flow inline boxes in a
uniform direction (either entirely left-to-right or entirely
right-to-left), more inline boxes (including anonymous inline boxes)
may have to be created, and some inline boxes may have to be split up
and reordered before flowing.
</p>
<p>Because the Unicode algorithm has a limit of 
<em title="According to unicode 3.0, chapter 3, section 12, definition BD2. 
Specifically, page 58 here: http://www.unicode.org/unicode/uni2book/ch03.pdf" 
>61 levels</em> of
embedding, care should be taken not to use <a href="visuren.html#propdef-unicode-bidi" class="noxref"><span
class="propinst-unicode-bidi">'unicode-bidi'</span></a> with a value other
than 'normal' unless appropriate. In particular, a value of 'inherit'
should be used with extreme caution. However, for elements that are,
in general, intended to be displayed as blocks, a setting of
'unicode-bidi: embed' is preferred to keep the element together in
case display is changed to inline (see example below).
</p>
<p>The following example shows an XML document with bidirectional
text. It illustrates an important design principle: <a name="x49"><span
class="index-inst" title="DTD">DTD</span></a> designers should take bidi
into account both in the language proper (elements and attributes) and
in any accompanying style sheets. The style sheets should be designed
so that bidi rules are separate from other style rules. The bidi rules
should not be overridden by other style sheets so that the document
language's or DTD's bidi behavior is preserved.
</p>
<div class="example"><P style="display:none">Example(s):</P><p>
In this example, 
lowercase letters stand for inherently left-to-right characters and
uppercase letters represent inherently right-to-left characters:
</p>
<pre class="xml example"><code class="xml">
&lt;HEBREW&gt;
  &lt;PAR&gt;HEBREW1 HEBREW2 english3 HEBREW4 HEBREW5&lt;/PAR&gt;
  &lt;PAR&gt;HEBREW6 &lt;EMPH&gt;HEBREW7&lt;/EMPH&gt; HEBREW8&lt;/PAR&gt;
&lt;/HEBREW&gt;
&lt;ENGLISH&gt;
  &lt;PAR&gt;english9 english10 english11 HEBREW12 HEBREW13&lt;/PAR&gt;
  &lt;PAR&gt;english14 english15 english16&lt;/PAR&gt;
  &lt;PAR&gt;english17 &lt;HE-QUO&gt;HEBREW18 english19 HEBREW20&lt;/HE-QUO&gt;&lt;/PAR&gt;
&lt;/ENGLISH&gt;
</code></pre>

<p>Since this is XML, the style sheet is responsible for setting the
writing direction. This is the style sheet:</p>

<pre class="example">
/* Rules for bidi */
HEBREW, HE-QUO  {direction: rtl; unicode-bidi: embed}
ENGLISH         {direction: ltr; unicode-bidi: embed} 

/* Rules for presentation */
HEBREW, ENGLISH, PAR  {display: block}
EMPH                  {font-weight: bold}
</pre>

<p>The HEBREW element is a block with a right-to-left base direction,
the ENGLISH element is a block with a left-to-right base
direction. The PARs are blocks that inherit the base direction from
their parents. Thus, the first two PARs are read starting at the top
right, the final three are read starting at the top left.  Please note
that HEBREW and ENGLISH are chosen as element names for explicitness
only; in general, element names should convey structure without
reference to language.
</p>
<p>The EMPH element is inline-level, and since its value for <a href="visuren.html#propdef-unicode-bidi" class="noxref"><span
class="propinst-unicode-bidi">'unicode-bidi'</span></a> is 'normal' (the
initial value), it has no effect on the ordering of the text. The
HE-QUO element, on the other hand, creates an embedding.
</p>
<p>The formatting of this text might look like this if the line length
is long:
</p>
<pre class="ascii-art">
               5WERBEH 4WERBEH english3 2WERBEH 1WERBEH

                                8WERBEH <b>7WERBEH</b> 6WERBEH

english9 english10 english11 13WERBEH 12WERBEH

english14 english15 english16

english17 20WERBEH english19 18WERBEH
</pre>

<p>Note that the HE-QUO embedding causes HEBREW18 to be to the right
of english19.
</p>
<p>If lines have to be broken, it might be more like this:
</p>
<pre class="ascii-art">
       2WERBEH 1WERBEH
  -EH 4WERBEH english3
                 5WERB

   -EH <b>7WERBEH</b> 6WERBEH
                 8WERB

english9 english10 en-
glish11 12WERBEH
13WERBEH

english14 english15
english16

english17 18WERBEH
20WERBEH english19
</pre>

<p>Because HEBREW18 must be read before english19, it is on the line
above english19. Just breaking the long line from the earlier
formatting would not have worked. Note also that the first syllable
from english19 might have fit on the previous line, but hyphenation of
left-to-right words in a right-to-left context, and vice versa, is
usually suppressed to avoid having to display a hyphen in the middle
of a line.
</p>
</div>

<hr class="navbar">

<div class="navbar">
<p><a href="box.html">previous</a> &nbsp;
<a href="visudet.html">next</a> &nbsp;
<a href="Overview.html#minitoc">contents</a> &nbsp;
<a href="propidx.html">properties</a> &nbsp;
<a href="indexlist.html">index</a> &nbsp;
</div>
</body>

<body>
<div class="navbar">
<p><a href="visuren.html">previous</a> &nbsp;
<a href="visufx.html">next</a> &nbsp;
<a href="Overview.html#minitoc">contents</a> &nbsp;
<a href="propidx.html">properties</a> &nbsp;
<a href="indexlist.html">index</a> &nbsp;
</div>
<hr class="navbar">

<h1><a name="q0">10 Visual formatting model details</a></h1>
<div id="toc" class="subtoc">
<p><strong>Contents</strong>
  <ul class="toc">
    <li><a href="visudet.html#containing-block-details" class="tocxref">10.1 Definition of "containing block"</a>
    <li><a href="visudet.html#the-width-property" class="tocxref">10.2 Content width: the <span class="propinst-width">'width'</span> property</a>
    <li><a href="visudet.html#Computing_widths_and_margins" class="tocxref">10.3 Calculating widths and margins</a>
    <ul class="toc">
      <li><a href="visudet.html#inline-width" class="tocxref">10.3.1 Inline, non-replaced elements</a>
      <li><a href="visudet.html#inline-replaced-width" class="tocxref">10.3.2 Inline, replaced elements</a>
      <li><a href="visudet.html#blockwidth" class="tocxref">10.3.3 Block-level, non-replaced elements in normal flow</a>
      <li><a href="visudet.html#block-replaced-width" class="tocxref">10.3.4 Block-level, replaced elements in normal flow</a>
      <li><a href="visudet.html#float-width" class="tocxref">10.3.5 Floating, non-replaced elements</a>
      <li><a href="visudet.html#float-replaced-width" class="tocxref">10.3.6 Floating, replaced elements</a>
      <li><a href="visudet.html#abs-non-replaced-width" class="tocxref">10.3.7 Absolutely positioned, non-replaced elements</a>
      <li><a href="visudet.html#abs-replaced-width" class="tocxref">10.3.8 Absolutely positioned, replaced elements</a>
      <li><a href="visudet.html#inlineblock-width" class="tocxref">10.3.9 'Inline-block', non-replaced elements in normal flow</a>
      <li><a href="visudet.html#inlineblock-replaced-width" class="tocxref">10.3.10 'Inline-block', replaced elements in normal flow</a>
    </ul>
    <li><a href="visudet.html#min-max-widths" class="tocxref">10.4 Minimum and maximum widths: <span class="propinst-min-width">'min-width'</span> and <span class="propinst-max-width">'max-width'</span></a>
    <li><a href="visudet.html#the-height-property" class="tocxref">10.5 Content height: the <span class="propinst-height">'height'</span> property</a>
    <li><a href="visudet.html#Computing_heights_and_margins" class="tocxref">10.6 Calculating heights and margins</a>
    <ul class="toc">
      <li><a href="visudet.html#inline-non-replaced" class="tocxref">10.6.1 Inline, non-replaced elements</a>
      <li><a href="visudet.html#inline-replaced-height" class="tocxref">10.6.2 Inline replaced elements, block-level replaced elements in normal flow, 'inline-block' replaced elements in normal flow and floating replaced elements</a>
      <li><a href="visudet.html#normal-block" class="tocxref">10.6.3 Block-level non-replaced elements in normal flow when 'overflow' computes to 'visible'</a>
      <li><a href="visudet.html#abs-non-replaced-height" class="tocxref">10.6.4 Absolutely positioned, non-replaced elements</a>
      <li><a href="visudet.html#abs-replaced-height" class="tocxref">10.6.5 Absolutely positioned, replaced elements</a>
      <li><a href="visudet.html#block-root-margin" class="tocxref">10.6.6 Complicated cases</a>
      <li><a href="visudet.html#root-height" class="tocxref">10.6.7 'Auto' heights for block formatting context roots</a>
    </ul>
    <li><a href="visudet.html#min-max-heights" class="tocxref">10.7 Minimum and maximum heights: <span class="propinst-min-height">'min-height'</span> and <span class="propinst-max-height">'max-height'</span></a>
    <li><a href="visudet.html#line-height" class="tocxref">10.8 Line height calculations: the <span class="propinst-line-height">'line-height'</span> and <span class="propinst-vertical-align">'vertical-align'</span> properties</a>
    <ul class="toc">
      <li><a href="visudet.html#leading" class="tocxref">10.8.1 Leading and half-leading</a>
    </ul>
  </ul>
</div>

</details>
<h2>10.1 <a name="containing-block-details">Definition of "containing
block"</a></h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p>The position and size of an element's box(es) are sometimes
calculated relative to a certain rectangle, called the <dfn><a name="x0"><span
class="index-def" title="containing block">containing
block</span></a></dfn> of the element. The containing block of an element
is defined as follows:</p>

<ol>
<li>The containing block in which the <a href="conform.html#root">root
element</a> lives is a rectangle called the <dfn><a name="x1"><span
class="index-def" title="initial containing block|containing
block::initial">initial containing block</span></a></dfn>. For continuous
media, it has the dimensions of the <a
href="visuren.html#viewport">viewport</a> and is anchored at the
canvas origin; it is the <a href="page.html#page-area">page area</a>
for paged media. The 'direction' property of the initial
containing block is the same as for the root element.
</li>
<li>For other elements, if the element's position is 'relative' or 'static',
the containing block is formed by the content edge of the nearest
ancestor box that is a <a href="visuren.html#block-boxes">block
container</a> or which establishes a formatting context.
</li>
<li>If the element has 'position: fixed', the containing block is
established by the <a href="visuren.html#viewport">viewport</a>
in the case of continuous media or the page area in the case of paged media.
</li>
<li>If the element has 'position: absolute', the containing block is
established by the nearest ancestor with a <a href="visuren.html#propdef-position" class="noxref"><span
class="propinst-position">'position'</span></a> of 'absolute', 'relative'
or 'fixed', in the following way:
<ol>
<li>In the case that the ancestor is an inline element, the containing
block is the bounding box around the padding boxes of the first and
the last inline boxes
generated for that element. In CSS&nbsp;2.2, if the inline
element is split
across multiple lines, the containing block is undefined.
</li>
<li>Otherwise, the containing block
is formed by the <a href="box.html#padding-edge">padding edge</a> of

the ancestor.
</li>
</ol>

<p>If there is no such ancestor, the containing block is the initial
containing block.
</p>
</li>
</ol>

<p>In paged media, an absolutely positioned element is positioned
relative to its containing block ignoring any page breaks (as if the
document were continuous). The element may subsequently be broken over
several pages.
</p>

<p>For absolutely positioned content that resolves to a position on a
page other than the page being laid out (the current page), or
resolves to a position on the current page which has already been
rendered for printing, printers may place the content
<ul>
<li>on another location on the current page,
<li>on a subsequent page, or
<li>may omit it.
</ul>

<p class="note">Note that a
block-level element that is split over several pages may have a different
width on each page and that there may be device-specific limits.
</p>

<div class="example"><P style="display:none">Example(s):</P>
<p>With no positioning, the containing blocks (C.B.) in the
following document:</p>

<pre class="html example">
&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"&gt;
&lt;HTML&gt;
   &lt;HEAD&gt;
      &lt;TITLE&gt;Illustration of containing blocks&lt;/TITLE&gt;
   &lt;/HEAD&gt;
   &lt;BODY id="body"&gt;
      &lt;DIV id="div1"&gt;
      &lt;P id="p1"&gt;This is text in the first paragraph...&lt;/P&gt;
      &lt;P id="p2"&gt;This is text &lt;EM id="em1"&gt; in the 
      &lt;STRONG id="strong1"&gt;second&lt;/STRONG&gt; paragraph.&lt;/EM&gt;&lt;/P&gt;
      &lt;/DIV&gt;
   &lt;/BODY&gt;
&lt;/HTML&gt;
</pre>

<p>are established as follows:</p>

<table border="1">
<tr><th>For box generated by </th>
<td><strong>C.B. is established by</strong></td></tr>
<tr><td>html</td><td>initial C.B. (UA-dependent)</td></tr>
<tr><td>body</td><td>html</td></tr>
<tr><td>div1</td><td>body</td></tr>
<tr><td>p1</td><td>div1</td></tr>
<tr><td>p2</td><td>div1</td></tr>
<tr><td>em1</td><td>p2</td></tr>
<tr><td>strong1</td><td>p2</td></tr>
</table>

<p>If we position "div1":</p>

<pre class="example">
   #div1 { position: absolute; left: 50px; top: 50px }
</pre>

<p>its containing block is no longer "body"; it becomes
the initial containing block (since there are no
other positioned ancestor boxes).
</p>
<p>If we position "em1" as well:</p>

<pre class="example">
   #div1 { position: absolute; left: 50px; top: 50px }
   #em1  { position: absolute; left: 100px; top: 100px }
</pre>

<p>the table of containing blocks becomes:</p>

<table border="1">
<tr><th>For box generated by</th>
<td><strong>C.B. is established by</strong></td></tr>
<tr><td>html</td><td>initial C.B. (UA-dependent)</td></tr>
<tr><td>body</td><td>html</td></tr>
<tr><td>div1</td><td>initial C.B.</td></tr>
<tr><td>p1</td><td>div1</td></tr>
<tr><td>p2</td><td>div1</td></tr>
<tr><td>em1</td><td>div1</td></tr>
<tr><td>strong1</td><td>em1</td></tr>
</table>

<p>By positioning "em1", its containing block becomes
the nearest positioned ancestor box (i.e., that generated
by "div1"). 
</p>
</div>

</details>
<h2>10.2 <a name="the-width-property">Content width</a>: the <a href="visudet.html#propdef-width" class="noxref"><span
class="propinst-width">'width'</span></a> property</h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x3"><span class="index-def" title="'width'"><dfn id="propdef-width">width</dfn></span></a><tr><th>Value:<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | auto | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>auto
<tr><th>Applies to:<td>all elements but non-replaced inline elements, table rows, and row groups
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>refer to width of containing block
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>the percentage or 'auto' as specified or the absolute length
</table>

<p> This property specifies the <a
href="box.html#content-width">content width</a> of boxes.  
</p>
<p>This property does not apply to non-replaced <a
href="visuren.html#inline-boxes">inline</a> elements. The
content width
of a non-replaced inline element's boxes is that of the rendered
content within them (<em>before</em> any relative offset of
children). Recall that inline boxes flow into <a
href="visuren.html#line-box">line boxes</a>. The width of line boxes
is given by the their <a
href="visuren.html#containing-block">containing block</a>, but may be
shorted by the presence of <a href="visuren.html#floats">floats</a>.
</p>
<p>Values have the following meanings:</p>

<dl>
<dt><span class="index-inst" title="&lt;length&gt;"><a name="x4" href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></a></span>
</dt>
<dd>Specifies the width of the content area using a length unit.
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><a name="x5" href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></a></span>
</dt>
<dd>Specifies a percentage width. The percentage is calculated
with respect to the width of the generated box's 
<a href="visuren.html#containing-block">containing block</a>.
If the containing block's width depends on this element's width, then
the resulting layout is undefined in CSS 2.2.
<span class="note">
Note: For absolutely positioned elements whose containing block is
based on a block container element, the percentage is calculated with
respect to the width of the <em>padding box</em> of that element.
This is a change from CSS1, where the percentage width was always
calculated with respect to the <em>content box</em> of the parent
element.
</span>
</dd>
<dt><strong>auto</strong>
</dt>
<dd>The width depends on the values of other properties. 
See the sections below.
</dd>
</dl>

<p>Negative values for <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a> are
illegal. 
</p>
<div class="example"><P style="display:none">Example(s):</P><p>
For example, the following rule fixes the content width of paragraphs
at 100 pixels:</p>

<pre>
p { width: 100px }
</pre>
</div>

</details>
<h2>10.3 <a name="Computing_widths_and_margins">Calculating widths and
margins</a></h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p>The values of an element's <a href="visudet.html#propdef-width" class="noxref"><span
class="propinst-width">'width'</span></a>, <a href="box.html#propdef-margin-left" class="noxref"><span
class="propinst-margin-left">'margin-left'</span></a>, <a href="box.html#propdef-margin-right" class="noxref"><span
class="propinst-margin-right">'margin-right'</span></a>, <a href="visuren.html#propdef-left" class="noxref"><span
class="propinst-left">'left'</span></a> and <a href="visuren.html#propdef-right" class="noxref"><span
class="propinst-right">'right'</span></a> properties as used for layout
depend on the type of box generated and on each other. (The value used
for layout is sometimes referred to as the <a
href="cascade.html#usedValue">used value</a>.) In
principle, the values used are the same as the computed values, with
'auto' replaced by some suitable value, and percentages calculated
based on the containing block, but there are exceptions. The following
situations need to be distinguished:</p>

    <ol>
      <li>inline, non-replaced elements</li>
      <li>inline, replaced elements</li>
      <li>block-level, non-replaced elements in normal flow</li>
      <li>block-level, replaced elements in normal flow</li>
      <li>floating, non-replaced elements</li>
      <li>floating, replaced elements</li>
      <li>absolutely positioned, non-replaced elements</li>
      <li>absolutely positioned, replaced elements</li>
      <li>'inline-block', non-replaced elements in normal flow</li>
      <li>'inline-block', replaced elements in normal flow</li>
    </ol>

<p>For Points 1-6 and 9-10, the values of 'left' and 'right' in the
case of relatively positioned elements are determined by the rules in <a
href="visuren.html#relative-positioning">section 9.4.3.</a>
</p>

<p class=note><em><strong>Note.</strong> The used value of 'width'
calculated below is a tentative value, and may have to be calculated
multiple times, depending on <a href="visudet.html#propdef-min-width" class="noxref"><span
class="propinst-min-width">'min-width'</span></a> and <a href="visudet.html#propdef-max-width" class="noxref"><span
class="propinst-max-width">'max-width'</span></a>, see the section <a
href="#min-max-widths">Minimum and maximum widths</a> below.</em>

</details>
<h3>10.3.1 <a name="inline-width">Inline, non-replaced elements</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>The <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a> property does not
apply. A computed value of 'auto' for <a href="box.html#propdef-margin-left" class="noxref"><span
class="propinst-margin-left">'margin-left'</span></a> or <a href="box.html#propdef-margin-right" class="noxref"><span
class="propinst-margin-right">'margin-right'</span></a> becomes a used
value of '0'.
</p>

</details>
<h3>10.3.2 <a name="inline-replaced-width">Inline, replaced elements</a></h3>
<div data-valor-status="inline-replaced-width">
 <p><strong>Status:</strong> [TODO]</p>
 <p><strong>Notes:</strong> Replaced element sizing not implemented in this module. To be handled with a replaced elements subsystem.</p>
 <p><strong>Spec:</strong> https://www.w3.org/TR/CSS22/visudet.html#inline-replaced-width</p>
 <p><strong>Fixtures:</strong> <em>None</em></p>
</div>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>A computed value of 'auto' for <a href="box.html#propdef-margin-left" class="noxref"><span
class="propinst-margin-left">'margin-left'</span></a> or <a href="box.html#propdef-margin-right" class="noxref"><span
class="propinst-margin-right">'margin-right'</span></a> becomes a used
value of '0'.

<p>If <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a> and <a href="visudet.html#propdef-width" class="noxref"><span
class="propinst-width">'width'</span></a> both have computed values of
'auto' and the element also has an intrinsic width, then that
intrinsic width is the used value of <a href="visudet.html#propdef-width" class="noxref"><span
class="propinst-width">'width'</span></a>.

<p>If <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a> and <a href="visudet.html#propdef-width" class="noxref"><span
class="propinst-width">'width'</span></a> both have computed values of
'auto' and the element has no intrinsic width, but does have an
intrinsic height and intrinsic ratio; or if <a href="visudet.html#propdef-width" class="noxref"><span
class="propinst-width">'width'</span></a> has a computed value of 'auto',
<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a> has some other computed
value, and the element does have an intrinsic ratio; then the used
value of <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a> is:

<blockquote><p>(used height) * (intrinsic ratio)</blockquote>

<p>If 'height' and <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a> both
have computed values of 'auto' and the element has an intrinsic ratio
but no intrinsic height or width, then the used value of 'width' is
undefined in CSS&nbsp;2.2.
However, it is suggested that, if the containing block's width
does not itself depend on the replaced element's width, then the used
value of 'width' is calculated from the constraint equation used for
block-level, non-replaced elements in normal flow.

<p>Otherwise, if <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a> has a
computed value of 'auto', and the element has an intrinsic width, then
that intrinsic width is the used value of <a href="visudet.html#propdef-width" class="noxref"><span
class="propinst-width">'width'</span></a>.

<p>Otherwise, if <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a> has a
computed value of 'auto', but none of the conditions above are met,
then the used value of <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>
becomes 300px. If 300px is too wide to fit the device, UAs should use
the width of the largest rectangle that has a 2:1 ratio and fits the
device instead.

</details>
<h3>10.3.3 <a name="blockwidth">Block-level, non-replaced elements in normal
flow</a></h3>
<div data-valor-status="blockwidth">
 <p><strong>Status:</strong> [Production]</p>
 <p><strong>Code:</strong> <code>src/visual_formatting/horizontal.rs::solve_block_horizontal</code>, <code>src/lib.rs::prepare_child_position</code></p>
 <p><strong>Spec:</strong> https://www.w3.org/TR/CSS22/visudet.html#blockwidth</p>
 <p><strong>Fixtures:</strong> width/margins fixtures under <code>crates/css/modules/box/tests/fixtures/layout/box/</code></p>
</div>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>The following <a name="width-constraints">constraints</a> must hold
among the used values of the other properties:</p>
<blockquote>
<p><a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a> + <a href="box.html#propdef-border-left-width" class="noxref"><span
class="propinst-border-left-width">'border-left-width'</span></a> + <a href="box.html#propdef-padding-left" class="noxref"><span
class="propinst-padding-left">'padding-left'</span></a> + <a href="visudet.html#propdef-width" class="noxref"><span
class="propinst-width">'width'</span></a> + <a href="box.html#propdef-padding-right" class="noxref"><span
class="propinst-padding-right">'padding-right'</span></a> + <a href="box.html#propdef-border-right-width" class="noxref"><span
class="propinst-border-right-width">'border-right-width'</span></a> +
<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a> = width of <a
href="#containing-block-details">containing block</a>
</p>
</blockquote>
 <p>If 'width' is not 'auto' and 'border-left-width' + 'padding-left' +
'width' + 'padding-right' + 'border-right-width' (plus any of
'margin-left' or 'margin-right' that are not 'auto') is larger than
the width of the containing block, then any 'auto' values for
'margin-left' or 'margin-right' are, for the following rules, treated
as zero.
</p>
<p>If
all of the above have a computed value other than 'auto', the values
are said to be "over-constrained" and one of the used values will
have to be different from its computed value. If the <a href="visuren.html#propdef-direction" class="noxref"><span
class="propinst-direction">'direction'</span></a> 
property of the containing block has the value 'ltr', the specified
value of <a href="box.html#propdef-margin-right" class="noxref"><span
class="propinst-margin-right">'margin-right'</span></a> is ignored and the
value is calculated so as to make the equality true. If the value of
<a href="visuren.html#propdef-direction" class="noxref"><span class="propinst-direction">'direction'</span></a> is 'rtl', this
happens to <a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a> instead.
</p>
<p>If there is exactly one value specified as 'auto', its used
value follows from the equality.
</p>
<p>If <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a> is set to 'auto',
any other 'auto' values become '0' and <a href="visudet.html#propdef-width" class="noxref"><span
class="propinst-width">'width'</span></a> follows from the resulting
equality.
</p>
<p>If both <a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a> and
<a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a> are 'auto',
their used values are equal. This horizontally centers the element
with respect to the edges of the containing block.
</p>

</details>
<h3>10.3.4 <a name="block-replaced-width">Block-level, replaced elements in normal flow</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>The used value of 
<a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a> is determined
as for <a href="#inline-replaced-width">inline replaced 
elements</a>.
Then the rules <a href="#blockwidth">for non-replaced
block-level elements</a> are applied to determine the margins.
</p>

</details>
<h3>10.3.5 <a name="float-width">Floating, non-replaced elements</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>If <a href="box.html#propdef-margin-left" class="noxref"><span
class="propinst-margin-left">'margin-left'</span></a>, or <a href="box.html#propdef-margin-right" class="noxref"><span
class="propinst-margin-right">'margin-right'</span></a> are computed as
'auto', their used value is '0'.
</p>
<p>If <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a> is computed as
'auto', the used value is the "shrink-to-fit" width.
</p>
<p><a name="shrink-to-fit-float"></a> Calculation of the shrink-to-fit
width is similar to calculating the width of a table cell using the
automatic table layout algorithm. Roughly: calculate the preferred
width by formatting the content without breaking lines other than
where explicit line breaks occur, and also calculate the preferred
<em>minimum</em> width, e.g., by trying all possible line breaks.
CSS&nbsp;2.2 does not define the exact algorithm. Thirdly, find the
<em>available width</em>: in this case, this is the width of the
containing block minus the used values of 'margin-left',
'border-left-width', 'padding-left', 'padding-right',
'border-right-width', 'margin-right', and the widths of any relevant
scroll bars.
</p>
<p>Then the shrink-to-fit width is: min(max(preferred minimum width,
available width), preferred width).</p>

</details>
<h3>10.3.6 <a name="float-replaced-width">Floating, replaced elements</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>If <a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a> or <a href="box.html#propdef-margin-right" class="noxref"><span
class="propinst-margin-right">'margin-right'</span></a> are computed as
'auto', their used value is '0'. The used value of <a href="visudet.html#propdef-width" class="noxref"><span
class="propinst-width">'width'</span></a> is determined as for <a
href="#inline-replaced-width">inline replaced elements</a>.
</p>

</details>
<h3>10.3.7 <a name="abs-non-replaced-width">Absolutely positioned, non-replaced elements</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>For the purposes of this section and the next, the term <a
name=static-position><span class=index>"static position"</span></a>
(of an element) refers, roughly,
to the position an element would have had in the normal flow. More
precisely:
</p>
<ul>
<li>The <dfn>static-position containing block</dfn> is the containing
block of a hypothetical box that would have been the first box of the
element if its specified <a href="visuren.html#propdef-position" class="noxref"><span
class="propinst-position">'position'</span></a> value had been 'static'
and its specified 'float' had been 'none'. (Note that due to the rules
in <a href="visuren.html#dis-pos-flo">section&nbsp;9.7</a> this
hypothetical calculation might require also assuming a different
computed value for 'display'.)
</li>
<li>The static position for 'left' is the distance from the left edge
of the containing block to the left margin edge of a hypothetical box
that would have been the first box of the element if its <a href="visuren.html#propdef-position" class="noxref"><span
class="propinst-position">'position'</span></a> property had been 'static'
and <a href="visuren.html#propdef-float" class="noxref"><span class="propinst-float">'float'</span></a> had been 'none'. The
value is negative if the hypothetical
box is to the left of the containing block.
</li>
<li>The static position for 'right' is the distance from the right
edge of the containing block to the right margin edge of the same
hypothetical box as above. The value is positive if the hypothetical
box is to the left of the containing block's edge.
</li>
</ul>

<p>But rather than actually calculating the dimensions of that
hypothetical box, user agents are free to make a guess at its probable
position.
</p>
<p>For the purposes of calculating the static position, the containing
block of fixed positioned elements is the initial containing block
instead of the viewport, and all scrollable boxes should be assumed to
be scrolled to their origin.

<p>The constraint that determines the used values for these
elements is:</p>

  <blockquote> 
    <p>'left' + 'margin-left' + 'border-left-width' + 'padding-left' + 'width'
+ 'padding-right' + 'border-right-width' + 'margin-right' + 'right' = width
 of containing block </p>
  </blockquote>
  
<p>If all three of 'left', 'width', and 'right' are 'auto': First set
any 'auto' values for 'margin-left' and 'margin-right' to 0. Then, if
the 'direction' property of the element establishing the
static-position containing block is 'ltr' set 'left'
to the <a
href="#static-position">static position</a> and apply rule number
three below; otherwise, set 'right' to the <a
href="#static-position">static position</a> and apply rule number
one below.</p>

<p>If none of the three is 'auto': If both 'margin-left' and
'margin-right' are 'auto', solve the
equation under the extra constraint that the two margins get equal
values, unless this would make them negative, in which case when
direction of the containing block is 'ltr' ('rtl'), set 'margin-left'
('margin-right') to zero
and solve for 'margin-right' ('margin-left'). If one of
'margin-left' or 'margin-right' is 'auto', solve the equation for that
value. If the values are over-constrained, ignore the value for 'left'
(in case the 'direction' property of the containing block is 'rtl') or
'right' (in case 'direction' is
'ltr') and solve for that value.</p>

<p>Otherwise, set 'auto' values for 'margin-left' and 'margin-right'
to 0, and pick the one of the following six rules that applies.</p>

<ol>

<li>'left' and 'width' are 'auto' and 'right' is not 'auto', then the
width is shrink-to-fit. Then solve for 'left'</li>

<li>'left' and 'right' are 'auto' and 'width' is not 'auto', then if
the 'direction' property of the element establishing the
static-position containing block is 'ltr' set 'left'
to the <a
href="#static-position">static position</a>, otherwise set 'right'
to the <a href="#static-position">static position</a>. Then solve
for 'left' (if 'direction is 'rtl') or 'right' (if 'direction' is
'ltr').</li>

<li>'width' and 'right' are 'auto' and 'left' is not 'auto', then the
width is shrink-to-fit . Then solve for 'right'</li>

<li>'left' is 'auto', 'width' and 'right' are not 'auto', then solve for
'left'</li>

<li>'width' is 'auto', 'left' and 'right' are not 'auto', then solve
for 'width'</li>

<li>'right' is 'auto', 'left' and 'width' are not 'auto', then solve
for 'right'</li>
</ol>
  
<p>Calculation of the shrink-to-fit width is similar to calculating
the width of a table cell using the automatic table layout algorithm.
Roughly: calculate the preferred width by formatting the content
without breaking lines other than where explicit line breaks occur,
and also calculate the preferred <em>minimum</em> width, e.g., by
trying all possible line breaks. CSS&nbsp;2.2 does not define the
exact algorithm. Thirdly, calculate the <em>available width</em>: this
is found by solving for 'width' after setting 'left' (in case 1) or
'right' (in case 3) to 0.</p>

<p>Then the shrink-to-fit width is: min(max(preferred minimum width, available
width), preferred width).</p>

</details>
<h3>10.3.8 <a name="abs-replaced-width">Absolutely positioned, replaced elements</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>In this case, <a href="#abs-non-replaced-width">section 10.3.7</a>
applies up through and including the constraint equation, but the rest
of <a href="#abs-non-replaced-width">section 10.3.7</a> is replaced by
the following rules:

<ol>
<li>The used value of <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a> is
determined as for <a href="#inline-replaced-width">inline replaced
elements</a>.
If <a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a> or <a href="box.html#propdef-margin-right" class="noxref"><span
class="propinst-margin-right">'margin-right'</span></a> is specified as
'auto' its used value is determined by the rules below.
</li>
<li>If both <a href="visuren.html#propdef-left" class="noxref"><span class="propinst-left">'left'</span></a> and <a href="visuren.html#propdef-right" class="noxref"><span
class="propinst-right">'right'</span></a> have the value 'auto', then if
the 'direction' property of the element establishing the
static-position containing block is 'ltr', set <a href="visuren.html#propdef-left" class="noxref"><span
class="propinst-left">'left'</span></a> to
the static position; else if 'direction' is 'rtl', set <a href="visuren.html#propdef-right" class="noxref"><span
class="propinst-right">'right'</span></a> to the static position.
</li>
<li>If <a href="visuren.html#propdef-left" class="noxref"><span class="propinst-left">'left'</span></a> or <a href="visuren.html#propdef-right" class="noxref"><span
class="propinst-right">'right'</span></a> are 'auto', replace any 'auto'
on <a href="box.html#propdef-margin-left" class="noxref"><span class="propinst-margin-left">'margin-left'</span></a> or <a href="box.html#propdef-margin-right" class="noxref"><span
class="propinst-margin-right">'margin-right'</span></a> with '0'.
</li>
<li>If at this point both <a href="box.html#propdef-margin-left" class="noxref"><span
class="propinst-margin-left">'margin-left'</span></a> and <a href="box.html#propdef-margin-right" class="noxref"><span
class="propinst-margin-right">'margin-right'</span></a> are still 'auto',
solve the equation under the extra constraint that the two margins
must get equal values, unless this would make them negative, in which
case when the direction of the containing block is 'ltr' ('rtl'), set
<a href="box.html#propdef-margin-left" class="noxref"><span
class="propinst-margin-left">'margin-left'</span></a> (<a href="box.html#propdef-margin-right" class="noxref"><span
class="propinst-margin-right">'margin-right'</span></a>) to zero and solve
for <a href="box.html#propdef-margin-right" class="noxref"><span class="propinst-margin-right">'margin-right'</span></a> (<a href="box.html#propdef-margin-left" class="noxref"><span
class="propinst-margin-left">'margin-left'</span></a>).
</li>
<li>If at this point there is an 'auto' left, solve the equation 
for that value.
</li>
<li>If at this point the values are over-constrained, ignore the value
for either <a href="visuren.html#propdef-left" class="noxref"><span class="propinst-left">'left'</span></a> (in case the
<a href="visuren.html#propdef-direction" class="noxref"><span class="propinst-direction">'direction'</span></a> property of the
containing block is 'rtl') or <a href="visuren.html#propdef-right" class="noxref"><span
class="propinst-right">'right'</span></a> (in case <a href="visuren.html#propdef-direction" class="noxref"><span
class="propinst-direction">'direction'</span></a> is 'ltr') and solve for
that value.
</li>
</ol>

</details>
<h3>10.3.9 <a name="inlineblock-width">'Inline-block', non-replaced elements in normal flow</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>If <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a> is 'auto', the
used value is the <a href="#shrink-to-fit-float">shrink-to-fit</a>
width as for floating elements.
</p>
<p>A computed value of 'auto' for <a href="box.html#propdef-margin-left" class="noxref"><span
class="propinst-margin-left">'margin-left'</span></a> or <a href="box.html#propdef-margin-right" class="noxref"><span
class="propinst-margin-right">'margin-right'</span></a> becomes a used
value of '0'.
</p>

</details>
<h3>10.3.10 <a name="inlineblock-replaced-width">'Inline-block', replaced elements in normal flow</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>Exactly as <a href="#inline-replaced-width">inline replaced
elements.</a>
</p>

</details>
<h2>10.4 <a name="min-max-widths">Minimum and maximum widths</a>: <a href="visudet.html#propdef-min-width" class="noxref"><span
class="propinst-min-width">'min-width'</span></a> and <a href="visudet.html#propdef-max-width" class="noxref"><span
class="propinst-max-width">'max-width'</span></a></h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x6"><span class="index-def" title="'min-width'"><dfn id="propdef-min-width">min-width</dfn></span></a><tr><th>Value:<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>0
<tr><th>Applies to:<td>all elements but non-replaced inline elements, table rows, and row groups
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>refer to width of containing block
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>the percentage as specified or the absolute length
</table>
<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x7"><span class="index-def" title="'max-width'"><dfn id="propdef-max-width">max-width</dfn></span></a><tr><th>Value:<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | none | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>none
<tr><th>Applies to:<td>all elements but non-replaced inline elements, table rows, and row groups
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>refer to width of containing block
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>the percentage as specified or the absolute length or 'none'
</table>

<p>These two properties allow authors to constrain content widths to a
certain range. Values have the following meanings:</p>

<dl>
<dt><span class="index-inst" title="&lt;length&gt;"><a name="x8" href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></a></span>
</dt>
<dd>Specifies a fixed minimum or maximum used width.
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><a name="x9" href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></a></span>
</dt>
<dd>Specifies a percentage for determining the used value. The
percentage is calculated with respect to the width of the generated
box's <a href="visuren.html#containing-block">containing block</a>.
If the containing block's width is negative, the used value is
zero.
If the containing block's width depends on this element's width,
then the resulting layout is undefined in CSS 2.2.
</dd>
<dt><strong>none</strong>
</dt>
<dd>(Only on <a href="visudet.html#propdef-max-width" class="noxref"><span class="propinst-max-width">'max-width'</span></a>) No
limit on the width of the box.
</dd>
</dl>

<p>Negative values for <a href="visudet.html#propdef-min-width" class="noxref"><span
class="propinst-min-width">'min-width'</span></a> and <a href="visudet.html#propdef-max-width" class="noxref"><span
class="propinst-max-width">'max-width'</span></a> are illegal.
</p>

<p>In CSS&nbsp;2.2, the effect of 'min-width' and 'max-width' on
tables, inline tables,
table cells, table columns, and column groups is undefined.

<p>The following algorithm describes how the two properties influence
the <a href="cascade.html#computed-value">used value</a>
of the <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a> property:</p>
<ol>

<li>The tentative used width is calculated (without <a href="visudet.html#propdef-min-width" class="noxref"><span
class="propinst-min-width">'min-width'</span></a> and <a href="visudet.html#propdef-max-width" class="noxref"><span
class="propinst-max-width">'max-width'</span></a>) following the rules
under <a href="#Computing_widths_and_margins">"Calculating widths and
margins"</a> above.
</li>
<li>If the tentative used width is greater than <a href="visudet.html#propdef-max-width" class="noxref"><span
class="propinst-max-width">'max-width'</span></a>, the rules <a
href="#Computing_widths_and_margins">above</a> are applied again, but
this time using the computed value of <a href="visudet.html#propdef-max-width" class="noxref"><span
class="propinst-max-width">'max-width'</span></a> as the computed value
for <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>.
</li>
<li>If the resulting width is smaller than <a href="visudet.html#propdef-min-width" class="noxref"><span
class="propinst-min-width">'min-width'</span></a>, the rules <a
href="#Computing_widths_and_margins">above</a> are applied again, but
this time using the value of <a href="visudet.html#propdef-min-width" class="noxref"><span
class="propinst-min-width">'min-width'</span></a> as the computed value
for <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>.
</li>
</ol>

<p class="note">These steps do not affect the real computed values of
the above properties.</p>

<p>However, for replaced elements with an intrinsic ratio and both
<a href="visudet.html#propdef-width" class="noxref"><span
class="propinst-width">'width'</span></a> and <a href="visudet.html#propdef-height" class="noxref"><span
class="propinst-height">'height'</span></a> specified as 'auto', the
algorithm is as follows:
</p>

<p>Select from the table the resolved height and width values for the
appropriate constraint violation. Take the <var>max-width</var> and
<var>max-height</var> as max(min, max) so that <var>min</var> &#8804;
<var>max</var> holds true.
In this table <var>w</var> and <var>h</var> stand for the results of
the width and height computations ignoring the <a href="visudet.html#propdef-min-width" class="noxref"><span
class="propinst-min-width">'min-width'</span></a>, <a href="visudet.html#propdef-min-height" class="noxref"><span
class="propinst-min-height">'min-height'</span></a>, <a href="visudet.html#propdef-max-width" class="noxref"><span
class="propinst-max-width">'max-width'</span></a> and <a href="visudet.html#propdef-max-height" class="noxref"><span
class="propinst-max-height">'max-height'</span></a> properties. Normally
these are the intrinsic width and height, but they may not be in the
case of replaced elements with intrinsic ratios.

<p class=note>Note: In cases where an explicit width or height is
set and the other dimension is auto, applying a minimum or maximum
constraint on the auto side can cause an over-constrained situation. 
The spec is clear in the behavior but it might not be what the author
expects. The CSS3 object-fit property can be used to obtain different
results in this situation.

<table rules=all>
<thead>
  <tr><th>Constraint Violation</th><th>Resolved Width</th><th>Resolved Height</th></tr>
</thead>
<tbody>

  <tr><td>none</td>
      <td><var>w</var></td>
      <td><var>h</var></td></tr>
  <tr><td><var>w&nbsp;>&nbsp;max-width</var></td>
      <td><var>max-width</var></td>

      <td><var>max(max-width&nbsp;*&nbsp;h/w, min-height)</var></td></tr>
  <tr><td><var>w&nbsp;&lt;&nbsp;min-width</var></td>
      <td><var>min-width</var></td>
      <td><var>min(min-width&nbsp;*&nbsp;h/w, max-height)</var></td></tr>

  <tr><td><var>h&nbsp;>&nbsp;max-height</var></td>
      <td><var>max(max-height&nbsp;*&nbsp;w/h, min-width)</var></td>
      <td><var>max-height</var></td></tr>
  <tr><td><var>h&nbsp;&lt;&nbsp;min-height</var></td>

      <td><var>min(min-height&nbsp;*&nbsp;w/h, max-width)</var></td>
      <td><var>min-height</var></td></tr>
  <tr><td>(<var>w&nbsp;>&nbsp;max-width</var>) and (<var>h&nbsp;>&nbsp;max-height</var>), where (<var>max-width/w&nbsp;&#8804;&nbsp;max-height/h</var>)</td>

      <td><var>max-width</var></td>
      <td><var>max(min-height, max-width&nbsp;*&nbsp;h/w)</var></td></tr>
  <tr><td>(<var>w&nbsp;>&nbsp;max-width</var>) and (<var>h&nbsp;>&nbsp;max-height</var>), where (<var>max-width/w&nbsp;>&nbsp;max-height/h</var>)</td>

      <td><var>max(min-width, max-height&nbsp;*&nbsp;w/h)</var></td>
      <td><var>max-height</var></td></tr>
  <tr><td>(<var>w&nbsp;&lt;&nbsp;min-width</var>) and (<var>h&nbsp;&lt;&nbsp;min-height</var>), where (<var>min-width/w&nbsp;&#8804;&nbsp;min-height/h</var>)</td>

      <td><var>min(max-width, min-height&nbsp;*&nbsp;w/h)</var></td>
      <td><var>min-height</var></td></tr>
  <tr><td>(<var>w&nbsp;&lt;&nbsp;min-width</var>) and (<var>h&nbsp;&lt;&nbsp;min-height</var>), where (<var>min-width/w&nbsp;>&nbsp;min-height/h</var>)</td>

      <td><var>min-width</var></td>
      <td><var>min(max-height, min-width&nbsp;*&nbsp;h/w)</var></td></tr>
  <tr><td>(<var>w&nbsp;&lt;&nbsp;min-width</var>) and (<var>h&nbsp;>&nbsp;max-height</var>)</td>

      <td><var>min-width</var></td>
      <td><var>max-height</var></td></tr>
  <tr><td>(<var>w&nbsp;>&nbsp;max-width</var>) and (<var>h&nbsp;&lt;&nbsp;min-height</var>)</td>

      <td><var>max-width</var></td>
      <td><var>min-height</var></td></tr>
</tbody>
</table>

<p>Then apply the rules under <a
href="#Computing_widths_and_margins">"Calculating widths and
margins"</a> above, as if <a href="visudet.html#propdef-width" class="noxref"><span class="propinst-width">'width'</span></a>
were computed as this value.

</details>
<h2>10.5 <a name="the-height-property">Content height</a>: the <a href="visudet.html#propdef-height" class="noxref"><span
class="propinst-height">'height'</span></a> property</h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x10"><span class="index-def" title="'height'"><dfn id="propdef-height">height</dfn></span></a><tr><th>Value:<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | auto | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>auto
<tr><th>Applies to:<td>all elements but non-replaced inline elements, table columns, and column groups
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>see prose
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>the percentage or 'auto' (as specified) or the absolute length
</table>

<p> This property specifies the <a
href="box.html#content-height">content height</a> of boxes.

<p>This property does not apply to non-replaced <a
href="visuren.html#inline-boxes">inline</a> elements. See the <a
href="#inline-non-replaced">section on computing heights and margins
for non-replaced inline elements</a> for the rules used instead.
</p>
<p>Values have the following meanings:</p>

<dl>
<dt><span class="index-inst" title="&lt;length&gt;"><a name="x11" href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></a></span>
</dt>
<dd>Specifies the height of the content area using a length value.
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><a name="x12" href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></a></span>
</dt>
<dd>Specifies a percentage height. The percentage is calculated with
respect to the height of the generated box's <a
href="visuren.html#containing-block">containing block</a>. If the
height of the containing block is not specified explicitly (i.e., it
depends on content height), and this element is not absolutely
positioned, the used height is calculated as if 'auto' was specified.
A percentage height
on the <a href="conform.html#root">root element</a> is relative to the
<a href="#containing-block-details">initial containing block</a>.
<span class="note">
Note: For absolutely positioned elements whose containing block is
based on a block-level element, the percentage is calculated with
respect to the height of the <em>padding box</em> of that element.
This is a change from CSS1, where the percentage was always
calculated with respect to the <em>content box</em> of the parent
element.
</span>
</dd>
<dt><strong>auto</strong>
</dt>
<dd>The height depends on the values of other properties. 
See the prose below.
</dd>
</dl>

<p class="note">Note that the height of the containing block of an
absolutely positioned element is independent of the size of the
element itself, and thus a percentage height on such an element can
always be resolved. However, it may be that the height is not known
until elements that come later in the document have been processed.
</p>

<p>Negative values for <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>
are illegal.
</p>
<div class="example"><P style="display:none">Example(s):</P><p>
For example, the following rule sets the content height of paragraphs
to 100 pixels:</p>

<pre>
p { height: 100px }
</pre>

<p>Paragraphs of which the height of the contents exceeds 100 pixels
will <a href="visufx.html#overflow">overflow</a> according to the
<a href="visufx.html#propdef-overflow" class="noxref"><span class="propinst-overflow">'overflow'</span></a> property.
</p>
</div>

</details>
<h2>10.6 <a name="Computing_heights_and_margins">Calculating heights and
margins</a></h2>
<div data-valor-status="computing-heights">
 <p><strong>Status:</strong> [MVP]</p>
 <p><strong>Code:</strong> <code>src/visual_formatting/height.rs::compute_used_height</code> → <code>src/dimensions/mod.rs::compute_used_height_impl</code>, <code>src/dimensions/mod.rs::compute_child_content_height_impl</code>, <code>src/dimensions/mod.rs::compute_root_heights_impl</code></p>
 <p><strong>Spec:</strong> https://www.w3.org/TR/CSS22/visudet.html#Computing_heights_and_margins</p>
 <p><strong>Fixtures:</strong> covered by existing block fixtures’ height portions</p>
</div>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p>For calculating the values of <a href="visuren.html#propdef-top" class="noxref"><span class="propinst-top">'top'</span></a>, <a href="box.html#propdef-margin-top" class="noxref"><span class="propinst-margin-top">'margin-top'</span></a>, <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>,
<a href="box.html#propdef-margin-bottom" class="noxref"><span class="propinst-margin-bottom">'margin-bottom'</span></a>, and <a href="visuren.html#propdef-bottom" class="noxref"><span class="propinst-bottom">'bottom'</span></a> a distinction must be made between
various kinds of boxes:
</p>
    <ol>
      <li>inline, non-replaced elements</li>
      <li>inline, replaced elements</li>
      <li>block-level, non-replaced elements in normal flow</li>
      <li>block-level, replaced elements in normal flow</li>
      <li>floating, non-replaced elements</li>
      <li>floating, replaced elements</li>
      <li>absolutely positioned, non-replaced elements</li>
      <li>absolutely positioned, replaced elements</li>
      <li>'inline-block', non-replaced elements in normal flow</li>
      <li>'inline-block', replaced elements in normal flow</li>
    </ol>

<p>For Points 1-6 and 9-10, the used values of 'top' and
'bottom' are determined by the rules in section 9.4.3.
</p>

<p class=note>Note: these rules apply to
the root element just as to any other element.

<p class=note><em><strong>Note.</strong> The used value of 'height'
calculated below is a tentative value, and may have to be calculated
multiple times, depending on <a href="visudet.html#propdef-min-height" class="noxref"><span
class="propinst-min-height">'min-height'</span></a> and <a href="visudet.html#propdef-max-height" class="noxref"><span
class="propinst-max-height">'max-height'</span></a>, see the section <a
href="#min-max-heights">Minimum and maximum heights</a> below.</em>

</details>
<h3>10.6.1 <a name="inline-non-replaced">Inline, non-replaced elements</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>The <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a> property does not
apply. The height of the content area should be based on the font, but
this specification does not specify how. A UA may, e.g., use the
em-box or the maximum ascender and descender of the font. (The latter
would ensure that glyphs with parts above or below the em-box still
fall within the content area, but leads to differently sized boxes for
different fonts; the former would ensure authors can control
background styling relative to the 'line-height', but leads to glyphs
painting outside their content area.)
</p>
<p class=note>Note: level 3 of CSS will probably include a property to
select which measure of the font is used for the content height.
</p>
<p>The vertical padding, border and margin of an inline, non-replaced
box start at the top and bottom of the content area, and has nothing
to do with the <a href="visudet.html#propdef-line-height" class="noxref"><span
class="propinst-line-height">'line-height'</span></a>. But only the <a href="visudet.html#propdef-line-height" class="noxref"><span
class="propinst-line-height">'line-height'</span></a> is used when calculating
the height of the line box.
</p>
<p><a name="multi-font-inline-height"></a> If more than one font is
used (this could happen when glyphs are found in different fonts), the
height of the content area is not defined by this specification.
However, we suggest that the height is chosen such that the content
area is just high enough for either (1) the em-boxes, or (2) the
maximum ascenders and descenders, of <em>all</em> the fonts in the
element. Note that this may be larger than any of the font sizes
involved, depending on the baseline alignment of the fonts.
</p>

</details>
<h3>10.6.2 <a name="inline-replaced-height">Inline replaced elements</a>,
block-level replaced elements in normal flow, 'inline-block' replaced
elements in normal flow and floating replaced elements</h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>If <a href="box.html#propdef-margin-top" class="noxref"><span class="propinst-margin-top">'margin-top'</span></a>, or <a href="box.html#propdef-margin-bottom" class="noxref"><span
class="propinst-margin-bottom">'margin-bottom'</span></a> are 'auto',
their used value is 0.

<p>If <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a> and <a href="visudet.html#propdef-width" class="noxref"><span
class="propinst-width">'width'</span></a> both have computed values of
'auto' and the element also has an intrinsic height, then that
intrinsic height is the used value of <a href="visudet.html#propdef-height" class="noxref"><span
class="propinst-height">'height'</span></a>.

<p>Otherwise, if <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a> has a
computed value of 'auto', and the element has an intrinsic ratio then
the used value of <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a> is:

<blockquote><p>(used width) / (intrinsic ratio)</blockquote>

<p>Otherwise, if <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a> has a
computed value of 'auto', and the element has an intrinsic height,
then that intrinsic height is the used value of <a href="visudet.html#propdef-height" class="noxref"><span
class="propinst-height">'height'</span></a>.

<p>Otherwise, if <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a> has a
computed value of 'auto', but none of the conditions above are met,
then the used value of <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>
must be set to the height of the largest rectangle that has a 2:1
ratio, has a height not greater than 150px, and has a width not
greater than the device width.

</details>
<h3>10.6.3 <a name="normal-block">Block-level non-replaced elements in normal
flow when 'overflow' computes to 'visible'</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>This section also applies to block-level non-replaced elements in
normal flow when 'overflow' does not compute to 'visible' but has been
propagated to the viewport.

<p>If <a href="box.html#propdef-margin-top" class="noxref"><span
class="propinst-margin-top">'margin-top'</span></a>, or <a href="box.html#propdef-margin-bottom" class="noxref"><span
class="propinst-margin-bottom">'margin-bottom'</span></a> are 'auto',
their used value is 0. If <a href="visudet.html#propdef-height" class="noxref"><span
class="propinst-height">'height'</span></a> is 'auto', the height depends
on whether the element has any block-level children and whether it has
padding or borders:
</p>

<p>The element's height is the distance from its top content edge to
the first applicable of the following:

<ol>
  <li>the bottom edge of the last line box, if the box establishes a
  inline formatting context with one or more lines

  <li>the bottom edge of the bottom (possibly collapsed) margin of its
  last in-flow child, if the child's bottom margin does not collapse
  with the element's bottom margin

  <li>the bottom border edge of the last in-flow child whose top
  margin doesn't collapse with the element's bottom margin

  <li>zero, otherwise
</ol>

<p>Only children in the normal flow are taken into account (i.e.,
floating boxes and absolutely positioned boxes are ignored, and
relatively positioned boxes are considered without their offset). Note
that the child box may be an <a
href="visuren.html#anonymous-block-level">anonymous block box.</a>
</p>

</details>
<h3>10.6.4 <a name="abs-non-replaced-height">Absolutely positioned, non-replaced elements</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>For the purposes of this section and the next, the term "static
position" (of an element) refers, roughly, to the position an element
would have had in the normal flow. More precisely, the static position
for 'top' is the distance from the top edge of the containing block to
the top margin edge of a hypothetical box that would have been the
first box of the element if its specified <a href="visuren.html#propdef-position" class="noxref"><span
class="propinst-position">'position'</span></a> value had been 'static'
and its specified <a href="visuren.html#propdef-float" class="noxref"><span class="propinst-float">'float'</span></a> had been
'none' and its specified <a href="visuren.html#propdef-clear" class="noxref"><span class="propinst-clear">'clear'</span></a>
had been 'none'. (Note that due to the rules
in <a href="visuren.html#dis-pos-flo">section&nbsp;9.7</a> this might
require also assuming a different computed value for 'display'.)
The value is negative if the hypothetical box is above the containing
block.
</p>
<p>But rather than actually calculating the dimensions of that
hypothetical box, user agents are free to make a guess at its probable
position.
</p>
<p>For the purposes of calculating the static position, the containing
block of fixed positioned elements is the initial containing block
instead of the viewport.

<p>For absolutely positioned elements, the used values of the vertical
dimensions must satisfy this constraint:</p>
 
  <blockquote>      
    <p>'top' + 'margin-top' + 'border-top-width' + 'padding-top' +      'height'
+ 'padding-bottom' + 'border-bottom-width' +      'margin-bottom' + 'bottom'
= height of containing block </p>
  </blockquote>
 
<p>If all three of 'top', 'height', and 'bottom' are auto, set 'top'
to the static position and apply rule number three below.</p>
  
<p>If none of the three are 'auto': If both 'margin-top' and
'margin-bottom' are 'auto', solve the equation under the extra
constraint that the two margins get equal values. If one of
'margin-top' or 'margin-bottom' is 'auto', solve the equation for that
value. If the values are over-constrained, ignore the value for
'bottom' and solve for that value.</p>
  
<p>Otherwise, pick the one of the following six rules that
applies.</p>

<ol>
<li>'top' and 'height' are 'auto' and 'bottom' is not 'auto', then the
height is <a href="#root-height">based on the content per 10.6.7</a>, set 'auto'
values for 'margin-top' and 'margin-bottom' to 0, and solve for 'top'

<li>'top' and 'bottom' are 'auto' and 'height' is not 'auto', then
set 'top' to the static position, set 'auto' values for 'margin-top'
and 'margin-bottom' to 0, and solve for 'bottom'</li>

<li>'height' and 'bottom' are 'auto' and 'top' is not 'auto', then the
height is <a href="#root-height">based on the content per 10.6.7</a>, set 'auto'
values for 'margin-top' and 'margin-bottom' to 0, and solve for
'bottom'</li>

<li>'top' is 'auto', 'height' and 'bottom' are not 'auto', then set
'auto' values for 'margin-top' and 'margin-bottom' to 0, and solve for
'top'</li>

<li>'height' is 'auto', 'top' and 'bottom' are not 'auto', then 'auto'
values for 'margin-top' and 'margin-bottom' are set to 0 and solve for
'height'</li>

<li>'bottom' is 'auto', 'top' and 'height' are not 'auto', then set
'auto' values for 'margin-top' and 'margin-bottom' to 0 and solve for
'bottom'</li>
</ol>

</details>
<h3>10.6.5 <a name="abs-replaced-height">Absolutely positioned, replaced elements</a></h3>
<div data-valor-status="abs-replaced-height">
 <p><strong>Status:</strong> [TODO]</p>
 <p><strong>Notes:</strong> Not implemented. Requires replaced sizing and absolute positioning support.</p>
 <p><strong>Spec:</strong> https://www.w3.org/TR/CSS22/visudet.html#abs-replaced-height</p>
 <p><strong>Fixtures:</strong> <em>None</em></p>
</div>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>This situation is similar to the previous one, except that the
element has an <a href="conform.html#intrinsic">intrinsic</a> height. The
sequence of substitutions is now:
</p>
<ol>

<li>The used value of <a href="visudet.html#propdef-height" class="noxref"><span
class="propinst-height">'height'</span></a> is determined as for <a
href="#inline-replaced-height">inline replaced elements</a>.
If 'margin-top' or 'margin-bottom' is specified as 'auto' its used
value is determined by the rules below.</li>
<li>If both <a href="visuren.html#propdef-top" class="noxref"><span class="propinst-top">'top'</span></a> and <a href="visuren.html#propdef-bottom" class="noxref"><span
class="propinst-bottom">'bottom'</span></a> have the value 'auto', replace
<a href="visuren.html#propdef-top" class="noxref"><span class="propinst-top">'top'</span></a> with the element's <a
href="#static-position">static position</a>.
</li>
<li>If <a href="visuren.html#propdef-bottom" class="noxref"><span class="propinst-bottom">'bottom'</span></a> is 'auto',
replace any 'auto' on <a href="box.html#propdef-margin-top" class="noxref"><span
class="propinst-margin-top">'margin-top'</span></a> or <a href="box.html#propdef-margin-bottom" class="noxref"><span
class="propinst-margin-bottom">'margin-bottom'</span></a> with '0'.
</li>
<li>If at this point both <a href="box.html#propdef-margin-top" class="noxref"><span
class="propinst-margin-top">'margin-top'</span></a> and <a href="box.html#propdef-margin-bottom" class="noxref"><span
class="propinst-margin-bottom">'margin-bottom'</span></a> are still
'auto', solve the equation under the extra constraint that the two
margins must get equal values.
</li>
<li>If at this point there is only one 'auto' left, solve the equation 
for that value.
</li>
<li>If at this point the values are over-constrained, ignore the value
for <a href="visuren.html#propdef-bottom" class="noxref"><span class="propinst-bottom">'bottom'</span></a> and solve for that
value.
</li>
</ol>

</details>
<h3>10.6.6 <a name="block-root-margin">Complicated cases</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>This section applies to:

<ul>
    <li>Block-level, non-replaced elements in normal flow when
    'overflow' does not compute to 'visible' (except if the 'overflow'
    property's value has been propagated to the viewport).

    <li>'Inline-block', non-replaced elements.

    <li>Floating, non-replaced elements.
</ul>

<p>If <a href="box.html#propdef-margin-top" class="noxref"><span class="propinst-margin-top">'margin-top'</span></a>, or <a href="box.html#propdef-margin-bottom" class="noxref"><span
class="propinst-margin-bottom">'margin-bottom'</span></a> are 'auto',
their used value is 0. If <a href="visudet.html#propdef-height" class="noxref"><span
class="propinst-height">'height'</span></a> is 'auto', the <a
href="#root-height">height depends on the element's descendants per 10.6.7</a>.

<p>For 'inline-block' elements, the margin box is used when calculating
the height of the line box.

</details>
<h3>10.6.7 <a name="root-height">'Auto' heights for block formatting context
roots</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>In certain cases (see, e.g., sections
<a href="#abs-non-replaced-height">10.6.4</a> and
<a href="#block-root-margin">10.6.6</a> above), the height of an
element that establishes a block formatting context is computed as follows:

<p>If it only has inline-level children, the height is the distance
between the top of the topmost line box and the bottom of the
bottommost line box.
</p>
<p>If it has block-level children, the height is the distance between
the top margin-edge of the topmost block-level child box and the
bottom margin-edge of the bottommost block-level child box.
</p>
<p>Absolutely positioned children are ignored, and relatively
positioned boxes are considered without their offset. Note that the
child box may be an <a
href="visuren.html#anonymous-block-level">anonymous block box.</a>
</p>
<p>In addition, if the element has any floating descendants
whose bottom margin edge is below the element's bottom content edge,
then the height is increased to include those edges.
Only floats that participate in this block formatting context are taken into account,
e.g., floats inside absolutely positioned descendants or other floats are not.
</p>

</details>
<h2>10.7 <a name="min-max-heights">Minimum and maximum heights</a>: <a href="visudet.html#propdef-min-height" class="noxref"><span
class="propinst-min-height">'min-height'</span></a> and <a href="visudet.html#propdef-max-height" class="noxref"><span
class="propinst-max-height">'max-height'</span></a></h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p>It is sometimes useful to constrain the height of elements to a
certain range. Two properties offer this functionality:
</p>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x13"><span class="index-def" title="'min-height'"><dfn id="propdef-min-height">min-height</dfn></span></a><tr><th>Value:<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>0
<tr><th>Applies to:<td>all elements but non-replaced inline elements, table columns, and column groups
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>see prose
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>the percentage as specified or the absolute length
</table>
<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x14"><span class="index-def" title="'max-height'"><dfn id="propdef-max-height">max-height</dfn></span></a><tr><th>Value:<td><a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | none | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>none
<tr><th>Applies to:<td>all elements but non-replaced inline elements, table columns, and column groups
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>see prose
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>the percentage as specified or the absolute length or 'none'
</table>

<p>These two properties allow authors to constrain box heights to a
certain range. Values have the following meanings:</p>

<dl>
<dt><span class="index-inst" title="&lt;length&gt;"><a name="x15" href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length"><strong>&lt;length&gt;</strong></span></a></span>
</dt>
<dd>Specifies a fixed minimum or maximum computed height.
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><a name="x16" href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></a></span>
</dt>
<dd>Specifies a percentage for determining the used value.
The percentage is calculated with respect to the height of the
generated box's <a href="visuren.html#containing-block">containing block</a>.
If the height of the containing block is not 
specified explicitly (i.e., it depends on content height), and this
element is not absolutely positioned, the
percentage value is treated as '0' (for <a href="visudet.html#propdef-min-height" class="noxref"><span
class="propinst-min-height">'min-height'</span></a>) or 'none'
(for <a href="visudet.html#propdef-max-height" class="noxref"><span class="propinst-max-height">'max-height'</span></a>).
</dd>
<dt><strong>none</strong>
</dt>
<dd>(Only on <a href="visudet.html#propdef-max-height" class="noxref"><span class="propinst-max-height">'max-height'</span></a>) No limit on the height of the box. 
</dd>
</dl>

<p>Negative values for <a href="visudet.html#propdef-min-height" class="noxref"><span
class="propinst-min-height">'min-height'</span></a> and <a href="visudet.html#propdef-max-height" class="noxref"><span
class="propinst-max-height">'max-height'</span></a> are illegal.
</p>

<p>In CSS&nbsp;2.2, the effect of 'min-height' and 'max-height' on
tables, inline tables, table cells, table rows, and row groups is undefined.

<p>The following algorithm describes how the two properties influence
the <a href="cascade.html#computed-value">used value</a>
of the <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a> property:</p>

<ol>

<li>The tentative used height is calculated (without <a href="visudet.html#propdef-min-height" class="noxref"><span
class="propinst-min-height">'min-height'</span></a> and <a href="visudet.html#propdef-max-height" class="noxref"><span
class="propinst-max-height">'max-height'</span></a>) following the rules
under <a href="#Computing_heights_and_margins">"Calculating heights and
margins"</a> above.
</li>
<li>If this tentative height is greater than <a href="visudet.html#propdef-max-height" class="noxref"><span
class="propinst-max-height">'max-height'</span></a>, the rules <a
href="#Computing_heights_and_margins">above</a> are applied again, but
this time using the value of <a href="visudet.html#propdef-max-height" class="noxref"><span
class="propinst-max-height">'max-height'</span></a> as the computed value
for <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>.
</li>
<li>If the resulting height is smaller than <a href="visudet.html#propdef-min-height" class="noxref"><span
class="propinst-min-height">'min-height'</span></a>, the rules <a
href="#Computing_heights_and_margins">above</a> are applied again, but
this time using the value of <a href="visudet.html#propdef-min-height" class="noxref"><span
class="propinst-min-height">'min-height'</span></a> as the computed value
for <a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>.
</li>
</ol>

<p class="note">These steps do not affect the real computed value of
<a href="visudet.html#propdef-height" class="noxref"><span class="propinst-height">'height'</span></a>. Consequently, for
example, they do not affect margin collapsing, which depends on the
computed value.

<p>However, for replaced elements with both <a href="visudet.html#propdef-width" class="noxref"><span
class="propinst-width">'width'</span></a> and <a href="visudet.html#propdef-height" class="noxref"><span
class="propinst-height">'height'</span></a> computed as 'auto', use the
algorithm under <a href="#min-max-widths">Minimum and maximum
widths</a> above to find the used width and height. Then apply the
rules under <a href="#Computing_heights_and_margins">"Computing
heights and margins"</a> above, using the resulting width and height as
if they were the computed values.
</p>

</details>
<h2>10.8 <a name="line-height">Line height calculations</a>: the <a href="visudet.html#propdef-line-height" class="noxref"><span
class="propinst-line-height">'line-height'</span></a> and <a href="visudet.html#propdef-vertical-align" class="noxref"><span
class="propinst-vertical-align">'vertical-align'</span></a>
properties</h2>
<details class="valor-spec" data-level="2">
  <summary>Show spec text</summary>

<p>As described in the section on <a
href="visuren.html#inline-formatting">inline formatting contexts</a>,
user agents flow inline-level boxes into a vertical stack of <a
href="visuren.html#line-box">line boxes</a>. The height of a line box
is determined as follows:</p>

<ol>
<li>The height of each inline-level box in the line box is calculated.

For replaced elements, inline-block elements, and inline-table
elements, this is the height of their margin box; for inline boxes,
this is their 'line-height'.

(See <a href="#Computing_heights_and_margins">"Calculating heights and
margins"</a> and the <a href="#inline-box-height">height of inline
boxes</a> in <a href="#leading">"Leading and half-leading"</a>.)

</li>
<li>The inline-level boxes are aligned vertically according
to their <a href="visudet.html#propdef-vertical-align" class="noxref"><span class="propinst-vertical-align">'vertical-align'</span></a>
property.

In case they are aligned 'top' or 'bottom', they must be aligned so as
to minimize the line box height. If such boxes are tall enough, there
are multiple solutions and CSS&nbsp;2.2 does not define the position
of the line box's baseline (i.e., the position of the <a
href="#strut">strut, see below</a>).
</li>
<li>The line box height is the distance between the uppermost
box top and the lowermost box bottom. (This includes the <a
href="#strut">strut,</a> as explained under <a href="visudet.html#propdef-line-height" class="noxref"><span
class="propinst-line-height">'line-height'</span></a> below.)
</li>
</ol>

<p>Empty inline elements generate empty inline boxes, but these boxes
still have margins, padding, borders and a line height, and thus
influence these calculations just like elements with content.
</p>

</details>
<h3>10.8.1 <a name="leading">Leading and half-leading</a></h3>
<details class="valor-spec" data-level="3">
  <summary>Show spec text</summary>

<p>CSS assumes that every font has font metrics that specify a
characteristic height above the baseline and a depth below it. In this
section we use <var>A</var> to mean that height (for a given font at a
given size) and <var>D</var> the depth. We also define <var>AD</var> =
<var>A</var> + <var>D</var>, the distance from the top to the
bottom. (See the note below for <a href="#sTypoAscender">how to find
<var>A</var> and <var>D</var> for TrueType and OpenType fonts.</a>)
Note that these are metrics of the font as a whole and need not
correspond to the ascender and descender of any individual glyph.

<p>User agent must align the glyphs in a non-replaced inline box to
each other by their relevant baselines. Then, for
each glyph, determine the <var>A</var> and <var>D</var>. Note that
glyphs in a single element may come from different fonts and thus need
not all have the same <var>A</var> and <var>D</var>. If the inline box
contains no glyphs at all, it is considered to contain a <a
href="#strut">strut</a> (an invisible glyph of zero width) with the
<var>A</var> and <var>D</var> of the element's first available font.

<p>Still for each glyph, determine the leading <var>L</var> to add,
where <var>L</var> = <a href="visudet.html#propdef-line-height" class="noxref"><span
class="propinst-line-height">'line-height'</span></a> - <var>AD</var>. Half
the leading is added above <var>A</var> and the other half below
<var>D</var>, giving the glyph and its leading a total height above
the baseline of <var>A'</var> = <var>A</var> + <var>L</var>/2 and a
total depth of <var>D'</var> = <var>D</var> + <var>L</var>/2.

<p class=note><strong>Note.</strong> <var>L</var> may be negative.

<p id="inline-box-height">The height of the inline box encloses all
glyphs and their half-leading on each side and is thus exactly
'line-height'. Boxes of
child elements do not influence this height.

<p>Although margins, borders, and padding of non-replaced elements do
not enter into the line box calculation, they are still rendered
around inline boxes. This means that if the height specified by <a href="visudet.html#propdef-line-height" class="noxref"><span
class="propinst-line-height">'line-height'</span></a> is less than the
content height of contained boxes, backgrounds and colors of padding
and borders may "bleed" into adjoining line boxes. User agents should
render the boxes in document order. This will cause the borders on
subsequent lines to paint over the borders and text of previous lines.
</p>

<p class=note><em><strong>Note.</strong> CSS&nbsp;2.2 does not define
what the content area of an inline box is (see <a
href="#inline-non-replaced">10.6.1</a> above) and thus different UAs
may draw the backgrounds and borders in different places.</em>

<p id=sTypoAscender class=note><em><strong>Note.</strong> It is
recommended that implementations that use OpenType or TrueType fonts
use the metrics "sTypoAscender" and "sTypoDescender" from the font's
OS/2 table for A and D (after scaling to the current element's font
size). In the absence of these metrics, the "Ascent" and "Descent"
metrics from the HHEA table should be used.</em>

<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x17"><span class="index-def" title="'line-height'"><dfn id="propdef-line-height">line-height</dfn></span></a><tr><th>Value:<td>normal | <a href="syndata.html#value-def-number" class="noxref"><span class="value-inst-number">&lt;number&gt;</span></a> | <a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>normal
<tr><th>Applies to:<td>all elements
<tr><th>Inherited:<td>yes
<tr><th>Percentages:<td>refer to the font size of the element itself
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>for <a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> and <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> the absolute value; otherwise as specified
</table>

<p>On a <a href="visuren.html#block-boxes">block container element</a>
whose content
is composed of <a href="visuren.html#inline-level">inline-level</a>
elements, 'line-height' specifies the <em>minimal</em> height of line boxes
within the element. The minimum height consists of a minimum height above
the baseline and a minimum depth below it, exactly as if each
line box starts with a <a name="strut">zero-width inline box with the
element's font and line height properties.</a> We call that imaginary
box a "strut." (The name is inspired by TeX.).
</p>

<p>The height and depth of the font above and below the baseline are
assumed to be metrics that are contained in the font. (For more
details, see CSS level&nbsp;3.)

<p>On a non-replaced <a
href="visuren.html#inline-boxes">inline</a> element, 'line-height'
specifies the height that is used in the calculation of the line box
height.
</p>
<p>Values for this property have the following meanings:</p>

<dl>
<dt><strong>normal</strong> </dt>
<dd>Tells user agents to set the used
value to a "reasonable" value based on the font of the element. The
value has the same meaning as <span class="index-inst"
title="&lt;number&gt;"><a name="x18" href="syndata.html#value-def-number" class="noxref"><span
class="value-inst-number">&lt;number&gt;</span></a></span>. We recommend a
used value for 'normal' between 1.0 to 1.2. The <a
href="cascade.html#computed-value">computed value</a> is 'normal'.
</dd>
<dt><span class="index-inst" title="&lt;length&gt;"><a name="x19" href="syndata.html#value-def-length" class="noxref"><span
class="value-inst-length"><strong>&lt;length&gt;</strong></span></a></span>
</dt>
<dd>The specified length is used in the calculation of the line box
height. Negative values are illegal.
</dd>
<dt><span class="index-inst" title="&lt;number&gt;"><a name="x20" href="syndata.html#value-def-number" class="noxref"><span
class="value-inst-number"><strong>&lt;number&gt;</strong></span></a></span>
</dt>
<dd>The used value of the property is this number multiplied by the
element's font size. Negative values are illegal. The <a
href="cascade.html#computed-value">computed value</a> is the same as
the specified value.
</dd>
<dt><span class="index-inst" title="&lt;percentage&gt;"><a name="x21" href="syndata.html#value-def-percentage" class="noxref"><span
class="value-inst-percentage"><strong>&lt;percentage&gt;</strong></span></a></span>
</dt>
<dd>The <a href="cascade.html#computed-value">computed value</a> of the
property is this percentage multiplied by the element's 
computed font size. Negative values are illegal.
</dd>
</dl>

<div class="example"><P style="display:none">Example(s):</P><p>
The three rules in the example below have the same resultant line height:
</p>
<pre>
div { line-height: 1.2; font-size: 10pt }     /* number */
div { line-height: 1.2em; font-size: 10pt }   /* length */
div { line-height: 120%; font-size: 10pt }    /* percentage */
</pre>
</div>

<p>When an element contains text that is rendered
in more than one font, user agents may determine the 'normal' <a href="visudet.html#propdef-line-height" class="noxref"><span
class="propinst-line-height">'line-height'</span></a> value according to
the largest font size.
</p>
<p class=note><em><strong>Note.</strong> When there is only one value of <a href="visudet.html#propdef-line-height" class="noxref"><span
class="propinst-line-height">'line-height'</span></a> for all inline
boxes in a block container box and they are all in the same font (and
there are no replaced elements, inline-block
elements, etc.), the above will ensure that
baselines of successive lines are exactly <a href="visudet.html#propdef-line-height" class="noxref"><span
class="propinst-line-height">'line-height'</span></a> apart. This is
important when columns of text in different fonts have to be aligned,
for example in a table.</em>
</p>
<table class="def propdef">
 <tbody>
  <tr>
   <th>Name:
   <td><a name="x22"><span class="index-def" title="'vertical-align'"><dfn id="propdef-vertical-align">vertical-align</dfn></span></a><tr><th>Value:<td>baseline | sub | super | top | text-top | middle | 
   bottom | text-bottom | <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> | <a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> | <a href="cascade.html#value-def-inherit" class="noxref"><span class="value-inst-inherit">inherit</span></a>
<tr><th>Initial:<td>baseline
<tr><th>Applies to:<td>inline-level and 'table-cell' elements
<tr><th>Inherited:<td>no
<tr><th>Percentages:<td>refer to the 'line-height' of the element itself
<tr><th>Media:<td><a href="media.html#visual-media-group" class="noxref">visual</a>
<tr><th>Computed&nbsp;value:<td>for <a href="syndata.html#value-def-percentage" class="noxref"><span class="value-inst-percentage">&lt;percentage&gt;</span></a> and <a href="syndata.html#value-def-length" class="noxref"><span class="value-inst-length">&lt;length&gt;</span></a> the absolute length, otherwise as specified
</table>

<p>This property affects the vertical positioning inside a line box of
the boxes generated by an inline-level element.</p>
 
<div class="note"><p>
<em><strong>Note.</strong> Values of this property have
different meanings in the context of tables.
Please consult the section on <a href="tables.html#height-layout">
table height algorithms</a> for details.
</em>
</p>
</div>

<p>The following values only have meaning with respect to a parent
inline element, or to the <a href="#strut">strut</a> of a parent
block container element.

<p>In the following definitions, for inline non-replaced elements, the
box used for alignment is the box whose height is the 'line-height'
(containing the box's glyphs and the half-leading on each side, see <a
href="#inline-box-height">above</a>). For all other elements, the box
used for alignment is the margin box.

<dl>
  <dt><strong>baseline</strong></dt>
  <dd>Align the baseline of the box with the baseline of
      the parent box. If the box does not have a baseline, align the
      bottom margin edge with the parent's baseline.</dd>
  <dt><strong>middle</strong></dt>
  <dd>Align the vertical midpoint of the box with the baseline
      of the parent box plus half the x-height of the parent.</dd>
  <dt><strong>sub</strong></dt>
  <dd>Lower the baseline of the box to the proper position for
      subscripts of the parent's box. (This value has no effect on the
      font size of the element's text.)</dd>
  <dt><strong>super</strong></dt>
  <dd>Raise the baseline of the box to the proper position for
      superscripts of the parent's box. (This value has no effect on the
      font size of the element's text.)</dd>
  <dt><strong>text-top</strong></dt>
  <dd>Align the top of the box with the top of the parent's content
      area (see <a href="#inline-non-replaced">10.6.1</a>).</dd>
  <dt><strong>text-bottom</strong></dt>
  <dd>Align the bottom of the box with the bottom of the parent's
      content area (see <a
      href="#inline-non-replaced">10.6.1</a>).</dd>
  <dt><span class="index-inst" title="&lt;percentage&gt;"><a name="x23" href="syndata.html#value-def-percentage" class="noxref"><span
  class="value-inst-percentage"><strong>&lt;percentage&gt;
  </strong></span></a></span></dt>
  <dd>Raise (positive value) or lower (negative value) the box
      by this distance (a percentage of the <a href="visudet.html#propdef-line-height" class="noxref"><span
      class="propinst-line-height">'line-height'</span></a> value).
      The value '0%' means the same as 'baseline'.</dd>
  <dt><span class="index-inst" title="&lt;length&gt;"><a name="x24" href="syndata.html#value-def-length" class="noxref"><span
  class="value-inst-length"><strong>&lt;length&gt;
  </strong></span></a></span></dt>
  <dd>Raise (positive value) or lower (negative value) the box
      by this distance.
      The value '0cm' means the same as 'baseline'.
  </dd>
</dl>
<p>The following values align the element relative to the line box.
Since the element may have children aligned relative to it (which in
turn may have descendants aligned relative to them), these values use
the bounds of the aligned subtree. The <dfn>aligned subtree</dfn> of
an inline element contains that element and the aligned subtrees of
all children inline elements whose computed 'vertical-align' value is
not 'top' or 'bottom'. The top of the aligned subtree is the highest
of the tops of the boxes in the subtree, and the bottom is analogous.
<dl>
  <dt><strong>top</strong></dt>
  <dd>Align the top of the aligned subtree with the top of the line box.</dd>
  <dt><strong>bottom</strong></dt>
  <dd>Align the bottom of the aligned subtree with the bottom of the
  line box.</dd>
</dl>

<p>The baseline of an 'inline-table' is the baseline of the first row
of the table.
</p>
<p>The baseline of an 'inline-block' is the baseline of its last line
box in the normal flow, unless it has either no in-flow line boxes or
if its 'overflow' property has a computed value other than 'visible',
in which case the baseline is the bottom margin edge.</p>
<hr class="navbar">

<div class="navbar">
<p><a href="visuren.html">previous</a> &nbsp;
<a href="visufx.html">next</a> &nbsp;
<a href="Overview.html#minitoc">contents</a> &nbsp;
<a href="propidx.html">properties</a> &nbsp;
<a href="indexlist.html">index</a> &nbsp;
</div>
</body>

</details>
<!-- END VERBATIM SPEC: DO NOT EDIT ABOVE. -->
