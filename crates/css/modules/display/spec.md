# CSS Display — Spec Coverage Map (CSS Display 3, CSS 2.2)

Primary spec(s):
- https://www.w3.org/TR/css-display-3/
- https://www.w3.org/TR/CSS22/

## Scope and maturity

- Status: [Production] for box generation and display tree normalization; [MVP] for anonymous blocks and IFC.
- Non-production items:
  - [MVP] Anonymous block synthesis for inline runs.
  - [MVP] Inline formatting context (line boxes) and inline sizing from shaped text.
  - [TODO] Integration with block/inline formatting contexts across BFC boundaries.

## One-to-one spec mapping (sorted by spec order)

- CSS Display 3 — Box generation and display tree normalization
  - Status: [x] [Production]
  - Spec: https://www.w3.org/TR/css-display-3/
  - Code:
    - `crates/css/modules/display/src/lib.rs::normalize_children()` — production normalization of children: skip `display:none`, lift `display:contents`.
    - `crates/css/modules/layouter/src/box_tree.rs::flatten_display_children()` — shim delegating to display normalization.
  - Notes:
    - Normalization is centralized in the Display module; Layouter calls into it.
    - Additional display rules (anonymous blocks for inline runs) will land here next.
  - Fixtures:
    - `crates/css/modules/display/tests/fixtures/layout/inline/12_anonymous_blocks.html`

- CSS 2.2 §9.4.1 — Anonymous block boxes around inline content
  - Status: [ ] [MVP]
  - Spec: https://www.w3.org/TR/CSS22/visuren.html#anonymous-block-level
  - Code:
    - `crates/css/modules/display/src/anonymous_blocks.rs::build_anonymous_block_runs()` — analysis of inline/block runs for anonymous block synthesis. [MVP]
    - [Planned] `display::synthesize_anonymous_blocks()` — will wrap inline runs into anonymous block boxes for layouter consumption.
  - Notes:
    - [MVP] Current layouter treats inline simplistically; anonymous blocks will be generated here and surfaced to layouter.
  - Fixtures:
    - `crates/css/modules/display/tests/fixtures/layout/inline/12_anonymous_blocks.html`
    - [TODO] Add coverage for mixed inline-block sequences and nested inline content.

- CSS 2.2 — Inline formatting context and line boxes
  - Status: [ ] [MVP]
  - Spec: https://www.w3.org/TR/CSS22/visuren.html#inline-formatting
  - Code:
    - [Planned] `crates/css/modules/display/src/inline_formatting.rs` — build line boxes, measure inline content.
  - Notes:
    - [MVP] Minimal shrink-to-fit via shaped text width can be staged before full line-box construction.
  - Fixtures:
    - `crates/css/modules/display/tests/fixtures/layout/inline/04_block_inline_partition.html`

## Algorithms and data flow

- Entry points (planned):
  - `display::normalize_children()` — perform display tree normalization (display: none/contents). Anonymous blocks to be added here.
  - `display::build_inline_context()` — produce line boxes and inline fragments.
- Integration:
  - Upstream: `style_engine::ComputedStyle`.
  - Downstream: `layouter` consumes normalized tree via `box_tree::flatten_display_children()` and inline fragments for layout passes.

## Edge cases and conformance nuances

- `display: contents` and anonymous block interactions with margin collapsing and BFC boundaries.
- Whitespace collapsing within inline formatting context (to be implemented here, not in layouter).

## Testing and fixtures

- Fixtures under: `crates/css/modules/display/tests/fixtures/layout/inline/**`.
- To ignore a fixture (expected failure), rename it with the `.fail` extension. The harness only runs `.html` fixtures; `.fail` files are skipped by discovery.

---

# Verbatim Spec (CSS Display Level 3)

Legal notice (required for embedded spec text):

```
Valor: https://github.com/BigBadE/Valor
Copyright © [2025] World Wide Web Consortium. All Rights Reserved. This work is distributed under the W3C® Software and Document License [1] in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.
[1] https://www.w3.org/Consortium/Legal/copyright-software
```

Note: Each top-level section below MUST begin with a status marker and be followed by a mapping block. The embedded content is sourced directly from the W3C CSS Display Module Level 3 specification.

<!-- BEGIN VERBATIM SPEC: DO NOT EDIT BELOW. This block is auto-generated by scripts/vendor_display_spec.ps1 -->

## <span class="secno">1. </span><span class="content"> Introduction</span><a href="#intro" class="self-link"></a>

*This section is normative.*

CSS takes a source document organized as a <span id="element-tree" class="dfn dfn-paneled" dfn-for="CSS" dfn-type="dfn" export="" lt="element tree">tree<span id="css-element-tree"></span></span> of <span id="elements" class="dfn dfn-paneled" dfn-for="CSS" dfn-type="dfn" lt="element" noexport="">elements<span id="css-element"></span></span> (which can contain a mix of other <a href="#elements" id="ref-for-elements" data-link-type="dfn">elements</a> and <a href="#text-nodes" id="ref-for-text-nodes" data-link-type="dfn">text nodes</a>) and <span id="text-nodes" class="dfn dfn-paneled" dfn-for="CSS" dfn-type="dfn" export="" lt="text node">text nodes<span id="css-text-node"></span></span> (which can contain text), and renders it onto a [canvas](https://www.w3.org/TR/CSS2/intro.html#canvas) such as your screen, a piece of paper, or an audio stream. Although any such source document can be rendered with CSS, the most commonly used type is the DOM. <a href="#biblio-dom" data-link-type="biblio" title="DOM Standard">[DOM]</a> (Some of these more complex tree types might have additional types of nodes, such as the comment nodes in the DOM. For the purposes of CSS, all of these additional types of nodes are ignored, as if they didn’t exist.)

To do this, it generates an intermediary structure, the <span id="box-tree" class="dfn dfn-paneled" dfn-for="CSS" dfn-type="dfn" export="">box tree<span id="css-box-tree"></span></span>, which represents the formatting structure of the rendered document. Each <span id="box" class="dfn dfn-paneled" dfn-for="CSS" dfn-type="dfn" export="">box<span id="css-box"></span></span> in the <a href="#box-tree" id="ref-for-box-tree" data-link-type="dfn">box tree</a> represents its corresponding <a href="#elements" id="ref-for-elements①" data-link-type="dfn">element</a> (or <a href="https://www.w3.org/TR/selectors-4/#pseudo-element" id="ref-for-pseudo-element" data-link-type="dfn">pseudo-element</a>) in space and/or time on the canvas, while each <span id="css-text-sequence" class="dfn dfn-paneled" dfn-for="CSS" dfn-type="dfn" export="">text sequence<span id="css-text-run"></span><span id="text-run"></span></span> in the <span id="ref-for-box-tree①">box tree</span> likewise represents the corresponding contents of its <a href="#text-nodes" id="ref-for-text-nodes①" data-link-type="dfn">text nodes</a>.

To create the <a href="#box-tree" id="ref-for-box-tree②" data-link-type="dfn">box tree</a>, CSS first uses [cascading and inheritance](https://www.w3.org/TR/css-cascade/), to assign a <a href="https://www.w3.org/TR/css-cascade-5/#computed-value" id="ref-for-computed-value" data-link-type="dfn">computed value</a> for each CSS property to each <a href="#elements" id="ref-for-elements②" data-link-type="dfn">element</a> and <a href="#text-nodes" id="ref-for-text-nodes②" data-link-type="dfn">text node</a> in the source tree. (See <a href="#biblio-css-cascade-3" data-link-type="biblio" title="CSS Cascading and Inheritance Level 3">[CSS-CASCADE-3]</a>.)

Then, for each <a href="#elements" id="ref-for-elements③" data-link-type="dfn">element</a>, CSS generates zero or more <a href="#box" id="ref-for-box" data-link-type="dfn">boxes</a> as specified by that element’s <a href="#propdef-display" id="ref-for-propdef-display③" class="property css" data-link-type="property">display</a> property. Typically, an element generates a single <span id="ref-for-box①">box</span>, the <a href="#principal-box" id="ref-for-principal-box" data-link-type="dfn">principal box</a>, which represents itself and contains its contents in the <a href="#box-tree" id="ref-for-box-tree③" data-link-type="dfn">box tree</a>. However, some <span id="ref-for-propdef-display④" class="property">display</span> values (e.g. <span id="ref-for-propdef-display⑤" class="css">display: list-item</span>) generate more than one box (e.g. a [principal block box](https://www.w3.org/TR/CSS2/visuren.html#principal-box) and a child [marker box](https://www.w3.org/TR/CSS2/generate.html#lists)). And some values (such as <a href="#valdef-display-none" id="ref-for-valdef-display-none" class="css" data-link-type="maybe">none</a> or <a href="#valdef-display-contents" id="ref-for-valdef-display-contents" class="css" data-link-type="maybe">contents</a>) cause the <span id="ref-for-elements④">element</span> and/or its descendants to not generate any <span id="ref-for-box②">boxes</span> at all. <span id="ref-for-box③">Boxes</span> are often referred to by their <span id="ref-for-propdef-display⑥" class="property">display</span> type—e.g. a <span id="ref-for-box④">box</span> generated by an element with <span id="ref-for-propdef-display⑦" class="css">display: block</span> is called a “block box” or just a “block”.

A <a href="#box" id="ref-for-box⑤" data-link-type="dfn">box</a> is assigned the same styles as its generating <a href="#elements" id="ref-for-elements⑤" data-link-type="dfn">element</a>, unless otherwise indicated. In general, <a href="https://www.w3.org/TR/css-cascade-5/#inherited-property" id="ref-for-inherited-property" data-link-type="dfn">inherited properties</a> are assigned to the <a href="#principal-box" id="ref-for-principal-box①" data-link-type="dfn">principal box</a>, and then inherit through the box tree to any other boxes generated by the same element. Non-inherited properties default to applying to the <span id="ref-for-principal-box②">principal box</span>, but when the element generates multiple boxes, are sometimes defined to apply to a different box: for example, the <a href="https://www.w3.org/TR/css-backgrounds-3/#propdef-border" id="ref-for-propdef-border" class="property css" data-link-type="property">border</a> properties applied to a table element are applied to its <a href="https://www.w3.org/TR/css-tables-3/#table-grid-box" id="ref-for-table-grid-box" data-link-type="dfn">table grid box</a>, not to its <span id="ref-for-principal-box③">principal</span> <a href="https://www.w3.org/TR/css-tables-3/#table-wrapper-box" id="ref-for-table-wrapper-box" data-link-type="dfn">table wrapper box</a>. If the value computation process alters the styles of those boxes, and the element’s style is requested (such as through <a href="https://www.w3.org/TR/cssom-1/#dom-window-getcomputedstyle" id="ref-for-dom-window-getcomputedstyle" data-link-type="idl"><code class="idl">getComputedStyle()</code></a>), the element reflects, for each property, the value from the box to which that property was applied.

Similarly, each contiguous sequence of sibling <a href="#text-nodes" id="ref-for-text-nodes③" data-link-type="dfn">text nodes</a> generates a <a href="#css-text-sequence" id="ref-for-css-text-sequence" data-link-type="dfn">text sequence</a> containing their text contents, which is assigned the same styles as the generating <span id="ref-for-text-nodes④">text nodes</span>. If the sequence contains no text, however, it does not generate a <span id="ref-for-css-text-sequence①">text sequence</span>.

In constructing the box tree, boxes generated by an element are descendants of the principal box of any ancestor elements. In the general case, the direct <span id="css-parent-box" class="dfn dfn-paneled" dfn-for="CSS" dfn-type="dfn" export="">parent box</span> of an element’s <a href="#principal-box" id="ref-for-principal-box④" data-link-type="dfn">principal box</a> is the <span id="ref-for-principal-box⑤">principal box</span> of its nearest ancestor element that generates a <a href="#box" id="ref-for-box⑥" data-link-type="dfn">box</a>; however, there are some exceptions, such as for <a href="#valdef-display-run-in" id="ref-for-valdef-display-run-in" class="css" data-link-type="maybe">run-in</a> boxes, display types (like tables) that generate multiple container boxes, and intervening <a href="#anonymous" id="ref-for-anonymous" data-link-type="dfn">anonymous boxes</a>.

An <span id="anonymous" class="dfn dfn-paneled" dfn-for="CSS" dfn-type="dfn" export="" lt="anonymous|anonymous box">anonymous box<span id="css-anonymous"></span></span> is a box that is not associated with any element. <a href="#anonymous" id="ref-for-anonymous①" data-link-type="dfn">Anonymous boxes</a> are generated in certain circumstances to fix up the <a href="#box-tree" id="ref-for-box-tree④" data-link-type="dfn">box tree</a> when it requires a particular nested structure that is not provided by the boxes generated from the <a href="#element-tree" id="ref-for-element-tree" data-link-type="dfn">element tree</a>. For example, a [table cell box](https://www.w3.org/TR/CSS2/tables.html#table-display) requires a particular type of parent box (the [table row box](https://www.w3.org/TR/CSS2/tables.html#table-display)), and will generate an <span id="ref-for-anonymous②">anonymous</span> [table row box](https://www.w3.org/TR/CSS2/tables.html#table-display) around itself if its parent is not a [table row box](https://www.w3.org/TR/CSS2/tables.html#table-display). (See <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a> § [17.2.1](https://www.w3.org/TR/CSS2/tables.html#anonymous-boxes).) Unlike element-generated boxes, whose styles inherit strictly through the element tree, anonymous boxes (which only exist in the <span id="ref-for-box-tree⑤">box tree</span>) [inherit](https://www.w3.org/TR/css-cascade/#inheriting) through their <span id="ref-for-box-tree⑥">box tree</span> parentage.

In the course of layout, <a href="#box" id="ref-for-box⑦" data-link-type="dfn">boxes</a> and <a href="#css-text-sequence" id="ref-for-css-text-sequence②" data-link-type="dfn">text sequences</a> can be broken into multiple <a href="https://www.w3.org/TR/css-break-3/#fragment" id="ref-for-fragment" data-link-type="dfn">fragments</a>. This happens, for example, when an <a href="#inline-box" id="ref-for-inline-box" data-link-type="dfn">inline box</a> and/or <span id="ref-for-css-text-sequence③">text sequence</span> is broken across lines, or when a <a href="#block-box" id="ref-for-block-box" data-link-type="dfn">block box</a> is broken across pages or columns, in a process called <a href="https://www.w3.org/TR/css-break-4/#fragmentation" id="ref-for-fragmentation" data-link-type="dfn">fragmentation</a>. It can also happen due to bidi reordering of text (see [Applying the Bidirectional Reordering Algorithm](https://www.w3.org/TR/css-writing-modes-3/#bidi-algo) in [CSS Writing Modes](https://www.w3.org/TR/css-writing-modes-3/#text-direction)) or higher-level <a href="#display-type" id="ref-for-display-type" data-link-type="dfn">display type</a> box splitting, e.g. [block-in-inline splitting](https://www.w3.org/TR/CSS2/visuren.html#img-anon-block) (see [CSS2§9.2](https://www.w3.org/TR/CSS2/visuren.html#box-gen)) or [column-spanner-in-block](https://www.w3.org/TR/css-multicol-1/#spanning-columns) splitting (see [CSS Multi-column Layout](https://www.w3.org/TR/css-multicol-1/#spanning-columns)). A <span id="ref-for-box⑧">box</span> therefore consists of one or more <a href="https://www.w3.org/TR/css-break-4/#box-fragment" id="ref-for-box-fragment" data-link-type="dfn">box fragments</a>, and a <span id="ref-for-css-text-sequence④">text sequence</span> consists of one or more <span id="ref-for-fragment①">text fragments</span>. See <a href="#biblio-css-break-3" data-link-type="biblio" title="CSS Fragmentation Module Level 3">[CSS-BREAK-3]</a> for more information on <span id="ref-for-fragmentation①">fragmentation</span>.

<span class="marker">Note:</span> Many of the CSS specs were written before this terminology was ironed out, or refer to things incorrectly, so view older specs with caution when they’re using these terms. It should be possible to infer from context which term they really mean. Please [report errors](#sotd) in specs when you find them, so they can be corrected.

<span class="marker">Note:</span> Further information on the “aural” box tree and its interaction with the <a href="#propdef-display" id="ref-for-propdef-display⑧" class="property css" data-link-type="property">display</a> property can be found in the [CSS Speech Module](https://www.w3.org/TR/css-speech-1/#aural-model). <a href="#biblio-css-speech-1" data-link-type="biblio" title="CSS Speech Module Level 1">[CSS-SPEECH-1]</a>

### <span class="secno">1.1. </span><span class="content"> Module interactions</span><a href="#placement" class="self-link"></a>

This module replaces and extends the definition of the <a href="#propdef-display" id="ref-for-propdef-display⑨" class="property css" data-link-type="property">display</a> property defined in <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a> section 9.2.4.

None of the properties in this module apply to the `::first-line` or `::first-letter` pseudo-elements.

### <span class="secno">1.2. </span><span class="content"> Value Definitions</span><a href="#values" class="self-link"></a>


| Field | Value |
|---|---|
| Value | s and Units Module Level 3">[CSS-VALUES-3]</a>. Value types not defined in this specification are defined in CSS Values & Units <span title="CSS Values and Units Module Level 3">[CSS-VALUES-3]</span>. Combination with other CSS modules may expand the definitions of these value types.<br>In addition to the property-specific values listed in their definitions, all properties defined in this specification also accept the <a href="https://www.w3.org/TR/css-values-4/#css-wide-keywords" id="ref-for-css-wide-keywords" data-link-type="dfn">CSS-wide keywords</a> as their property value. For readability they have not been repeated explicitly.<br> |
## <span class="secno">2. </span><span class="content"> Box Layout Modes: the <a href="#propdef-display" id="ref-for-propdef-display①⓪" class="property css" data-link-type="property">display</a> property</span><a href="#the-display-properties" class="self-link"></a>


| Field | Value |
|---|---|
| Name | <span id="propdef-display" class="dfn dfn-paneled css" dfn-type="property" export="">display</span><br> |
| Value | s are defined as follows:<br>``` prod<br><display-outside>  = block | inline | run-in<br><display-inside>   = flow | flow-root | table | flex | grid | ruby<br><display-listitem> = <display-outside>? && [ flow | flow-root ]? && list-item<br><display-internal> = table-row-group | table-header-group |<br>                     table-footer-group | table-row | table-cell |<br>                     table-column-group | table-column | table-caption |<br>                     ruby-base | ruby-text | ruby-base-container |<br>                     ruby-text-container<br><display-box>      = contents | none<br><display-legacy>   = inline-block | inline-table | inline-flex | inline-grid<br>```<br>The following informative table summarizes the values of <a href="#propdef-display" id="ref-for-propdef-display①⑤" class="property css" data-link-type="property">display</a>:<br>Short <a href="#propdef-display" id="ref-for-propdef-display①⑥" class="property css" data-link-type="property">display</a><br>Full <a href="#propdef-display" id="ref-for-propdef-display①⑦" class="property css" data-link-type="property">display</a><br>Generated box<br><a href="#valdef-display-none" id="ref-for-valdef-display-none③" class="css" data-link-type="maybe">none</a><br>—<br>subtree omitted from <a href="#box-tree" id="ref-for-box-tree⑦" data-link-type="dfn">box tree</a><br><a href="#valdef-display-contents" id="ref-for-valdef-display-contents①" class="css" data-link-type="maybe">contents</a><br>—<br>element replaced by contents in <a href="#box-tree" id="ref-for-box-tree⑧" data-link-type="dfn">box tree</a><br><a href="#valdef-display-block" id="ref-for-valdef-display-block" class="css" data-link-type="maybe">block</a><br><span class="css">block flow</span><br><a href="#block-level" id="ref-for-block-level" data-link-type="dfn">block-level</a> <a href="#block-container" id="ref-for-block-container" data-link-type="dfn">block container</a> <span class="abbr" title="also known as">aka</span> <a href="#block-box" id="ref-for-block-box①" data-link-type="dfn">block box</a><br><a href="#valdef-display-flow-root" id="ref-for-valdef-display-flow-root" class="css" data-link-type="maybe">flow-root</a><br><span class="css">block flow-root</span><br><a href="#block-level" id="ref-for-block-level①" data-link-type="dfn">block-level</a> <a href="#block-container" id="ref-for-block-container①" data-link-type="dfn">block container</a> that establishes a new <a href="#block-formatting-context" id="ref-for-block-formatting-context" data-link-type="dfn">block formatting context</a> (<a href="#bfc" id="ref-for-bfc" data-link-type="dfn">BFC</a>)<br><a href="#valdef-display-inline" id="ref-for-valdef-display-inline" class="css" data-link-type="maybe">inline</a><br><span class="css">inline flow</span><br><a href="#inline-box" id="ref-for-inline-box①" data-link-type="dfn">inline box</a><br><a href="#valdef-display-inline-block" id="ref-for-valdef-display-inline-block" class="css" data-link-type="maybe">inline-block</a><br><span class="css">inline flow-root</span><br><a href="#inline-level" id="ref-for-inline-level" data-link-type="dfn">inline-level</a> <a href="#block-container" id="ref-for-block-container②" data-link-type="dfn">block container</a> <span class="abbr" title="also known as">aka</span> <span id="inline-block" class="dfn dfn-paneled" dfn-type="dfn" export="" lt="inline block | inline block box">inline block</span><br><a href="#valdef-display-run-in" id="ref-for-valdef-display-run-in①" class="css" data-link-type="maybe">run-in</a><br><span class="css">run-in flow</span><br><a href="#run-in" id="ref-for-run-in" data-link-type="dfn">run-in box</a> (<a href="#inline-box" id="ref-for-inline-box②" data-link-type="dfn">inline box</a> with special box-tree-munging rules)<br><a href="#valdef-display-list-item" id="ref-for-valdef-display-list-item②" class="css" data-link-type="maybe">list-item</a><br><span class="css">block flow list-item</span><br><a href="#block-box" id="ref-for-block-box②" data-link-type="dfn">block box</a> with additional [marker box](https://www.w3.org/TR/CSS2/generate.html#lists)<br><span class="css">inline list-item</span><br><span class="css">inline flow list-item</span><br><a href="#inline-box" id="ref-for-inline-box③" data-link-type="dfn">inline box</a> with additional [marker box](https://www.w3.org/TR/CSS2/generate.html#lists)<br><a href="#valdef-display-flex" id="ref-for-valdef-display-flex" class="css" data-link-type="maybe">flex</a><br><span class="css">block flex</span><br><a href="#block-level" id="ref-for-block-level②" data-link-type="dfn">block-level</a> <a href="https://www.w3.org/TR/css-flexbox-1/#flex-container" id="ref-for-flex-container" data-link-type="dfn">flex container</a><br><a href="#valdef-display-inline-flex" id="ref-for-valdef-display-inline-flex" class="css" data-link-type="maybe">inline-flex</a><br><span class="css">inline flex</span><br><a href="#inline-level" id="ref-for-inline-level①" data-link-type="dfn">inline-level</a> <a href="https://www.w3.org/TR/css-flexbox-1/#flex-container" id="ref-for-flex-container①" data-link-type="dfn">flex container</a><br><a href="#valdef-display-grid" id="ref-for-valdef-display-grid" class="css" data-link-type="maybe">grid</a><br><span class="css">block grid</span><br><a href="#block-level" id="ref-for-block-level③" data-link-type="dfn">block-level</a> <a href="https://www.w3.org/TR/css-grid-2/#grid-container" id="ref-for-grid-container" data-link-type="dfn">grid container</a><br><a href="#valdef-display-inline-grid" id="ref-for-valdef-display-inline-grid" class="css" data-link-type="maybe">inline-grid</a><br><span class="css">inline grid</span><br><a href="#inline-level" id="ref-for-inline-level②" data-link-type="dfn">inline-level</a> <a href="https://www.w3.org/TR/css-grid-2/#grid-container" id="ref-for-grid-container①" data-link-type="dfn">grid container</a><br><a href="#valdef-display-ruby" id="ref-for-valdef-display-ruby" class="css" data-link-type="maybe">ruby</a><br><span class="css">inline ruby</span><br><a href="#inline-level" id="ref-for-inline-level③" data-link-type="dfn">inline-level</a> <a href="https://www.w3.org/TR/css-ruby-1/#ruby-container" id="ref-for-ruby-container" data-link-type="dfn">ruby container</a><br><span class="css">block ruby</span><br><span class="css">block ruby</span><br><a href="#block-box" id="ref-for-block-box③" data-link-type="dfn">block box</a> containing <a href="https://www.w3.org/TR/css-ruby-1/#ruby-container" id="ref-for-ruby-container①" data-link-type="dfn">ruby container</a><br><a href="#valdef-display-table" id="ref-for-valdef-display-table" class="css" data-link-type="maybe">table</a><br><span class="css">block table</span><br><a href="#block-level" id="ref-for-block-level④" data-link-type="dfn">block-level</a> <a href="https://www.w3.org/TR/css-tables-3/#table-wrapper-box" id="ref-for-table-wrapper-box①" data-link-type="dfn">table wrapper box</a> containing <a href="https://www.w3.org/TR/css-tables-3/#table-grid-box" id="ref-for-table-grid-box①" data-link-type="dfn">table grid box</a><br><a href="#valdef-display-inline-table" id="ref-for-valdef-display-inline-table" class="css" data-link-type="maybe">inline-table</a><br><span class="css">inline table</span><br><a href="#inline-level" id="ref-for-inline-level④" data-link-type="dfn">inline-level</a> <a href="https://www.w3.org/TR/css-tables-3/#table-wrapper-box" id="ref-for-table-wrapper-box②" data-link-type="dfn">table wrapper box</a> containing <a href="https://www.w3.org/TR/css-tables-3/#table-grid-box" id="ref-for-table-grid-box②" data-link-type="dfn">table grid box</a><br><a href="#typedef-display-internal" id="ref-for-typedef-display-internal②" class="production css" data-link-type="type" title="Expands to: ruby-base | ruby-base-container | ruby-text | ruby-text-container | table-caption | table-cell | table-column | table-column-group | table-footer-group | table-header-group | table-row | table-row-group">&lt;display-internal&gt;</a> types<br>—<br>[layout-specific internal box](#layout-specific-display)<br><span class="marker">Note:</span> Following the precedence rules of “most backwards-compatible, then shortest”, serialization of equivalent <a href="#propdef-display" id="ref-for-propdef-display①⑧" class="property css" data-link-type="property">display</a> values uses the “Short <span id="ref-for-propdef-display①⑨" class="property">display</span>” column. <a href="#biblio-cssom" data-link-type="biblio" title="CSS Object Model (CSSOM)">[CSSOM]</a><br> |
| Initial | (https://www.w3.org/TR/css-cascade/#initial-values)<br>inline<br> |
| Applies to | (https://www.w3.org/TR/css-cascade/#applies-to)<br>[all elements](https://www.w3.org/TR/css-pseudo/#generated-content "Includes ::before and ::after pseudo-elements.")<br> |
| Inherited | (https://www.w3.org/TR/css-cascade/#inherited-property)<br>no<br> |
| Percentages | (https://www.w3.org/TR/css-values/#percentages)<br>n/a<br> |
| Computed value | (https://www.w3.org/TR/css-cascade/#computed)<br>a pair of keywords representing the <a href="#inner-display-type" id="ref-for-inner-display-type" data-link-type="dfn">inner</a> and <a href="#outer-display-type" id="ref-for-outer-display-type" data-link-type="dfn">outer</a> display types plus optional <a href="#valdef-display-list-item" id="ref-for-valdef-display-list-item" class="css" data-link-type="maybe">list-item</a> flag, or a <a href="#typedef-display-internal" id="ref-for-typedef-display-internal①" class="production css" data-link-type="type" title="Expands to: ruby-base | ruby-base-container | ruby-text | ruby-text-container | table-caption | table-cell | table-column | table-column-group | table-footer-group | table-header-group | table-row | table-row-group">&lt;display-internal&gt;</a> or <a href="#typedef-display-box" id="ref-for-typedef-display-box①" class="production css" data-link-type="type" title="Expands to: contents | none">&lt;display-box&gt;</a> keyword; see prose in a variety of specs for computation rules<br> |
| Canonical order | (https://www.w3.org/TR/cssom/#serializing-css-values)<br>per grammar<br> |
| Animation type | (https://www.w3.org/TR/web-animations/#animation-type)<br>not animatable<br>User agents are expected to support this property on all media, including non-visual ones. The <a href="#propdef-display" id="ref-for-propdef-display①①" class="property css" data-link-type="property">display</a> property defines an element’s <span id="display-type" class="dfn dfn-paneled" dfn-type="dfn" export="">display type</span>, which consists of the two basic qualities of how an element generates boxes:<br>- the <span id="inner-display-type" class="dfn dfn-paneled" dfn-type="dfn" export="" local-lt="inner">inner display type</span>, which defines (if it is a <a href="#replaced-element" id="ref-for-replaced-element" data-link-type="dfn">non-replaced element</a>) the kind of <a href="#formatting-context" id="ref-for-formatting-context" data-link-type="dfn">formatting context</a> it generates, dictating how its descendant boxes are laid out. (The inner display of a <span id="ref-for-replaced-element①">replaced element</span> is outside the scope of CSS.)<br>- the <span id="outer-display-type" class="dfn dfn-paneled" dfn-type="dfn" export="" local-lt="outer">outer display type</span>, which dictates how the <a href="#principal-box" id="ref-for-principal-box⑥" data-link-type="dfn">principal box</a> itself participates in <a href="#flow-layout" id="ref-for-flow-layout" data-link-type="dfn">flow layout</a>.<br><a href="#css-text-sequence" id="ref-for-css-text-sequence⑤" data-link-type="dfn">Text sequences</a> have no <a href="#display-type" id="ref-for-display-type①" data-link-type="dfn">display type</a>.<br>Some <a href="#propdef-display" id="ref-for-propdef-display①②" class="property css" data-link-type="property">display</a> values have additional side-effects: such as <a href="#valdef-display-list-item" id="ref-for-valdef-display-list-item①" class="css" data-link-type="maybe">list-item</a>, which also generates a <a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-marker" id="ref-for-selectordef-marker" class="css" data-link-type="maybe">::marker</a> pseudo-element, and <a href="#valdef-display-none" id="ref-for-valdef-display-none①" class="css" data-link-type="maybe">none</a>, which causes the element’s entire subtree to be left out of the box tree.<br><div class="advisement"><br>The <a href="#propdef-display" id="ref-for-propdef-display①③" class="property css" data-link-type="property">display</a> property has no effect on an element’s semantics: these are defined by the <a href="https://www.w3.org/TR/selectors-4/#document-language" id="ref-for-document-language" data-link-type="dfn">document language</a> and *are not affected by CSS*. Aside from the <a href="#valdef-display-none" id="ref-for-valdef-display-none②" class="css" data-link-type="maybe">none</a> value, which also affects the aural/speech output <a href="#biblio-css-speech-1" data-link-type="biblio" title="CSS Speech Module Level 1">[CSS-SPEECH-1]</a> and interactivity of an element and its descendants, the <span id="ref-for-propdef-display①④" class="property">display</span> property only affects visual layout: its purpose is to allow designers freedom to change the layout behavior of an element *without* affecting the underlying document semantics.<br></div><br> |
### <span class="secno">2.1. </span><span class="content"> Outer Display Roles for Flow Layout: the <a href="#valdef-display-block" id="ref-for-valdef-display-block①" class="css" data-link-type="maybe">block</a>, <a href="#valdef-display-inline" id="ref-for-valdef-display-inline①" class="css" data-link-type="maybe">inline</a>, and <a href="#valdef-display-run-in" id="ref-for-valdef-display-run-in②" class="css" data-link-type="maybe">run-in</a> keywords</span><a href="#outer-role" class="self-link"></a>

The <a href="#typedef-display-outside" id="ref-for-typedef-display-outside②" class="production css" data-link-type="type" title="Expands to: block | inline | run-in">&lt;display-outside&gt;</a> keywords specify the element’s <a href="#outer-display-type" id="ref-for-outer-display-type①" data-link-type="dfn">outer display type</a>, which is essentially its <a href="#principal-box" id="ref-for-principal-box⑦" data-link-type="dfn">principal box’s</a> role in <a href="#flow-layout" id="ref-for-flow-layout①" data-link-type="dfn">flow layout</a>. They are defined as follows:

<span id="valdef-display-block" class="dfn dfn-paneled css" dfn-for="display, &lt;display-outside&gt;" dfn-type="value" export="">block</span>  
The element generates a box that is <span id="block-level-box" class="dfn dfn-paneled" dfn-for="" dfn-type="dfn" export="" lt="block-level box">block-level</span> when placed in <a href="#flow-layout" id="ref-for-flow-layout②" data-link-type="dfn">flow layout</a>. <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>

<span id="valdef-display-inline" class="dfn dfn-paneled css" dfn-for="display, &lt;display-outside&gt;" dfn-type="value" export="">inline</span>  
The element generates a box that is <span id="inline-level-box" class="dfn dfn-paneled" dfn-for="" dfn-type="dfn" export="" lt="inline-level box">inline-level</span> when placed in <a href="#flow-layout" id="ref-for-flow-layout③" data-link-type="dfn">flow layout</a>. <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>

<span id="valdef-display-run-in" class="dfn dfn-paneled css" dfn-for="display, &lt;display-outside&gt;" dfn-type="value" export="">run-in</span>  
The element generates an <a href="#run-in" id="ref-for-run-in①" data-link-type="dfn">run-in box</a>, which is a type of <a href="#inline-level-box" id="ref-for-inline-level-box" data-link-type="dfn">inline-level box</a> with special behavior that attempts to merge it into a subsequent block container. See [§ 5 Run-In Layout](#run-in-layout) for details.

<span class="marker">Note:</span> <a href="#outer-display-type" id="ref-for-outer-display-type②" data-link-type="dfn">Outer display types</a> do affect <a href="#replaced-element" id="ref-for-replaced-element②" data-link-type="dfn">replaced elements</a>.

If a <a href="#typedef-display-outside" id="ref-for-typedef-display-outside③" class="production css" data-link-type="type" title="Expands to: block | inline | run-in">&lt;display-outside&gt;</a> value is specified but <a href="#typedef-display-inside" id="ref-for-typedef-display-inside①" class="production css" data-link-type="type" title="Expands to: flex | flow | flow-root | grid | ruby | table">&lt;display-inside&gt;</a> is omitted, the element’s <a href="#inner-display-type" id="ref-for-inner-display-type①" data-link-type="dfn">inner display type</a> defaults to <a href="#valdef-display-flow" id="ref-for-valdef-display-flow" class="css" data-link-type="maybe">flow</a>.

### <span class="secno">2.2. </span><span class="content"> Inner Display Layout Models: the <a href="#valdef-display-flow" id="ref-for-valdef-display-flow①" class="css" data-link-type="maybe">flow</a>, <a href="#valdef-display-flow-root" id="ref-for-valdef-display-flow-root①" class="css" data-link-type="maybe">flow-root</a>, <a href="#valdef-display-table" id="ref-for-valdef-display-table①" class="css" data-link-type="maybe">table</a>, <a href="#valdef-display-flex" id="ref-for-valdef-display-flex①" class="css" data-link-type="maybe">flex</a>, <a href="#valdef-display-grid" id="ref-for-valdef-display-grid①" class="css" data-link-type="maybe">grid</a>, and <a href="#valdef-display-ruby" id="ref-for-valdef-display-ruby①" class="css" data-link-type="maybe">ruby</a> keywords</span><a href="#inner-model" class="self-link"></a>

The <a href="#typedef-display-inside" id="ref-for-typedef-display-inside②" class="production css" data-link-type="type" title="Expands to: flex | flow | flow-root | grid | ruby | table">&lt;display-inside&gt;</a> keywords specify the element’s <a href="#inner-display-type" id="ref-for-inner-display-type②" data-link-type="dfn">inner display type</a>, which defines the type of formatting context that lays out its contents (assuming it is a <a href="#replaced-element" id="ref-for-replaced-element③" data-link-type="dfn">non-replaced element</a>). They are defined as follows:

<span id="valdef-display-flow" class="dfn dfn-paneled css" dfn-for="display, &lt;display-inside&gt;" dfn-type="value" export="">flow</span>  
The element lays out its contents using <span id="flow-layout" class="dfn dfn-paneled" dfn-for="" dfn-type="dfn" export="">flow layout</span> ([block-and-inline layout](https://www.w3.org/TR/CSS2/visuren.html)).

If its <a href="#outer-display-type" id="ref-for-outer-display-type③" data-link-type="dfn">outer display type</a> is <a href="#valdef-display-inline" id="ref-for-valdef-display-inline②" class="css" data-link-type="maybe">inline</a> or <a href="#valdef-display-run-in" id="ref-for-valdef-display-run-in③" class="css" data-link-type="maybe">run-in</a>, and it is participating in a <a href="#block-formatting-context" id="ref-for-block-formatting-context①" data-link-type="dfn">block</a> or <a href="#inline-formatting-context" id="ref-for-inline-formatting-context" data-link-type="dfn">inline</a> formatting context, then it generates an <a href="#inline-box" id="ref-for-inline-box④" data-link-type="dfn">inline box</a>.

Otherwise it generates a <a href="#block-container" id="ref-for-block-container③" data-link-type="dfn">block container</a> box.

Depending on the value of other properties (such as <a href="https://www.w3.org/TR/css-position-3/#propdef-position" id="ref-for-propdef-position" class="property css" data-link-type="property">position</a>, <a href="https://drafts.csswg.org/css2/#propdef-float" id="ref-for-propdef-float" class="property css" data-link-type="property">float</a>, or <a href="https://drafts.csswg.org/css2/#propdef-overflow" id="ref-for-propdef-overflow" class="property css" data-link-type="property">overflow</a>) and whether it is itself participating in a block or inline <a href="#formatting-context" id="ref-for-formatting-context①" data-link-type="dfn">formatting context</a>, it either establishes a new <a href="#block-formatting-context" id="ref-for-block-formatting-context②" data-link-type="dfn">block formatting context</a> for its contents or integrates its contents into its parent <span id="ref-for-formatting-context②">formatting context</span>. See [CSS2.1 Chapter 9](https://www.w3.org/TR/CSS2/visuren.html). <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a> A <a href="#block-container" id="ref-for-block-container④" data-link-type="dfn">block container</a> that establishes a new <span id="ref-for-block-formatting-context③">block formatting context</span> is considered to have a used <a href="#inner-display-type" id="ref-for-inner-display-type③" data-link-type="dfn">inner display type</a> of <a href="#valdef-display-flow-root" id="ref-for-valdef-display-flow-root②" class="css" data-link-type="maybe">flow-root</a>.

<span id="valdef-display-flow-root" class="dfn dfn-paneled css" dfn-for="display, &lt;display-inside&gt;" dfn-type="value" export="">flow-root</span>  
The element generates a <a href="#block-container" id="ref-for-block-container⑤" data-link-type="dfn">block container</a> box, and lays out its contents using <a href="#flow-layout" id="ref-for-flow-layout④" data-link-type="dfn">flow layout</a>. It always establishes a new <a href="#block-formatting-context" id="ref-for-block-formatting-context④" data-link-type="dfn">block formatting context</a> for its contents. <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>

<span id="valdef-display-table" class="dfn dfn-paneled css" dfn-for="display, &lt;display-inside&gt;" dfn-type="value" export="">table</span>  
The element generates a principal <a href="https://www.w3.org/TR/css-tables-3/#table-wrapper-box" id="ref-for-table-wrapper-box③" data-link-type="dfn">table wrapper box</a> that establishes a <a href="#block-formatting-context" id="ref-for-block-formatting-context⑤" data-link-type="dfn">block formatting context</a>, and which contains an additionally-generated <a href="https://www.w3.org/TR/css-tables-3/#table-grid-box" id="ref-for-table-grid-box③" data-link-type="dfn">table grid box</a> that establishes a <span link-type="dfn">table formatting context</span>. <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>

<span id="valdef-display-flex" class="dfn dfn-paneled css" dfn-for="display, &lt;display-inside&gt;" dfn-type="value" export="">flex</span>  
The element generates a principal <a href="https://www.w3.org/TR/css-flexbox-1/#flex-container" id="ref-for-flex-container②" data-link-type="dfn">flex container</a> box and establishes a <a href="https://www.w3.org/TR/css-flexbox-1/#flex-formatting-context" id="ref-for-flex-formatting-context" data-link-type="dfn">flex formatting context</a>. <a href="#biblio-css-flexbox-1" data-link-type="biblio" title="CSS Flexible Box Layout Module Level 1">[CSS-FLEXBOX-1]</a>

<span id="valdef-display-grid" class="dfn dfn-paneled css" dfn-for="display, &lt;display-inside&gt;" dfn-type="value" export="">grid</span>  
The element generates a principal <a href="https://www.w3.org/TR/css-grid-2/#grid-container" id="ref-for-grid-container②" data-link-type="dfn">grid container</a> box, and establishes a <a href="https://www.w3.org/TR/css-grid-2/#grid-formatting-context" id="ref-for-grid-formatting-context" data-link-type="dfn">grid formatting context</a>. <a href="#biblio-css-grid-1" data-link-type="biblio" title="CSS Grid Layout Module Level 1">[CSS-GRID-1]</a>

(Grids using <a href="https://www.w3.org/TR/css-grid-2/#valdef-grid-template-rows-subgrid" id="ref-for-valdef-grid-template-rows-subgrid" class="css" data-link-type="maybe">subgrid</a> might not generate a new <a href="https://www.w3.org/TR/css-grid-2/#grid-formatting-context" id="ref-for-grid-formatting-context①" data-link-type="dfn">grid formatting context</a>; see <a href="#biblio-css-grid-2" data-link-type="biblio" title="CSS Grid Layout Module Level 2">[CSS-GRID-2]</a> for details.)

<span id="valdef-display-ruby" class="dfn dfn-paneled css" dfn-for="display, &lt;display-inside&gt;" dfn-type="value" export="">ruby</span>  
The element generates a <a href="https://www.w3.org/TR/css-ruby-1/#ruby-container" id="ref-for-ruby-container②" data-link-type="dfn">ruby container</a> box and establishes a <a href="https://www.w3.org/TR/css-ruby-1/#ruby-formatting-context" id="ref-for-ruby-formatting-context" data-link-type="dfn">ruby formatting context</a> in addition to integrating its base-level contents into its parent <a href="#formatting-context" id="ref-for-formatting-context③" data-link-type="dfn">formatting context</a> (if it is inline) or generating a wrapper box of the appropriate <a href="#outer-display-type" id="ref-for-outer-display-type④" data-link-type="dfn">outer display type</a> (if it is not). <a href="#biblio-css-ruby-1" data-link-type="biblio" title="CSS Ruby Annotation Layout Module Level 1">[CSS-RUBY-1]</a>

If a <a href="#typedef-display-inside" id="ref-for-typedef-display-inside③" class="production css" data-link-type="type" title="Expands to: flex | flow | flow-root | grid | ruby | table">&lt;display-inside&gt;</a> value is specified but <a href="#typedef-display-outside" id="ref-for-typedef-display-outside④" class="production css" data-link-type="type" title="Expands to: block | inline | run-in">&lt;display-outside&gt;</a> is omitted, the element’s <a href="#outer-display-type" id="ref-for-outer-display-type⑤" data-link-type="dfn">outer display type</a> defaults to <a href="#valdef-display-block" id="ref-for-valdef-display-block②" class="css" data-link-type="maybe">block</a>—except for <a href="#valdef-display-ruby" id="ref-for-valdef-display-ruby②" class="css" data-link-type="maybe">ruby</a>, which defaults to <a href="#valdef-display-inline" id="ref-for-valdef-display-inline③" class="css" data-link-type="maybe">inline</a>.

### <span class="secno">2.3. </span><span class="content"> Generating Marker Boxes: the <a href="#valdef-display-list-item" id="ref-for-valdef-display-list-item③" class="css" data-link-type="maybe">list-item</a> keyword</span><a href="#list-items" class="self-link"></a>

The <span id="valdef-display-list-item" class="dfn dfn-paneled css" dfn-for="display, &lt;display-listitem&gt;" dfn-type="value" export="">list-item</span> keyword causes the element to generate a <a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-marker" id="ref-for-selectordef-marker①" class="css" data-link-type="maybe">::marker</a> pseudo-element <a href="#biblio-css-pseudo-4" data-link-type="biblio" title="CSS Pseudo-Elements Module Level 4">[CSS-PSEUDO-4]</a> with the content specified by its <a href="https://drafts.csswg.org/css2/#propdef-list-style" id="ref-for-propdef-list-style" class="property css" data-link-type="property">list-style</a> properties ([CSS 2.1§12.5 Lists](https://www.w3.org/TR/CSS2/generate.html#lists)) <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a> together with a principal box of the specified type for its own contents.

If no <a href="#inner-display-type" id="ref-for-inner-display-type④" data-link-type="dfn">inner display type</a> value is specified, the principal box’s <span id="ref-for-inner-display-type⑤">inner display type</span> defaults to <a href="#valdef-display-flow" id="ref-for-valdef-display-flow②" class="css" data-link-type="maybe">flow</a>. If no <a href="#outer-display-type" id="ref-for-outer-display-type⑥" data-link-type="dfn">outer display type</a> value is specified, the principal box’s <span id="ref-for-outer-display-type⑦">outer display type</span> defaults to <a href="#valdef-display-block" id="ref-for-valdef-display-block③" class="css" data-link-type="maybe">block</a>.

<span class="marker">Note:</span> In this level, as restricted in the grammar, list-items are limited to the <a href="#flow-layout" id="ref-for-flow-layout⑤" data-link-type="dfn">Flow Layout</a> display types (<a href="#valdef-display-block" id="ref-for-valdef-display-block④" class="css" data-link-type="maybe">block</a>/<a href="#valdef-display-inline" id="ref-for-valdef-display-inline④" class="css" data-link-type="maybe">inline</a>/<a href="#valdef-display-run-in" id="ref-for-valdef-display-run-in④" class="css" data-link-type="maybe">run-in</a> with <a href="#valdef-display-flow" id="ref-for-valdef-display-flow③" class="css" data-link-type="maybe">flow</a>/<a href="#valdef-display-flow-root" id="ref-for-valdef-display-flow-root③" class="css" data-link-type="maybe">flow-root</a> inner types). This restriction may be relaxed in a future level of this module.

### <span class="secno">2.4. </span><span class="content"> Layout-Internal Display Types: the <span class="css">table-*</span> and <span class="css">ruby-*</span> keywords</span><a href="#layout-specific-display" class="self-link"></a>

Some layout models, such as <a href="#valdef-display-table" id="ref-for-valdef-display-table②" class="css" data-link-type="maybe">table</a> and <a href="#valdef-display-ruby" id="ref-for-valdef-display-ruby③" class="css" data-link-type="maybe">ruby</a>, have a complex internal structure, with several different roles that their children and descendants can fill. This section defines those “<span id="layout-internal" class="dfn dfn-paneled" dfn-type="dfn" export="">layout-internal</span>” <a href="#propdef-display" id="ref-for-propdef-display②⓪" class="property css" data-link-type="property">display</a> values, which only have meaning within that particular layout mode.

Unless otherwise specified, both the <a href="#inner-display-type" id="ref-for-inner-display-type⑥" data-link-type="dfn">inner display type</a> and the <a href="#outer-display-type" id="ref-for-outer-display-type⑧" data-link-type="dfn">outer display type</a> of elements using these <a href="#propdef-display" id="ref-for-propdef-display②①" class="property css" data-link-type="property">display</a> values are set to the given keyword.

When the <a href="#propdef-display" id="ref-for-propdef-display②②" class="property css" data-link-type="property">display</a> property of a <a href="#replaced-element" id="ref-for-replaced-element④" data-link-type="dfn">replaced element</a> computes to one of the <a href="#layout-internal" id="ref-for-layout-internal" data-link-type="dfn">layout-internal</a> values, it is handled as having a used value of <a href="#valdef-display-inline" id="ref-for-valdef-display-inline⑤" class="css" data-link-type="maybe">inline</a>. White space collapsing and anonymous box generation must happen around those replaced elements based on that <span id="ref-for-valdef-display-inline⑥" class="css">inline</span> value, as if they never had a <span id="ref-for-layout-internal①">layout-internal</span> display value applied to them.

**Authors should not assign a <a href="#layout-internal" id="ref-for-layout-internal②" data-link-type="dfn">layout-internal</a> display value to <a href="#replaced-element" id="ref-for-replaced-element⑤" data-link-type="dfn">replaced elements</a>.**

The <a href="#typedef-display-internal" id="ref-for-typedef-display-internal③" class="production css" data-link-type="type" title="Expands to: ruby-base | ruby-base-container | ruby-text | ruby-text-container | table-caption | table-cell | table-column | table-column-group | table-footer-group | table-header-group | table-row | table-row-group">&lt;display-internal&gt;</a> keywords are defined as follows:

<span id="valdef-display-table-row-group" class="dfn css" dfn-for="display, &lt;display-internal&gt;" dfn-type="value" export="">table-row-group<a href="#valdef-display-table-row-group" class="self-link"></a></span>, <span id="valdef-display-table-header-group" class="dfn css" dfn-for="display, &lt;display-internal&gt;" dfn-type="value" export="">table-header-group<a href="#valdef-display-table-header-group" class="self-link"></a></span>, <span id="valdef-display-table-footer-group" class="dfn css" dfn-for="display, &lt;display-internal&gt;" dfn-type="value" export="">table-footer-group<a href="#valdef-display-table-footer-group" class="self-link"></a></span>, <span id="valdef-display-table-row" class="dfn dfn-paneled css" dfn-for="display, &lt;display-internal&gt;" dfn-type="value" export="">table-row</span>, <span id="valdef-display-table-cell" class="dfn dfn-paneled css" dfn-for="display, &lt;display-internal&gt;" dfn-type="value" export="">table-cell</span>, <span id="valdef-display-table-column-group" class="dfn css" dfn-for="display, &lt;display-internal&gt;" dfn-type="value" export="">table-column-group<a href="#valdef-display-table-column-group" class="self-link"></a></span>, <span id="valdef-display-table-column" class="dfn css" dfn-for="display, &lt;display-internal&gt;" dfn-type="value" export="">table-column<a href="#valdef-display-table-column" class="self-link"></a></span>  
The element is an <span id="internal-table-element" class="dfn dfn-paneled" dfn-for="" dfn-type="dfn" export="">internal table element</span>. It generates the appropriate <span id="internal-table-box" class="dfn" dfn-for="" dfn-type="dfn" export="">internal table box<a href="#internal-table-box" class="self-link"></a></span> which participates in a <span link-type="dfn">table formatting context</span>. See [CSS2§17.2](https://www.w3.org/TR/CSS2/tables.html#table-display) <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>.

<a href="#valdef-display-table-cell" id="ref-for-valdef-display-table-cell" class="css" data-link-type="maybe">table-cell</a> boxes have a <a href="#valdef-display-flow-root" id="ref-for-valdef-display-flow-root④" class="css" data-link-type="maybe">flow-root</a> <a href="#inner-display-type" id="ref-for-inner-display-type⑦" data-link-type="dfn">inner display type</a>.

<span id="valdef-display-table-caption" class="dfn dfn-paneled css" dfn-for="display, &lt;display-internal&gt;" dfn-type="value" export="">table-caption</span>  
The element generates a <span id="table-caption-box" class="dfn" dfn-for="" dfn-type="dfn" export="">table caption box<a href="#table-caption-box" class="self-link"></a></span>, which is a <a href="#block-box" id="ref-for-block-box④" data-link-type="dfn">block box</a> with special behavior with respect to table and table wrapper boxes. See [CSS2§17.2](https://www.w3.org/TR/CSS2/tables.html#table-display) <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>.

<a href="#valdef-display-table-caption" id="ref-for-valdef-display-table-caption" class="css" data-link-type="maybe">table-caption</a> boxes have a <a href="#valdef-display-flow-root" id="ref-for-valdef-display-flow-root⑤" class="css" data-link-type="maybe">flow-root</a> <a href="#inner-display-type" id="ref-for-inner-display-type⑧" data-link-type="dfn">inner display type</a>.

<span id="valdef-display-ruby-base" class="dfn dfn-paneled css" dfn-for="display, &lt;display-internal&gt;" dfn-type="value" export="">ruby-base</span>, <span id="valdef-display-ruby-text" class="dfn dfn-paneled css" dfn-for="display, &lt;display-internal&gt;" dfn-type="value" export="">ruby-text</span>, <span id="valdef-display-ruby-base-container" class="dfn css" dfn-for="display, &lt;display-internal&gt;" dfn-type="value" export="">ruby-base-container<a href="#valdef-display-ruby-base-container" class="self-link"></a></span>, <span id="valdef-display-ruby-text-container" class="dfn css" dfn-for="display, &lt;display-internal&gt;" dfn-type="value" export="">ruby-text-container<a href="#valdef-display-ruby-text-container" class="self-link"></a></span>  
The element is an <span id="internal-ruby-element" class="dfn" dfn-for="" dfn-type="dfn" export="">internal ruby element<a href="#internal-ruby-element" class="self-link"></a></span>. It generates the appropriate <span id="internal-ruby-box" class="dfn" dfn-for="" dfn-type="dfn" export="">internal ruby box<a href="#internal-ruby-box" class="self-link"></a></span> which participates in a <a href="https://www.w3.org/TR/css-ruby-1/#ruby-formatting-context" id="ref-for-ruby-formatting-context①" data-link-type="dfn">ruby formatting context</a>. <a href="#biblio-css-ruby-1" data-link-type="biblio" title="CSS Ruby Annotation Layout Module Level 1">[CSS-RUBY-1]</a>

<a href="#valdef-display-ruby-base" id="ref-for-valdef-display-ruby-base" class="css" data-link-type="maybe">ruby-base</a> and <a href="#valdef-display-ruby-text" id="ref-for-valdef-display-ruby-text" class="css" data-link-type="maybe">ruby-text</a> have a <a href="#valdef-display-flow" id="ref-for-valdef-display-flow④" class="css" data-link-type="maybe">flow</a> <a href="#inner-display-type" id="ref-for-inner-display-type⑨" data-link-type="dfn">inner display type</a>.

Boxes with layout-specific display types generate anonymous wrapper boxes around themselves when placed in an incompatible parent, as defined by their respective specifications.

<div id="example-d11b97c3" class="example">

<a href="#example-d11b97c3" class="self-link"></a> For example, Table Layout requires that a <a href="#valdef-display-table-cell" id="ref-for-valdef-display-table-cell①" class="css" data-link-type="maybe">table-cell</a> box must have a <a href="#valdef-display-table-row" id="ref-for-valdef-display-table-row" class="css" data-link-type="maybe">table-row</a> parent box.

If it is misparented, like so:

``` lang-markup
<div style="display:block;">
  <div style="display:table-cell">...</div>
</div>
```

It will generate wrapper boxes around itself, producing a structure like:

    block box
    └anonymous table box
     └anonymous table-row-group box
      └anonymous table-row box
       └table-cell box

Even if the parent is another <a href="#internal-table-element" id="ref-for-internal-table-element" data-link-type="dfn">internal table element</a>, if it’s not the *correct* one, wrapper boxes will be generated. For example, in the following markup:

``` lang-markup
<div style="display:table;">
  <div style="display:table-row">
    <div style="display:table-cell">...</div>
  </div>
</div>
```

Anonymous wrapper box generation will produce:

    table box
    └anonymous table-row-group box
     └table-row box
      └table-cell box

This "fix-up" ensures that table layout has a predictable structure to operate on.

</div>

### <span class="secno">2.5. </span><span class="content"> Box Generation: the <a href="#valdef-display-none" id="ref-for-valdef-display-none④" class="css" data-link-type="maybe">none</a> and <a href="#valdef-display-contents" id="ref-for-valdef-display-contents②" class="css" data-link-type="maybe">contents</a> keywords</span><a href="#box-generation" class="self-link"></a>

While <a href="#propdef-display" id="ref-for-propdef-display②③" class="property css" data-link-type="property">display</a> can control the *types* of boxes an element will generate, it can also control whether an element will generate any boxes at all.

The <a href="#typedef-display-box" id="ref-for-typedef-display-box②" class="production css" data-link-type="type" title="Expands to: contents | none">&lt;display-box&gt;</a> keywords are defined as follows:

<span id="valdef-display-contents" class="dfn dfn-paneled css" dfn-for="display, &lt;display-box&gt;" dfn-type="value" export="">contents</span>  
The element itself does not generate any boxes, but its children and pseudo-elements still generate <a href="#box" id="ref-for-box⑨" data-link-type="dfn">boxes</a> and <a href="#css-text-sequence" id="ref-for-css-text-sequence⑥" data-link-type="dfn">text sequences</a> as normal. For the purposes of box generation and layout, the element must be treated as if it had been replaced in the <a href="#element-tree" id="ref-for-element-tree①" data-link-type="dfn">element tree</a> by its contents (including both its source-document children and its pseudo-elements, such as <a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-before" id="ref-for-selectordef-before" class="css" data-link-type="maybe">::before</a> and <a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-after" id="ref-for-selectordef-after" class="css" data-link-type="maybe">::after</a> pseudo-elements, which are generated before/after the element’s children as normal).

<span class="marker">Note:</span> As only the box tree is affected, any semantics based on the document tree, such as selector-matching, event handling, and property <a href="https://www.w3.org/TR/css-cascade-5/#inheritance" id="ref-for-inheritance" data-link-type="dfn">inheritance</a>, are not affected. **As of writing, however, [this is not implemented correctly in major browsers](https://github.com/w3c/csswg-drafts/issues/3040), so using this feature on the Web must be done with care as it can prevent accessibility tools from accessing the element’s semantics.**

This value computes to <a href="#propdef-display" id="ref-for-propdef-display②④" class="css" data-link-type="propdesc">display: none</a> on replaced elements and other elements whose rendering is not entirely controlled by CSS; see [Appendix B: Effects of display: contents on Unusual Elements](#unbox) for details.

<span class="marker">Note:</span> Replaced elements and form controls are treated specially because removing only the element’s own generating box is a more-or-less undefined operation. As this behavior may be refined if use cases (and more precise rendering models) develop, authors should use <a href="#propdef-display" id="ref-for-propdef-display②⑤" class="css" data-link-type="propdesc">display: none</a> rather than <span id="ref-for-propdef-display②⑥" class="css">display: contents</span> on such elements for forward-compatibility.

<span id="valdef-display-none" class="dfn dfn-paneled css" dfn-for="display, &lt;display-box&gt;" dfn-type="value" export="">none</span>  
The <a href="#elements" id="ref-for-elements⑥" data-link-type="dfn">element</a> and its descendants generate no <a href="#box" id="ref-for-box①⓪" data-link-type="dfn">boxes</a> or <a href="#css-text-sequence" id="ref-for-css-text-sequence⑦" data-link-type="dfn">text sequences</a>.

Similarly, if a <a href="#text-nodes" id="ref-for-text-nodes⑤" data-link-type="dfn">text node</a> is defined to behave as <a href="#propdef-display" id="ref-for-propdef-display②⑦" class="css" data-link-type="propdesc">display: none</a>, it generates no <a href="#css-text-sequence" id="ref-for-css-text-sequence⑧" data-link-type="dfn">text sequences</a>.

Elements with either of these values do not have <a href="#inner-display-type" id="ref-for-inner-display-type①⓪" data-link-type="dfn">inner</a> or <a href="#outer-display-type" id="ref-for-outer-display-type⑨" data-link-type="dfn">outer display types</a>, because they don’t generate any boxes at all.

<span class="marker">Note:</span> As these values cause affected elements to not generate a box, anonymous box generation rules will ignore the elided elements entirely, as if they did not exist in the box tree.

Markup-based relationships, however, are not affected by these values, as they are solely rendering-time effects. <span class="non-normative"> For example, although they may affect which table cell *appears* in a column, they do not affect which table cell is associated with a particular column *element*. Similarly, they cannot affect which HTML <a href="https://html.spec.whatwg.org/multipage/interactive-elements.html#the-summary-element" id="ref-for-the-summary-element" data-link-type="element"><code>summary</code></a> element is associated with a particular table or whether a <a href="https://html.spec.whatwg.org/multipage/form-elements.html#the-legend-element" id="ref-for-the-legend-element" data-link-type="element"><code>legend</code></a> is considered to be labelling the contents of a particular <a href="https://html.spec.whatwg.org/multipage/form-elements.html#the-fieldset-element" id="ref-for-the-fieldset-element" data-link-type="element"><code>fieldset</code></a>. </span>

### <span class="secno">2.6. </span><span class="content"> Precomposed Inline-level Display Values</span><a href="#legacy-display" class="self-link"></a>

CSS level 2 used a single-keyword syntax for <a href="#propdef-display" id="ref-for-propdef-display②⑧" class="property css" data-link-type="property">display</a>, requiring separate keywords for block-level and inline-level variants of the same layout mode. These <a href="#typedef-display-legacy" id="ref-for-typedef-display-legacy①" class="production css" data-link-type="type" title="Expands to: inline-block | inline-flex | inline-grid | inline-table">&lt;display-legacy&gt;</a> keywords map as follows:

<span id="valdef-display-inline-block" class="dfn dfn-paneled css" dfn-for="display, &lt;display-legacy&gt;" dfn-type="value" export="">inline-block</span>  
Computes to <span class="css">inline flow-root</span>.

<span id="valdef-display-inline-table" class="dfn dfn-paneled css" dfn-for="display, &lt;display-legacy&gt;" dfn-type="value" export="">inline-table</span>  
Computes to <span class="css">inline table</span>.

<span id="valdef-display-inline-flex" class="dfn dfn-paneled css" dfn-for="display, &lt;display-legacy&gt;" dfn-type="value" export="">inline-flex</span>  
Computes to <span class="css">inline flex</span>.

<span id="valdef-display-inline-grid" class="dfn dfn-paneled css" dfn-for="display, &lt;display-legacy&gt;" dfn-type="value" export="">inline-grid</span>  
Computes to <span class="css">inline grid</span>.

<span class="marker">Note:</span> Although these keywords and their equivalents compute to the same value, their <a href="https://www.w3.org/TR/css-cascade-5/#specified-value" id="ref-for-specified-value" data-link-type="dfn">specified values</a> remain distinct.

<span class="marker">Note:</span> The <a href="https://www.w3.org/TR/cssom-1/#dom-window-getcomputedstyle" id="ref-for-dom-window-getcomputedstyle①" data-link-type="idl"><code class="idl">getComputedStyle()</code></a> serialization rules will always output these precomposed keywords rather than the equivalent two-keyword pairs due to the [shortest, most backwards-compatible serialization principle](https://www.w3.org/TR/cssom-1/#serializing-css-values).

### <span class="secno">2.7. </span><span class="content"> Automatic Box Type Transformations</span><a href="#transformations" class="self-link"></a>

Some layout effects require <span id="blockify" class="dfn dfn-paneled" dfn-type="dfn" export="" lt="blockify|blockification">blockification</span> or <span id="inlinify" class="dfn dfn-paneled" dfn-type="dfn" export="" lt="inlinify|inlinification">inlinification</span> of the box type, which sets the box’s <a href="https://www.w3.org/TR/css-cascade-5/#computed-value" id="ref-for-computed-value①" data-link-type="dfn">computed</a> <a href="#outer-display-type" id="ref-for-outer-display-type①⓪" data-link-type="dfn">outer display type</a> to <a href="#valdef-display-block" id="ref-for-valdef-display-block⑤" class="css" data-link-type="maybe">block</a> or <a href="#valdef-display-inline" id="ref-for-valdef-display-inline⑦" class="css" data-link-type="maybe">inline</a> (respectively). (This has no effect on <a href="#display-type" id="ref-for-display-type②" data-link-type="dfn">display types</a> that generate no box at all, such as <a href="#valdef-display-none" id="ref-for-valdef-display-none⑤" class="css" data-link-type="maybe">none</a> or <a href="#valdef-display-contents" id="ref-for-valdef-display-contents③" class="css" data-link-type="maybe">contents</a>.) Additionally:

- If a <a href="#block-box" id="ref-for-block-box⑤" data-link-type="dfn">block box</a> (<span class="css">block flow</span>) is <a href="#inlinify" id="ref-for-inlinify" data-link-type="dfn">inlinified</a>, its <a href="#inner-display-type" id="ref-for-inner-display-type①①" data-link-type="dfn">inner display type</a> is set to <a href="#valdef-display-flow-root" id="ref-for-valdef-display-flow-root⑥" class="css" data-link-type="maybe">flow-root</a> so that it remains a block container.

- If an <a href="#inline-box" id="ref-for-inline-box⑤" data-link-type="dfn">inline box</a> (<span class="css">inline flow</span>) is <a href="#inlinify" id="ref-for-inlinify①" data-link-type="dfn">inlinified</a>, it recursively <span id="ref-for-inlinify②">inlinifies</span> all of its in-flow children, so that no block-level descendants break up the inline formatting context in which it participates.

- For legacy reasons, if an <a href="#inline-block" id="ref-for-inline-block" data-link-type="dfn">inline block box</a> (<span class="css">inline flow-root</span>) is <a href="#blockify" id="ref-for-blockify" data-link-type="dfn">blockified</a>, it becomes a <a href="#valdef-display-block" id="ref-for-valdef-display-block⑥" class="css" data-link-type="maybe">block</a> box (losing its <a href="#valdef-display-flow-root" id="ref-for-valdef-display-flow-root⑦" class="css" data-link-type="maybe">flow-root</a> nature). For consistency, a <span class="css">run-in flow-root</span> box also <span id="ref-for-blockify①">blockifies</span> to a <span id="ref-for-valdef-display-block⑦" class="css">block</span> box.

- If a <a href="#layout-internal" id="ref-for-layout-internal③" data-link-type="dfn">layout-internal</a> box is <a href="#blockify" id="ref-for-blockify②" data-link-type="dfn">blockified</a>, its <a href="#inner-display-type" id="ref-for-inner-display-type①②" data-link-type="dfn">inner display type</a> converts to <a href="#valdef-display-flow" id="ref-for-valdef-display-flow⑤" class="css" data-link-type="maybe">flow</a> so that it becomes a <a href="#block-container" id="ref-for-block-container⑥" data-link-type="dfn">block container</a>. <a href="#inlinify" id="ref-for-inlinify③" data-link-type="dfn">Inlinification</a> has no effect on <span id="ref-for-layout-internal④">layout-internal</span> boxes. (However, placement in such an inline context will typically cause them to be wrapped in an appropriately-typed anonymous inline-level box.)

<span class="marker">Note:</span> There are two methods used to fix up box types when a box is mismatched to its context. One is transformation of the <a href="https://www.w3.org/TR/css-cascade-5/#computed-value" id="ref-for-computed-value②" data-link-type="dfn">computed value</a> of <a href="#propdef-display" id="ref-for-propdef-display②⑨" class="property css" data-link-type="property">display</a>, such as <a href="#blockify" id="ref-for-blockify③" data-link-type="dfn">blockification</a> and <a href="#inlinify" id="ref-for-inlinify④" data-link-type="dfn">inlinification</a> described here. The other, taking place during [box tree construction](#intro) (after computed values have been determined), is the creation of intermediary anonymous boxes, such as happens in [tables](https://www.w3.org/TR/CSS2/tables.html#anonymous-boxes), [ruby](https://www.w3.org/TR/css-ruby-1/#box-fixup), and [flow](https://www.w3.org/TR/CSS21/visuren.html#box-gen) layout.

<div id="example-26cc3423" class="example">

<a href="#example-26cc3423" class="self-link"></a> Some examples of computed-value fixup include:

- Absolute positioning or floating an element <a href="#blockify" id="ref-for-blockify④" data-link-type="dfn">blockifies</a> the box’s display type. <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>
- Containment in a <a href="https://www.w3.org/TR/css-ruby-1/#ruby-container" id="ref-for-ruby-container③" data-link-type="dfn">ruby container</a> <a href="#inlinify" id="ref-for-inlinify⑤" data-link-type="dfn">inlinifies</a> the box’s display type, as described in <a href="#biblio-css-ruby-1" data-link-type="biblio" title="CSS Ruby Annotation Layout Module Level 1">[CSS-RUBY-1]</a>.
- A parent with a <a href="#valdef-display-grid" id="ref-for-valdef-display-grid②" class="css" data-link-type="maybe">grid</a> or <a href="#valdef-display-flex" id="ref-for-valdef-display-flex②" class="css" data-link-type="maybe">flex</a> <a href="#propdef-display" id="ref-for-propdef-display③⓪" class="property css" data-link-type="property">display</a> value <a href="#blockify" id="ref-for-blockify⑤" data-link-type="dfn">blockifies</a> the box’s display type. <a href="#biblio-css-grid-1" data-link-type="biblio" title="CSS Grid Layout Module Level 1">[CSS-GRID-1]</a> <a href="#biblio-css-flexbox-1" data-link-type="biblio" title="CSS Flexible Box Layout Module Level 1">[CSS-FLEXBOX-1]</a>

</div>

### <span class="secno">2.8. </span><span class="content"> The Root Element’s Principal Box</span><a href="#root" class="self-link"></a>

The <a href="#root-element" id="ref-for-root-element" data-link-type="dfn">root element</a>’s display type is always <a href="#blockify" id="ref-for-blockify⑥" data-link-type="dfn">blockified</a>, and its <a href="#principal-box" id="ref-for-principal-box⑧" data-link-type="dfn">principal box</a> always establishes an <a href="#independent-formatting-context" id="ref-for-independent-formatting-context" data-link-type="dfn">independent formatting context</a>. This box’s <a href="#containing-block" id="ref-for-containing-block" data-link-type="dfn">containing block</a> is the <a href="#initial-containing-block" id="ref-for-initial-containing-block" data-link-type="dfn">initial containing block</a>.

Additionally, a <a href="#propdef-display" id="ref-for-propdef-display③①" class="property css" data-link-type="property">display</a> of <a href="#valdef-display-contents" id="ref-for-valdef-display-contents④" class="css" data-link-type="maybe">contents</a> computes to <a href="#valdef-display-block" id="ref-for-valdef-display-block⑧" class="css" data-link-type="maybe">block</a> on the root element.

## <span class="secno">3. </span><span class="content"> Display Order: the <a href="#propdef-order" id="ref-for-propdef-order" class="property css" data-link-type="property">order</a> property</span><a href="#order-property" class="self-link"></a>


| Field | Value |
|---|---|
| Name | <span id="propdef-order" class="dfn dfn-paneled css" dfn-type="property" export="">order</span><br> |
| Value | (https://www.w3.org/TR/css-values/#value-defs)<br><a href="https://www.w3.org/TR/css-values-4/#integer-value" id="ref-for-integer-value" class="production css" data-link-type="type">&lt;integer&gt;</a><br> |
| Initial | (https://www.w3.org/TR/css-cascade/#initial-values)<br>0<br> |
| Applies to | (https://www.w3.org/TR/css-cascade/#applies-to)<br><a href="https://www.w3.org/TR/css-flexbox-1/#flex-item" id="ref-for-flex-item" data-link-type="dfn">flex items</a> and <a href="https://www.w3.org/TR/css-grid-2/#grid-item" id="ref-for-grid-item" data-link-type="dfn">grid items</a><br> |
| Inherited | (https://www.w3.org/TR/css-cascade/#inherited-property)<br>no<br> |
| Percentages | (https://www.w3.org/TR/css-values/#percentages)<br>n/a<br> |
| Computed value | (https://www.w3.org/TR/css-cascade/#computed)<br>specified integer<br> |
| Canonical order | (https://www.w3.org/TR/cssom/#serializing-css-values)<br>per grammar<br> |
| Animation type | (https://www.w3.org/TR/web-animations/#animation-type)<br>by computed value type<br>Boxes are generally displayed and laid out in the same order as they appear in the source document. In some <a href="#formatting-context" id="ref-for-formatting-context④" data-link-type="dfn">formatting contexts</a>, the <a href="#propdef-order" id="ref-for-propdef-order①" class="property css" data-link-type="property">order</a> property can be used to rearrange the order of boxes to deliberately create a divergence of the logical order of elements and their spatial arrangement on the 2D visual canvas. (See [§ 3.1 Reordering and Accessibility](#order-accessibility).)<br>Specifically, the <a href="#propdef-order" id="ref-for-propdef-order②" class="property css" data-link-type="property">order</a> property controls the order in which <a href="https://www.w3.org/TR/css-flexbox-1/#flex-item" id="ref-for-flex-item①" data-link-type="dfn">flex items</a> or <a href="https://www.w3.org/TR/css-grid-2/#grid-item" id="ref-for-grid-item①" data-link-type="dfn">grid items</a> appear within their container, by assigning them to ordinal groups. It takes a single <span id="valdef-order-integer" class="dfn css" dfn-for="order" dfn-type="value" export=""><a href="https://www.w3.org/TR/css-values-4/#integer-value" id="ref-for-integer-value①" class="production css" data-link-type="type">&lt;integer&gt;</a><a href="#valdef-order-integer" class="self-link"></a></span> value, which specifies which ordinal group the item belongs to.<br><div id="example-84ef28f3" class="example"><br><a href="#example-84ef28f3" class="self-link"></a> Here’s an example of a catalog item card which has a title, a photo, and a description. Within each entry, the source document content is ordered logically with the title first, followed by the description and the photo. This provides a sensible ordering for speech rendering and in non-CSS browsers. For a more compelling visual presentation, however, <a href="#propdef-order" id="ref-for-propdef-order③" class="property css" data-link-type="property">order</a> is used to pull the image up from later in the content to the top of the card.<br>``` lang-css<br>article.sale-item {<br>  display: flex;<br>  flex-flow: column;<br>}<br>article.sale-item > img {<br>  order: -1; /* Shift image before other content (in layout order) */<br>  align-self: center;<br>}<br>```<br>``` lang-markup<br><article class="sale-item"><br>  <h1>Computer Starter Kit</h1><br>  <p>This is the best computer money can buy, if you don’t have much money.<br>  <ul><br>    <li>Computer<br>    <li>Monitor<br>    <li>Keyboard<br>    <li>Mouse<br>  </ul><br>  <img src="images/computer.jpg"<br>    alt="You get: a white desktop computer with matching peripherals."><br></article><br>```<br><figure><br><div id="order-example"><br><img src="images/computer.jpg" width="250" height="188" alt="You get: a white desktop computer with matching keyboard and monitor." /><br><h1 id="quiet-pubrules-1" style="font-size: 1.4em;">Computer Starter Kit</h1><br><p>This is the best computer money can buy, if you don’t have much money.</p><br><ul><br><li>Computer</li><br><li>Monitor</li><br><li>Keyboard</li><br><li>Mouse</li><br></ul><br></div><br><figcaption>An example rendering of the code above.</figcaption><br></figure><br></div><br><a href="https://www.w3.org/TR/css-flexbox-1/#flex-container" id="ref-for-flex-container③" data-link-type="dfn">Flex</a> and <a href="https://www.w3.org/TR/css-grid-2/#grid-container" id="ref-for-grid-container③" data-link-type="dfn">grid containers</a> lay out their contents in <span id="order-modified-document-order" class="dfn" dfn-type="dfn" export="">order-modified document order<a href="#order-modified-document-order" class="self-link"></a></span>, starting from the lowest numbered ordinal group and going up. Items with the same ordinal group are laid out in the order they appear in the source document. This also affects the [painting order](https://www.w3.org/TR/CSS2/zindex.html) <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>, exactly as if the <a href="https://www.w3.org/TR/css-flexbox-1/#flex-item" id="ref-for-flex-item②" data-link-type="dfn">flex</a>/<a href="https://www.w3.org/TR/css-grid-2/#grid-item" id="ref-for-grid-item②" data-link-type="dfn">grid items</a> were reordered in the source document. Absolutely-positioned children of a <span id="ref-for-flex-container④">flex</span>/<span id="ref-for-grid-container④">grid container</span> are treated as having <a href="#propdef-order" id="ref-for-propdef-order④" class="css" data-link-type="propdesc">order: 0</a> for the purpose of determining their painting order relative to <span id="ref-for-flex-item③">flex</span>/<span id="ref-for-grid-item③">grid items</span>.<br>Unless otherwise specified by a future specification, this property has no effect on boxes that are not <a href="https://www.w3.org/TR/css-flexbox-1/#flex-item" id="ref-for-flex-item④" data-link-type="dfn">flex items</a> or <a href="https://www.w3.org/TR/css-grid-2/#grid-item" id="ref-for-grid-item④" data-link-type="dfn">grid items</a>.<br> |
### <span class="secno">3.1. </span><span class="content"> Reordering and Accessibility</span><a href="#order-accessibility" class="self-link"></a>

The <a href="#propdef-order" id="ref-for-propdef-order⑤" class="property css" data-link-type="property">order</a> property *does not* affect ordering in non-visual media (such as [speech](https://www.w3.org/TR/css-speech-1/)). Likewise, <span id="ref-for-propdef-order⑥" class="property">order</span> does not affect the default traversal order of sequential navigation modes (such as cycling through links, see e.g. [`tabindex`](https://html.spec.whatwg.org/multipage/interaction.html#attr-tabindex) <a href="#biblio-html" data-link-type="biblio" title="HTML Standard">[HTML]</a>).

**Authors *must* use <a href="#propdef-order" id="ref-for-propdef-order⑦" class="property css" data-link-type="property">order</a> only for spatial, not logical, reordering of content. Style sheets that use <span id="ref-for-propdef-order⑧" class="property">order</span> to perform logical reordering are non-conforming.**

<span class="marker">Note:</span> This is so that non-visual media and non-CSS UAs, which typically present content linearly, can rely on a logical source order, while <a href="#propdef-order" id="ref-for-propdef-order⑨" class="property css" data-link-type="property">order</a> is used to tailor the layout order. (Since visual perception is two-dimensional and non-linear, the desired layout order is not always logical.)

In order to preserve the author’s intended ordering in all presentation modes, authoring tools—including WYSIWYG editors as well as Web-based authoring aids—must reorder the underlying document source and not use <a href="#propdef-order" id="ref-for-propdef-order①⓪" class="property css" data-link-type="property">order</a> to perform reordering unless the author has explicitly indicated that the spatial order should be *out-of-sync* with the underlying document order (which determines speech and navigation order).

<div id="example-b20b6e0a" class="example">

<a href="#example-b20b6e0a" class="self-link"></a> For example, a tool might offer both drag-and-drop reordering of flex items as well as handling of media queries for alternate layouts per screen size range.

Since most of the time, reordering should affect all screen ranges as well as navigation and speech order, the tool would perform drag-and-drop reordering at the DOM layer. In some cases, however, the author may want different layouts per screen size. The tool could offer this functionality by using <a href="#propdef-order" id="ref-for-propdef-order①①" class="property css" data-link-type="property">order</a> together with media queries, but also tie the smallest screen size’s ordering to the underlying DOM order (since this is most likely to be a logical linear presentation order) while using <span id="ref-for-propdef-order①②" class="property">order</span> to define the visual presentation order in other size ranges.

This tool would be conformant, whereas a tool that only ever used <a href="#propdef-order" id="ref-for-propdef-order①③" class="property css" data-link-type="property">order</a> to handle drag-and-drop reordering (however convenient it might be to implement it that way) would be non-conformant.

</div>

<span class="marker">Note:</span> User agents, including browsers, accessible technology, and extensions, may offer spatial navigation features. This section does not preclude respecting the <a href="#propdef-order" id="ref-for-propdef-order①④" class="property css" data-link-type="property">order</a> property when determining element ordering in such spatial navigation modes; indeed it would need to be considered for such a feature to work. But <span id="ref-for-propdef-order①⑤" class="property">order</span> is not the only (or even the primary) CSS property that would need to be considered for such a spatial navigation feature. A well-implemented spatial navigation feature would need to consider all the layout features of CSS that modify spatial relationships.

## <span class="secno">4. </span><span class="content"> Invisibility: the <a href="#propdef-visibility" id="ref-for-propdef-visibility" class="property css" data-link-type="property">visibility</a> property</span><a href="#visibility" class="self-link"></a>


| Field | Value |
|---|---|
| Name | <span id="propdef-visibility" class="dfn dfn-paneled css" dfn-type="property" export="">visibility</span><br> |
| Value | s have the following meanings:<br><span id="valdef-visibility-visible" class="dfn dfn-paneled css" dfn-for="visibility" dfn-type="value" export="">visible</span>  <br>The generated box is visible, as normal.<br><span id="valdef-visibility-hidden" class="dfn dfn-paneled css" dfn-for="visibility" dfn-type="value" export="">hidden</span>  <br>Any boxes generated by the element are <a href="#invisible" id="ref-for-invisible①" data-link-type="dfn">invisible</a>. Descendants of the element can, however, be visible if they have <a href="#propdef-visibility" id="ref-for-propdef-visibility②" class="css" data-link-type="propdesc">visibility: visible</a>.<br><span id="valdef-visibility-collapse" class="dfn css" dfn-for="visibility" dfn-type="value" export="">collapse<a href="#valdef-visibility-collapse" class="self-link"></a></span>  <br>Indicates that the box is <span id="collapsed" class="dfn" dfn-for="" dfn-type="dfn" noexport="">collapsed<a href="#collapsed" class="self-link"></a></span>, which can cause it to take up less space than otherwise in a formatting-context–specific way. See [dynamic row and column effects in tables](https://www.w3.org/TR/CSS2/tables.html#dynamic-effects) <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a> and [collapsed flex items](https://www.w3.org/TR/css-flexbox-1/#visibility-collapse) in flex layout <a href="#biblio-css-flexbox-1" data-link-type="biblio" title="CSS Flexible Box Layout Module Level 1">[CSS-FLEXBOX-1]</a>. In all other cases, however, (i.e. unless otherwise specified) this simply makes the box <a href="#invisible" id="ref-for-invisible②" data-link-type="dfn">invisible</a>, just like <a href="#valdef-visibility-hidden" id="ref-for-valdef-visibility-hidden" class="css" data-link-type="maybe">hidden</a>.<br><span class="marker">Note:</span> Currently, many user agents and/or accessibility tools don’t correctly implement the accessibility implications of visible elements with semantic relationships to <a href="#invisible" id="ref-for-invisible③" data-link-type="dfn">invisible</a> elements, so, for example, making parent elements with special roles (such as table rows) <span id="ref-for-invisible④">invisible</span> while leaving child elements with special roles (such as table cells) visible can be problematic for users of those tools. Authors should avoid creating these situations until the tooling situation improves.<br><span id="invisible" class="dfn dfn-paneled" dfn-type="dfn" noexport="">Invisible</span> boxes are not rendered (as if they were fully transparent), cannot be interacted with (and behave as if they had <a href="https://drafts.csswg.org/css-ui-4/#propdef-pointer-events" id="ref-for-propdef-pointer-events" class="css" data-link-type="propdesc">pointer-events: none</a>), are removed from navigation (similar to <a href="#propdef-display" id="ref-for-propdef-display③③" class="css" data-link-type="propdesc">display: none</a>), and are also not rendered to speech (except when <a href="https://www.w3.org/TR/CSS21/aural.html#propdef-speak" id="ref-for-propdef-speak" class="property css" data-link-type="property">speak</a> is <a href="https://www.w3.org/TR/css-speech-1/#valdef-speak-always" id="ref-for-valdef-speak-always" class="css" data-link-type="maybe">always</a> <a href="#biblio-css-speech-1" data-link-type="biblio" title="CSS Speech Module Level 1">[CSS-SPEECH-1]</a>). However, as with <span id="ref-for-propdef-display③④" class="css">display: contents</span>, their semantic role as a container is not affected, to ensure that any <a href="#valdef-visibility-visible" id="ref-for-valdef-visibility-visible" class="css" data-link-type="maybe">visible</a> descendants are properly interpreted.<br><span class="marker">Note:</span> If <a href="https://www.w3.org/TR/CSS21/aural.html#propdef-speak" id="ref-for-propdef-speak①" class="property css" data-link-type="property">speak</a> is <a href="https://www.w3.org/TR/css-speech-1/#valdef-speak-always" id="ref-for-valdef-speak-always①" class="css" data-link-type="maybe">always</a>, an otherwise <a href="#invisible" id="ref-for-invisible⑤" data-link-type="dfn">invisible</a> box *is* rendered to speech, and may be interacted with using non-visual/spatial methods.<br><div id="example-45900d89" class="example"><br><a href="#example-45900d89" class="self-link"></a> While temporarily hiding things with <a href="#propdef-display" id="ref-for-propdef-display③⑤" class="css" data-link-type="propdesc">display: none</a> is often sufficient, doing so removes the elements from layout entirely, possibly causing unwanted movement or reflow of the page when an element is hidden or shown. <a href="#propdef-visibility" id="ref-for-propdef-visibility③" class="css" data-link-type="propdesc">visibility: hidden</a> can instead be used to keep the page’s layout stable as something is hidden and displayed.<br>For example, here is a (deliberately simplified) possible implementation of a "spoiler" element that can be revealed by clicking on the hidden text:<br>``` highlight<br><p>The symbolism earlier in the movie becomes obvious at the end,<br>  when it’s revealed that <spoiler-text><span>Luke is his own father</span></spoiler-text>,<br>  making the wizard’s cryptic riddles meaningful.<br><style><br>spoiler-text { border-bottom: 1px solid; }<br>spoiler-text > span { visibility: hidden; }<br>spoiler-text.shown > span { visibility: visible; }<br></style><br><script><br>[...document.querySelectorAll("spoiler-text")].forEach(el=>{<br>  el.addEventListener("click", e=>el.classList.toggle("shown"));<br>});<br></script><br>```<br>**This example is deliberately significantly simplified. It is missing a number of accessiblity and UX features that a well-designed spoiler element would have to show off the <a href="#propdef-visibility" id="ref-for-propdef-visibility④" class="property css" data-link-type="property">visibility</a> usage more plainly. Don’t copy this code for a real site.**<br></div><br> |
| Initial | (https://www.w3.org/TR/css-cascade/#initial-values)<br>visible<br> |
| Applies to | (https://www.w3.org/TR/css-cascade/#applies-to)<br>[all elements](https://www.w3.org/TR/css-pseudo/#generated-content "Includes ::before and ::after pseudo-elements.")<br> |
| Inherited | (https://www.w3.org/TR/css-cascade/#inherited-property)<br>yes<br> |
| Percentages | (https://www.w3.org/TR/css-values/#percentages)<br>N/A<br> |
| Computed value | (https://www.w3.org/TR/css-cascade/#computed)<br>as specified<br> |
| Canonical order | (https://www.w3.org/TR/cssom/#serializing-css-values)<br>per grammar<br> |
| Animation type | (https://www.w3.org/TR/web-animations/#animation-type)<br>discrete<br> |
| Media | visual<br> |
## <span class="secno">5. </span><span class="content"> Run-In Layout</span><a href="#run-in-layout" class="self-link"></a>

A <span id="run-in" class="dfn dfn-paneled" dfn-type="dfn" export="" lt="run-in | run-in box">run-in box</span> is a box that *merges into* a block that comes after it, inserting itself at the beginning of that block’s inline-level content. This is useful for formatting compact headlines, definitions, and other similar things, where the appropriate DOM structure is to have a headline preceding the following prose, but the desired display is an inline headline laying out with the text.

<div id="example-8e61beaa" class="example">

<a href="#example-8e61beaa" class="self-link"></a> For example, dictionary definitions are often formatted so that the word is inline with the definition:

    <dl class='dict'>
      <dt>dictionary
      <dd>a book that lists the words of a language in alphabetical
          order and gives their meaning, or that gives the equivalent
          words in a different language.
      <dt>glossary
      <dd>an alphabetical list of terms or words found in or relating
          to a specific subject, text, or dialect, with explanations; a
          brief dictionary.
    </dl>
    <style>
    .dict > dt {
      display: run-in;
    }
    .dict > dt::after {
      content: ": "
    }
    </style>

Which is formatted as:

    dictionary: a book that lists the words of a language
    in alphabetical order and explains their meaning.

    glossary: an alphabetical list of terms or words found
    in or relating to a specific subject, text, or dialect,
    with explanations; a brief dictionary.

</div>

A <a href="#run-in" id="ref-for-run-in②" data-link-type="dfn">run-in box</a> behaves exactly as any other <a href="#inline-level-box" id="ref-for-inline-level-box①" data-link-type="dfn">inline-level box</a>, except:

- A <a href="#run-in" id="ref-for-run-in③" data-link-type="dfn">run-in box</a> with a <a href="#valdef-display-flow" id="ref-for-valdef-display-flow⑥" class="css" data-link-type="maybe">flow</a> <a href="#inner-display-type" id="ref-for-inner-display-type①③" data-link-type="dfn">inner display type</a> <a href="#inlinify" id="ref-for-inlinify⑥" data-link-type="dfn">inlinifies</a> its contents.

- If a <a href="#run-in-sequence" id="ref-for-run-in-sequence" data-link-type="dfn">run-in sequence</a> is immediately followed by a block box that does not establish a new <a href="#block-formatting-context" id="ref-for-block-formatting-context⑥" data-link-type="dfn">block formatting context</a>, it is inserted as direct children of that block box: after its <a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-marker" id="ref-for-selectordef-marker②" class="css" data-link-type="maybe">::marker</a> pseudo-element’s boxes (if any), but preceding any other boxes generated by the contents of the block (including the box generated by the <a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-before" id="ref-for-selectordef-before①" class="css" data-link-type="maybe">::before</a> pseudo-element, if any). This re-parenting recurses if possible (so that the run-in effectively becomes part of the deepest subsequent “paragraph” in its formatting context, collecting newly-adjacent run-ins as it goes).

  The reparented content is then formatted as if originally parented there. <span class="note">Note that only layout is affected, not inheritance, because property inheritance for non-anonymous boxes is based only on the element tree.</span>

- Otherwise (if the <a href="#run-in-sequence" id="ref-for-run-in-sequence①" data-link-type="dfn">run-in sequence</a> is *not* followed by such a block), an anonymous block box is generated around the <span id="ref-for-run-in-sequence②">run-in sequence</span> and all immediately following inline-level content (up to, but not including, the next <span id="ref-for-run-in-sequence③">run-in sequence</span>, if any).

A <span id="run-in-sequence" class="dfn dfn-paneled" dfn-type="dfn" noexport="">run-in sequence</span> is a maximal sequence of consecutive sibling <a href="#run-in" id="ref-for-run-in④" data-link-type="dfn">run-in boxes</a> and intervening <a href="https://www.w3.org/TR/css-text-4/#white-space" id="ref-for-white-space" data-link-type="dfn">white space</a> and/or out-of-flow boxes.

<span class="marker">Note:</span> This statement implies that out-of-flow boxes are reparented if they are between two run-in boxes. Another alternative would be to leave behind the intervening out-of-flow boxes, or to have out-of-flow boxes impede the running-in of earlier boxes. Implementers and authors are encouraged to contact the CSSWG if they have a preferred behavior, as this one was picked somewhat at random.

This fixup occurs before the anonymous block and inline box fixup described in [CSS2§9.2](https://www.w3.org/TR/CSS21/visuren.html#box-gen), and affects the determination of the <a href="https://www.w3.org/TR/css-pseudo-4/#first-formatted-line" id="ref-for-first-formatted-line" data-link-type="dfn">first formatted line</a> of the affected elements as if the <a href="#run-in-sequence" id="ref-for-run-in-sequence④" data-link-type="dfn">run-in sequence</a> were originally in its final location in the box tree.

<span class="marker">Note:</span> As the earliest run-in represents the first text on the <a href="https://www.w3.org/TR/css-pseudo-4/#first-formatted-line" id="ref-for-first-formatted-line①" data-link-type="dfn">first formatted line</a> of its containing block, a <a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-first-letter" id="ref-for-selectordef-first-letter①" class="css" data-link-type="maybe">::first-letter</a> pseudo-element applied to that block element selects the first letter of the run-in, rather than the first letter of its own contents.

<span class="marker">Note:</span> This run-in model is slightly different from the one proposed in earlier revisions of <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>.

## <span class="content"> Appendix A: Glossary</span><a href="#glossary" class="self-link"></a>

The following terms are defined here for convenience:

<span id="root-element" class="dfn dfn-paneled" dfn-type="dfn" export="">root element</span>  
The <a href="#elements" id="ref-for-elements⑦" data-link-type="dfn">element</a> at the root of the <a href="https://dom.spec.whatwg.org/#concept-document-tree" id="ref-for-concept-document-tree" data-link-type="dfn">document tree</a>. In a <span id="ref-for-concept-document-tree①">document tree</span> produced under the DOM, this is the <a href="https://dom.spec.whatwg.org/#document-element" id="ref-for-document-element" data-link-type="dfn">document element</a>; in HTML it is the <a href="https://html.spec.whatwg.org/multipage/semantics.html#the-html-element" id="ref-for-the-html-element" data-link-type="element"><code>html</code></a> element. <a href="#biblio-dom" data-link-type="biblio" title="DOM Standard">[DOM]</a> <a href="#biblio-html" data-link-type="biblio" title="HTML Standard">[HTML]</a>

<span id="principal-box" class="dfn dfn-paneled" dfn-type="dfn" export="">principal box</span>  
When an <a href="#elements" id="ref-for-elements⑧" data-link-type="dfn">element</a> generates one or more <a href="#box" id="ref-for-box①①" data-link-type="dfn">boxes</a>, one of them is the <a href="#principal-box" id="ref-for-principal-box⑨" data-link-type="dfn">principal box</a>, which contains its descendant boxes and generated content, and is also the box involved in any positioning scheme.

Some elements may generate additional boxes in addition to the principal box (such as <a href="#valdef-display-list-item" id="ref-for-valdef-display-list-item④" class="css" data-link-type="maybe">list-item</a> elements, which generate an additional marker box, or <a href="#valdef-display-table" id="ref-for-valdef-display-table③" class="css" data-link-type="maybe">table</a> elements, which generate a <a href="#principal-box" id="ref-for-principal-box①⓪" data-link-type="dfn">principal</a> <a href="https://www.w3.org/TR/css-tables-3/#table-wrapper-box" id="ref-for-table-wrapper-box④" data-link-type="dfn">table wrapper box</a> and an additional <a href="https://www.w3.org/TR/css-tables-3/#table-grid-box" id="ref-for-table-grid-box④" data-link-type="dfn">table grid box</a>). These additional boxes are placed with respect to the principal box.

<span id="inline-level" class="dfn dfn-paneled" dfn-type="dfn" export="" lt="inline-level|inline-level content">inline-level</span>  
Content that participates in inline layout. Specifically, inline-level boxes and <a href="#css-text-sequence" id="ref-for-css-text-sequence⑨" data-link-type="dfn">text sequences</a>.

<span id="block-level" class="dfn dfn-paneled" dfn-type="dfn" export="" lt="block-level|block-level content">block-level</span>  
Content that participates in <a href="#block-layout" id="ref-for-block-layout" data-link-type="dfn">block layout</a>. Specifically, block-level boxes.

<span id="inline-box" class="dfn dfn-paneled" dfn-type="dfn" export="">inline box</span>  
A non-replaced <a href="#inline-level" id="ref-for-inline-level⑤" data-link-type="dfn">inline-level</a> box whose <a href="#inner-display-type" id="ref-for-inner-display-type①④" data-link-type="dfn">inner display type</a> is <a href="#valdef-display-flow" id="ref-for-valdef-display-flow⑦" class="css" data-link-type="maybe">flow</a>. The contents of an inline box participate in the same inline formatting context as the inline box itself.

<span id="inline" class="dfn" dfn-type="dfn" export="">inline<a href="#inline" class="self-link"></a></span>  
Used as a shorthand for <a href="#inline-box" id="ref-for-inline-box⑥" data-link-type="dfn">inline box</a> or <a href="#inline-level-box" id="ref-for-inline-level-box②" data-link-type="dfn">inline-level box</a> where unambiguous, or as an adjective meaning <a href="#inline-level" id="ref-for-inline-level⑥" data-link-type="dfn">inline-level</a>. The latter usage is deprecated.

<span id="atomic-inline" class="dfn" dfn-type="dfn" export="" lt="atomic inline|atomic inline box">atomic inline<a href="#atomic-inline" class="self-link"></a></span>  
An inline-level box that is replaced (such as an image) or that establishes a new formatting context (such as an <a href="#valdef-display-inline-block" id="ref-for-valdef-display-inline-block①" class="css" data-link-type="maybe">inline-block</a> or <a href="#valdef-display-inline-table" id="ref-for-valdef-display-inline-table①" class="css" data-link-type="maybe">inline-table</a>) and cannot split across lines (as <a href="#inline-box" id="ref-for-inline-box⑦" data-link-type="dfn">inline boxes</a> and <a href="https://www.w3.org/TR/css-ruby-1/#ruby-container" id="ref-for-ruby-container④" data-link-type="dfn">ruby containers</a> can).

Any inline-level box whose <a href="#inner-display-type" id="ref-for-inner-display-type①⑤" data-link-type="dfn">inner display type</a> is not <a href="#valdef-display-flow" id="ref-for-valdef-display-flow⑧" class="css" data-link-type="maybe">flow</a> establishes a new formatting context of the specified <span id="ref-for-inner-display-type①⑥">inner display type</span>.

<span id="block-container" class="dfn dfn-paneled" dfn-type="dfn" export="" lt="block container|block container box">block container</span>  
A block container either contains only inline-level boxes participating in an <a href="#inline-formatting-context" id="ref-for-inline-formatting-context①" data-link-type="dfn">inline formatting context</a>, or contains only block-level boxes participating in a <a href="#block-formatting-context" id="ref-for-block-formatting-context⑦" data-link-type="dfn">block formatting context</a> (possibly generating anonymous block boxes to ensure this constraint, as defined in [CSS2§9.2.1.1](https://www.w3.org/TR/CSS2/visuren.html#anonymous-block-level)).

A block container that contains only inline-level content establishes a new <a href="#inline-formatting-context" id="ref-for-inline-formatting-context②" data-link-type="dfn">inline formatting context</a>. The element then also generates a <a href="https://www.w3.org/TR/css-inline-3/#root-inline-box" id="ref-for-root-inline-box" data-link-type="dfn">root inline box</a> which wraps all of its inline content. <span class="note">Note, this <a href="https://www.w3.org/TR/css-inline-3/#root-inline-box" id="ref-for-root-inline-box①" data-link-type="dfn">root inline box</a> concept effectively replaces the "anonymous inline element" concept introduced in [CSS2§9.2.2.1](https://www.w3.org/TR/CSS2/visuren.html#anonymous).</span>

A block container establishes a new <a href="#block-formatting-context" id="ref-for-block-formatting-context⑧" data-link-type="dfn">block formatting context</a> if its parent formatting context is *not* a <span id="ref-for-block-formatting-context⑨">block formatting context</span>; otherwise, when participating in a <span id="ref-for-block-formatting-context①⓪">block formatting context</span> itself, it either establishes a new <span id="ref-for-block-formatting-context①①">block formatting context</span> for its contents or continues the one in which it participates, as determined by the constraints of other properties (such as <a href="https://drafts.csswg.org/css2/#propdef-overflow" id="ref-for-propdef-overflow①" class="property css" data-link-type="property">overflow</a> or <a href="https://www.w3.org/TR/css-align-3/#propdef-align-content" id="ref-for-propdef-align-content" class="property css" data-link-type="property">align-content</a>).

<span class="marker">Note:</span> A block container box can both establish a block formatting context *and* an inline formatting context simultaneously.

<span id="block-box" class="dfn dfn-paneled" dfn-type="dfn" export="">block box</span>  
A <a href="#block-level-box" id="ref-for-block-level-box" data-link-type="dfn">block-level box</a> that is also a <a href="#block-container" id="ref-for-block-container⑦" data-link-type="dfn">block container</a>.

<span class="marker">Note:</span> Not all <a href="#block-container" id="ref-for-block-container⑧" data-link-type="dfn">block container</a> boxes are <a href="#block-level" id="ref-for-block-level⑤" data-link-type="dfn">block-level</a> boxes: non-replaced <a href="#inline-block" id="ref-for-inline-block①" data-link-type="dfn">inline blocks</a> and non-replaced table cells, for example, are block containers but not block-level boxes. Similarly, not all block-level boxes are block containers: block-level replaced elements (<a href="#propdef-display" id="ref-for-propdef-display③⑥" class="css" data-link-type="propdesc">display: block</a>) and flex containers (<span id="ref-for-propdef-display③⑦" class="css">display: flex</span>), for example, are not block containers.

<span id="block" class="dfn dfn-paneled" dfn-type="dfn" export="">block</span>  
Used as a shorthand for <a href="#block-box" id="ref-for-block-box⑥" data-link-type="dfn">block box</a>, <a href="#block-level-box" id="ref-for-block-level-box①" data-link-type="dfn">block-level box</a>, or <a href="#block-container" id="ref-for-block-container⑨" data-link-type="dfn">block container box</a>, where unambiguous.

<span id="replaced-element" class="dfn dfn-paneled" dfn-type="dfn" export="" lt="replaced element|replaced">replaced element</span>  
An element whose content is outside the scope of the CSS formatting model, such as an image or embedded document. <span class="non-normative"> For example, the content of the HTML <a href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element" id="ref-for-the-img-element" data-link-type="element"><code>img</code></a> element is often replaced by the image that its <a href="https://html.spec.whatwg.org/multipage/embedded-content.html#attr-img-src" id="ref-for-attr-img-src" data-link-type="element-sub"><code>src</code></a> attribute designates. </span>

Replaced elements often have <a href="https://www.w3.org/TR/css-images-3/#natural-dimensions" id="ref-for-natural-dimensions" data-link-type="dfn">natural dimensions</a>. For example, a bitmap image has a natural width and a natural height specified in absolute units (from which the natural ratio can obviously be determined). On the other hand, other objects may not have any natural dimensions (for example, a blank HTML document). See <a href="#biblio-css-images-3" data-link-type="biblio" title="CSS Images Module Level 3">[css-images-3]</a>.

User agents may consider a <a href="#replaced-element" id="ref-for-replaced-element⑥" data-link-type="dfn">replaced element</a> to not have any <a href="https://www.w3.org/TR/css-images-3/#natural-dimensions" id="ref-for-natural-dimensions①" data-link-type="dfn">natural dimensions</a> if it is believed that those dimensions could leak sensitive information to a third party. For example, if an HTML document changed natural size depending on the user’s bank balance, then the UA might want to act as if that resource had no <span id="ref-for-natural-dimensions②">natural dimensions</span>.

The content of replaced elements is not considered in the CSS formatting model; however, their <a href="https://www.w3.org/TR/css-images-3/#natural-dimensions" id="ref-for-natural-dimensions③" data-link-type="dfn">natural dimensions</a> are used in various layout calculations. Replaced elements always establish an <a href="#independent-formatting-context" id="ref-for-independent-formatting-context①" data-link-type="dfn">independent formatting context</a>.

A <span id="non-replaced" class="dfn" dfn-type="dfn" export="" lt="non-replaced | non-replaced element">non-replaced<a href="#non-replaced" class="self-link"></a></span> element is one that is not <a href="#replaced-element" id="ref-for-replaced-element⑦" data-link-type="dfn">replaced</a>, i.e. whose rendering is dictated by the CSS model.

<span id="containing-block" class="dfn dfn-paneled" dfn-type="dfn" export="">containing block</span>  
A rectangle that forms the basis of sizing and positioning for the <a href="#box" id="ref-for-box①②" data-link-type="dfn">boxes</a> associated with it. Notably, a <a href="#containing-block" id="ref-for-containing-block①" data-link-type="dfn">containing block</a> is *not a <a href="#box" id="ref-for-box①③" data-link-type="dfn">box</a>* (it is a rectangle), however it is often derived from the dimensions of a <span id="ref-for-box①④">box</span>. Each <span id="ref-for-box①⑤">box</span> is given a position with respect to its <span id="ref-for-containing-block②">containing block</span>, but it is not confined by this <span id="ref-for-containing-block③">containing block</span>; it can <a href="https://www.w3.org/TR/css-overflow-3/#overflow" id="ref-for-overflow" data-link-type="dfn">overflow</a>. The phrase “a box’s containing block” means “the <span id="ref-for-containing-block④">containing block</span> in which the box lives,” not the one it generates.

In general, the <a href="https://www.w3.org/TR/css-box-4/#box-box-edge" id="ref-for-box-box-edge" data-link-type="dfn">edges</a> of a <a href="#box" id="ref-for-box①⑥" data-link-type="dfn">box</a> act as the <a href="#containing-block" id="ref-for-containing-block⑤" data-link-type="dfn">containing block</a> for descendant boxes; we say that a box “establishes” the <span id="ref-for-containing-block⑥">containing block</span> for its descendants. If properties of a <span id="ref-for-containing-block⑦">containing block</span> are referenced, they reference the values on the <span id="ref-for-box①⑦">box</span> that generated the <span id="ref-for-containing-block⑧">containing block</span>. (For the <a href="#initial-containing-block" id="ref-for-initial-containing-block①" data-link-type="dfn">initial containing block</a>, values are taken from the root element unless otherwise specified.)

See <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a> [Section 9.1.2](https://www.w3.org/TR/CSS2/visuren.html#containing-block) and [Section 10.1](https://www.w3.org/TR/CSS2/visudet.html#containing-block-details) and [CSS Positioned Layout 3 § 2.1 Containing Blocks of Positioned Boxes](https://www.w3.org/TR/css-position-3/#def-cb) for details.

<span id="containing-block-chain" class="dfn" dfn-type="dfn" export="">containing block chain<a href="#containing-block-chain" class="self-link"></a></span>  
A sequence of successive <a href="#containing-block" id="ref-for-containing-block⑨" data-link-type="dfn">containing blocks</a> that form an ancestor-descendant chain through the <span id="ref-for-containing-block①⓪">containing block</span> relation. For example, an <a href="#inline-box" id="ref-for-inline-box⑧" data-link-type="dfn">inline box</a>’s containing block is the content box of its closest <a href="#block-container" id="ref-for-block-container①⓪" data-link-type="dfn">block container</a> ancestor; if that block container is an in-flow <a href="#block" id="ref-for-block" data-link-type="dfn">block</a>, then *its* containing block is formed by its parent <span id="ref-for-block-container①①">block container</span>; if that grandparent <span id="ref-for-block-container①②">block container</span> is <a href="https://www.w3.org/TR/css-position-3/#absolute-position" id="ref-for-absolute-position" data-link-type="dfn">absolutely positioned</a>, then *its* containing block is the padding edges of its closest *positioned* ancestor (not necessarily its parent), and so on up to the <a href="#initial-containing-block" id="ref-for-initial-containing-block②" data-link-type="dfn">initial containing block</a>.

<span id="initial-containing-block" class="dfn dfn-paneled" dfn-type="dfn" export="">initial containing block</span>  

| Field | Value |
|---|---|
| Media | Module Level 3">[CSS-PAGE-3]</a> for <a href="https://www.w3.org/TR/mediaqueries-5/#paged-media" id="ref-for-paged-media" data-link-type="dfn">paged media</a> for its position and dimensions.<br><span id="formatting-context" class="dfn dfn-paneled" dfn-type="dfn" export="">formatting context</span>  <br>A <a href="#formatting-context" id="ref-for-formatting-context⑤" data-link-type="dfn">formatting context</a> is the environment into which a set of related boxes are laid out. Different <span id="ref-for-formatting-context⑥">formatting contexts</span> lay out their boxes according to different rules. For example, a <a href="https://www.w3.org/TR/css-flexbox-1/#flex-formatting-context" id="ref-for-flex-formatting-context①" data-link-type="dfn">flex formatting context</a> lays out boxes according to the <a href="https://www.w3.org/TR/css-flexbox-1/#flex-layout" id="ref-for-flex-layout" data-link-type="dfn">flex layout</a> rules <a href="#biblio-css-flexbox-1" data-link-type="biblio" title="CSS Flexible Box Layout Module Level 1">[CSS-FLEXBOX-1]</a>, whereas a <a href="#block-formatting-context" id="ref-for-block-formatting-context①③" data-link-type="dfn">block formatting context</a> lays out boxes according to the block-and-inline layout rules <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a>. Additionally, some types of <span id="ref-for-formatting-context⑦">formatting contexts</span> interleave and co-exist: for example, an <a href="#inline-formatting-context" id="ref-for-inline-formatting-context③" data-link-type="dfn">inline formatting context</a> exists within and interacts with the <span id="ref-for-block-formatting-context①④">block formatting context</span> of the element that establishes it, and a <a href="https://www.w3.org/TR/css-ruby-1/#ruby-container" id="ref-for-ruby-container⑤" data-link-type="dfn">ruby container</a> overlays a <a href="https://www.w3.org/TR/css-ruby-1/#ruby-formatting-context" id="ref-for-ruby-formatting-context②" data-link-type="dfn">ruby formatting context</a> over the <span id="ref-for-inline-formatting-context④">inline formatting context</span> in which its <a href="https://www.w3.org/TR/css-ruby-1/#ruby-base-container-box" id="ref-for-ruby-base-container-box" data-link-type="dfn">ruby base container</a> participates.<br>A box either establishes a new <a href="#independent-formatting-context" id="ref-for-independent-formatting-context②" data-link-type="dfn">independent formatting context</a> or continues the <a href="#formatting-context" id="ref-for-formatting-context⑧" data-link-type="dfn">formatting context</a> of its containing block. In some cases, it might additionally establish a new (non-independent) co-existing formatting context. Unless otherwise specified, however, establishing a new <span id="ref-for-formatting-context⑨">formatting context</span> creates an <span id="ref-for-independent-formatting-context③">independent formatting context</span>. The type of formatting context established by the box is determined by its <a href="#inner-display-type" id="ref-for-inner-display-type①⑦" data-link-type="dfn">inner display type</a>. E.g. a <a href="https://www.w3.org/TR/css-grid-2/#grid-container" id="ref-for-grid-container⑤" data-link-type="dfn">grid container</a> establishes a new <a href="https://www.w3.org/TR/css-grid-2/#grid-formatting-context" id="ref-for-grid-formatting-context②" data-link-type="dfn">grid formatting context</a>, a <a href="https://www.w3.org/TR/css-ruby-1/#ruby-container" id="ref-for-ruby-container⑥" data-link-type="dfn">ruby container</a> establishes a new <a href="https://www.w3.org/TR/css-ruby-1/#ruby-formatting-context" id="ref-for-ruby-formatting-context③" data-link-type="dfn">ruby formatting context</a>, and a <a href="#block-container" id="ref-for-block-container①③" data-link-type="dfn">block container</a> can establish a new <a href="#block-formatting-context" id="ref-for-block-formatting-context①⑤" data-link-type="dfn">block formatting context</a> and/or a new <a href="#inline-formatting-context" id="ref-for-inline-formatting-context⑤" data-link-type="dfn">inline formatting context</a>. See the <a href="#propdef-display" id="ref-for-propdef-display③⑧" class="property css" data-link-type="property">display</a> property.<br><span id="independent-formatting-context" class="dfn dfn-paneled" dfn-type="dfn" export="">independent formatting context</span>  <br>When a box establishes an independent formatting context (whether that <a href="#formatting-context" id="ref-for-formatting-context①⓪" data-link-type="dfn">formatting context</a> is of the same type as its parent or not), it essentially creates a new, independent layout environment: except through the sizing of the box itself, the layout of its descendants is (generally) not affected by the rules and contents of the <span id="ref-for-formatting-context①①">formatting context</span> outside the box, and vice versa.<br><a href="#example-7e2994e7" class="self-link"></a> For example, in a <a href="#block-formatting-context" id="ref-for-block-formatting-context①⑥" data-link-type="dfn">block formatting context</a>, floated boxes affect the layout of surrounding boxes. But their effects do not escape their <a href="#formatting-context" id="ref-for-formatting-context①②" data-link-type="dfn">formatting context</a>: the box establishing their <span id="ref-for-formatting-context①③">formatting context</span> grows to fully contain them, and floats from outside that box are not allowed to protrude into and affect the contents inside the box.<br><a href="#example-bb8209a6" class="self-link"></a> As another example, margins do not collapse across <a href="#formatting-context" id="ref-for-formatting-context①④" data-link-type="dfn">formatting context</a> boundaries.<br>Exclusions are able to affect content across <a href="#independent-formatting-context" id="ref-for-independent-formatting-context④" data-link-type="dfn">independent formatting context</a> boundaries. (At time of writing, they are the only layout feature that can.) <a href="#biblio-css3-exclusions" data-link-type="biblio" title="CSS Exclusions Module Level 1">[CSS3-EXCLUSIONS]</a><br>Certain properties can force a box to <span id="establish-an-independent-formatting-context" class="dfn dfn-paneled" dfn-type="dfn" export="" lt="establish an independent formatting context|<br>                     establishes an independent formatting context|<br>                     establishing an independent formatting context|<br>                     established an independent formatting context"> establish an independent formatting context</span> in cases where it wouldn’t ordinarily. For example, making a box <a href="#out-of-flow" id="ref-for-out-of-flow" data-link-type="dfn">out-of-flow</a> causes it to <a href="#blockify" id="ref-for-blockify⑦" data-link-type="dfn">blockify</a> as well as to <a href="#establish-an-independent-formatting-context" id="ref-for-establish-an-independent-formatting-context" data-link-type="dfn">establish an independent formatting context</a>. As another example, certain values of the <a href="https://www.w3.org/TR/css-contain-2/#propdef-contain" id="ref-for-propdef-contain" class="property css" data-link-type="property">contain</a> property can cause a box to <span id="ref-for-establish-an-independent-formatting-context①">establish an independent formatting context</span>. Turning a block into a <a href="https://www.w3.org/TR/css-overflow-3/#scroll-container" id="ref-for-scroll-container" data-link-type="dfn">scroll container</a> will cause it to <span id="ref-for-establish-an-independent-formatting-context②">establish an independent formatting context</span>; however turning a <a href="https://www.w3.org/TR/css-grid-2/#subgrid" id="ref-for-subgrid" data-link-type="dfn">subgrid</a> into a <span id="ref-for-scroll-container①">scroll container</span> will not—it continues to act as a subgrid, with its contents participating in the layout of its parent <a href="https://www.w3.org/TR/css-grid-2/#grid-container" id="ref-for-grid-container⑥" data-link-type="dfn">grid container</a>.<br>A <a href="#block-box" id="ref-for-block-box⑦" data-link-type="dfn">block box</a> that <a href="#establish-an-independent-formatting-context" id="ref-for-establish-an-independent-formatting-context③" data-link-type="dfn">establishes an independent formatting context</a> establishes a new <a href="#block-formatting-context" id="ref-for-block-formatting-context①⑦" data-link-type="dfn">block formatting context</a> for its contents. In most other cases, forcing a box to <span id="ref-for-establish-an-independent-formatting-context④">establish an independent formatting context</span> is a no-op—either the box already establishes an <a href="#independent-formatting-context" id="ref-for-independent-formatting-context⑤" data-link-type="dfn">independent formatting context</a> (e.g. <a href="https://www.w3.org/TR/css-flexbox-1/#flex-container" id="ref-for-flex-container⑤" data-link-type="dfn">flex containers</a>), or it’s not possible to establish a totally independent new formatting context on that type of box (e.g. non-replaced <a href="#inline-box" id="ref-for-inline-box⑨" data-link-type="dfn">inline boxes</a>).<br><span id="block-formatting-context" class="dfn dfn-paneled" dfn-type="dfn" export="">block formatting context</span>  <br><span id="inline-formatting-context" class="dfn dfn-paneled" dfn-type="dfn" export="">inline formatting context</span>  <br><a href="#block-formatting-context" id="ref-for-block-formatting-context①⑧" data-link-type="dfn">Block</a> and <a href="#inline-formatting-context" id="ref-for-inline-formatting-context⑥" data-link-type="dfn">inline formatting contexts</a> are defined in [CSS 2.1 Section 9.4](https://www.w3.org/TR/CSS2/visuren.html#normal-flow). <span id="ref-for-inline-formatting-context⑦">Inline formatting contexts</span> exist within (are part of their containing) <span id="ref-for-block-formatting-context①⑨">block formatting contexts</span>; for example, line boxes belonging to the <span id="ref-for-inline-formatting-context⑧">inline formatting context</span> interact with floats belonging to the <span id="ref-for-block-formatting-context②⓪">block formatting context</span>.<br><span id="block-layout" class="dfn dfn-paneled" dfn-type="dfn" export="">block layout</span>  <br>The layout of <a href="#block-level-box" id="ref-for-block-level-box②" data-link-type="dfn">block-level boxes</a>, performed within a <a href="#block-formatting-context" id="ref-for-block-formatting-context②①" data-link-type="dfn">block formatting context</a>.<br><span id="block-formatting-context-root" class="dfn dfn-paneled" dfn-type="dfn" export="">block formatting context root</span>  <br>A <a href="#block-container" id="ref-for-block-container①④" data-link-type="dfn">block container</a> that establishes a new <a href="#block-formatting-context" id="ref-for-block-formatting-context②②" data-link-type="dfn">block formatting context</a>.<br><span id="bfc" class="dfn dfn-paneled" dfn-type="dfn" export="">BFC</span>  <br>Abbreviation for <a href="#block-formatting-context" id="ref-for-block-formatting-context②③" data-link-type="dfn">block formatting context</a> or <a href="#block-formatting-context-root" id="ref-for-block-formatting-context-root" data-link-type="dfn">block formatting context root</a>. Has various informal definitions referring to boxes which contain internal floats, exclude external floats, and suppress margin collapsing, and may therefore refer specifically to one of:<br>- a <a href="#block-container" id="ref-for-block-container①⑤" data-link-type="dfn">block container</a> that establishes a new <a href="#block-formatting-context" id="ref-for-block-formatting-context②④" data-link-type="dfn">block formatting context</a> for its contents<br>- a <a href="#block-box" id="ref-for-block-box⑧" data-link-type="dfn">block box</a> (i.e. a <a href="#block-level" id="ref-for-block-level⑥" data-link-type="dfn">block-level</a> block container) that establishes a <a href="#block-formatting-context" id="ref-for-block-formatting-context②⑤" data-link-type="dfn">block formatting context</a> for its contents (as distinguished from a block box which does not)<br>- (very loosely) any block-level box that establishes a new <a href="#formatting-context" id="ref-for-formatting-context①⑤" data-link-type="dfn">formatting context</a> (other than an inline formatting context)<br><span id="out-of-flow" class="dfn dfn-paneled" dfn-type="dfn" export="" lt="out of flow | out-of-flow">out-of-flow</span>  <br><span id="in-flow" class="dfn dfn-paneled" dfn-type="dfn" export="" lt="in flow | in-flow">in-flow</span>  <br>A box is <a href="#out-of-flow" id="ref-for-out-of-flow①" data-link-type="dfn">out-of-flow</a> if it is extracted from its expected position and interaction with surrounding content and laid out using a different paradigm outside the normal flow of content in its parent formatting context. This occurs if the box is floated (via <a href="https://drafts.csswg.org/css2/#propdef-float" id="ref-for-propdef-float①" class="property css" data-link-type="property">float</a>) or <a href="https://www.w3.org/TR/css-position-3/#absolute-position" id="ref-for-absolute-position①" data-link-type="dfn">absolutely positioned</a> (via <a href="https://www.w3.org/TR/css-position-3/#propdef-position" id="ref-for-propdef-position①" class="property css" data-link-type="property">position</a>). A box is <a href="#in-flow" id="ref-for-in-flow" data-link-type="dfn">in-flow</a> if it is not <span id="ref-for-out-of-flow②">out-of-flow</span>.<br><span class="marker">Note:</span> Some <a href="#formatting-context" id="ref-for-formatting-context①⑥" data-link-type="dfn">formatting contexts</a> inhibit floating, so that an element with <a href="https://drafts.csswg.org/css2/#propdef-float" id="ref-for-propdef-float②" class="css" data-link-type="propdesc">float: left</a> is not necessarily <a href="#out-of-flow" id="ref-for-out-of-flow③" data-link-type="dfn">out-of-flow</a>.<br><span id="document-order" class="dfn dfn-paneled" dfn-type="dfn" export="">document order</span>  <br>The order in which boxes or content occurs in the document (which can be different from the order in which it appears for rendering). For the purpose of determining the relative order of pseudo-elements, the box-tree order is used, see [CSS Pseudo-Elements 4 § 4 Tree-Abiding Pseudo-elements](https://www.w3.org/TR/css-pseudo-4/#treelike).<br>See <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a> [Chapter 9](https://www.w3.org/TR/CSS2/visuren.html) for a fuller definition of these terms.<br> |

## <span class="content"> Appendix B: Effects of <a href="#propdef-display" id="ref-for-propdef-display③⑨" class="css" data-link-type="propdesc">display: contents</a> on Unusual Elements</span><a href="#unbox" class="self-link"></a>

*This section is (currently) non-normative.*

Some elements aren’t rendered purely by CSS box concepts; for example, replaced elements (such as <a href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element" id="ref-for-the-img-element①" data-link-type="element"><code>img</code></a>), many form controls (such as <a href="https://html.spec.whatwg.org/multipage/input.html#the-input-element" id="ref-for-the-input-element" data-link-type="element"><code>input</code></a>), and SVG elements.

This appendix defines how they interact with <a href="#propdef-display" id="ref-for-propdef-display④⓪" class="css" data-link-type="propdesc">display: contents</a>.

### <span class="content">HTML Elements</span><a href="#unbox-html" class="self-link"></a>

<a href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-br-element" id="ref-for-the-br-element" data-link-type="element"><code>br</code></a>  
<a href="https://html.spec.whatwg.org/multipage/text-level-semantics.html#the-wbr-element" id="ref-for-the-wbr-element" data-link-type="element"><code>wbr</code></a>  
<a href="https://html.spec.whatwg.org/multipage/form-elements.html#the-meter-element" id="ref-for-the-meter-element" data-link-type="element"><code>meter</code></a>  
<a href="https://html.spec.whatwg.org/multipage/form-elements.html#the-progress-element" id="ref-for-the-progress-element" data-link-type="element"><code>progress</code></a>  
<a href="https://html.spec.whatwg.org/multipage/canvas.html#canvas" id="ref-for-canvas" data-link-type="element"><code>canvas</code></a>  
<a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-embed-element" id="ref-for-the-embed-element" data-link-type="element"><code>embed</code></a>  
<a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-object-element" id="ref-for-the-object-element" data-link-type="element"><code>object</code></a>  
<a href="https://html.spec.whatwg.org/multipage/media.html#audio" id="ref-for-audio" data-link-type="element"><code>audio</code></a>  
<a href="https://html.spec.whatwg.org/multipage/iframe-embed-object.html#the-iframe-element" id="ref-for-the-iframe-element" data-link-type="element"><code>iframe</code></a>  
<a href="https://html.spec.whatwg.org/multipage/embedded-content.html#the-img-element" id="ref-for-the-img-element②" data-link-type="element"><code>img</code></a>  
<a href="https://html.spec.whatwg.org/multipage/media.html#video" id="ref-for-video" data-link-type="element"><code>video</code></a>  
<a href="https://html.spec.whatwg.org/multipage/obsolete.html#frame" id="ref-for-frame" data-link-type="element"><code>frame</code></a>  
<a href="https://html.spec.whatwg.org/multipage/obsolete.html#frameset" id="ref-for-frameset" data-link-type="element"><code>frameset</code></a>  
<a href="https://html.spec.whatwg.org/multipage/input.html#the-input-element" id="ref-for-the-input-element①" data-link-type="element"><code>input</code></a>  
<a href="https://html.spec.whatwg.org/multipage/form-elements.html#the-textarea-element" id="ref-for-the-textarea-element" data-link-type="element"><code>textarea</code></a>  
<a href="https://html.spec.whatwg.org/multipage/form-elements.html#the-select-element" id="ref-for-the-select-element" data-link-type="element"><code>select</code></a>  
<a href="#propdef-display" id="ref-for-propdef-display④①" class="css" data-link-type="propdesc">display: contents</a> computes to <span id="ref-for-propdef-display④②" class="css">display: none</span>.

<a href="https://html.spec.whatwg.org/multipage/form-elements.html#the-legend-element" id="ref-for-the-legend-element①" data-link-type="element"><code>legend</code></a>  
Per HTML, a <a href="https://html.spec.whatwg.org/multipage/form-elements.html#the-legend-element" id="ref-for-the-legend-element②" data-link-type="element"><code>legend</code></a> with <a href="#propdef-display" id="ref-for-propdef-display④③" class="css" data-link-type="propdesc">display: contents</a> is not a <a href="https://html.spec.whatwg.org/multipage/rendering.html#rendered-legend" id="ref-for-rendered-legend" data-link-type="dfn">rendered legend</a>, so it does not have magical display behavior. (Thus, it reacts to <span id="ref-for-propdef-display④④" class="css">display: contents</span> normally.)

<a href="https://html.spec.whatwg.org/multipage/form-elements.html#the-button-element" id="ref-for-the-button-element" data-link-type="element"><code>button</code></a>  
<a href="https://html.spec.whatwg.org/multipage/interactive-elements.html#the-details-element" id="ref-for-the-details-element" data-link-type="element"><code>details</code></a>  
<a href="https://html.spec.whatwg.org/multipage/form-elements.html#the-fieldset-element" id="ref-for-the-fieldset-element①" data-link-type="element"><code>fieldset</code></a>  
These elements don’t have any special behavior; <a href="#propdef-display" id="ref-for-propdef-display④⑤" class="css" data-link-type="propdesc">display: contents</a> simply removes their <a href="#principal-box" id="ref-for-principal-box①①" data-link-type="dfn">principal box</a>, and their contents render as normal.

any other HTML element  
Behaves as normal for <a href="#propdef-display" id="ref-for-propdef-display④⑥" class="css" data-link-type="propdesc">display: contents</a>.

### <span class="content">SVG Elements</span><a href="#unbox-svg" class="self-link"></a>

An <a href="https://www.w3.org/TR/SVG2/struct.html#elementdef-svg" id="ref-for-elementdef-svg" data-link-type="element"><code>svg</code></a> element that has CSS box layout (this includes all <a href="https://www.w3.org/TR/SVG2/struct.html#elementdef-svg" id="ref-for-elementdef-svg①" data-link-type="element"><code>svg</code></a> whose parent is an HTML element, as well as document root elements)  
<a href="#propdef-display" id="ref-for-propdef-display④⑦" class="css" data-link-type="propdesc">display: contents</a> computes to <span id="ref-for-propdef-display④⑧" class="css">display: none</span>.

All other SVG <a href="https://www.w3.org/TR/SVG2/struct.html#container-element" id="ref-for-container-element" data-link-type="dfn">container elements</a> that are also <a href="https://www.w3.org/TR/SVG2/render.html#TermRenderableElement" id="ref-for-TermRenderableElement" data-link-type="dfn">renderable elements</a>  
SVG <a href="https://svgwg.org/svg2-draft/text.html#TermTextContentChildElement" id="ref-for-TermTextContentChildElement" data-link-type="dfn">text content child elements</a>  
<a href="https://www.w3.org/TR/SVG2/struct.html#elementdef-use" id="ref-for-elementdef-use" data-link-type="element"><code>use</code></a>  
<a href="#propdef-display" id="ref-for-propdef-display④⑨" class="css" data-link-type="propdesc">display: contents</a> strips the element from the formatting tree, and hoists its contents up to display in its place. These contents include the shadow-DOM content for <a href="https://www.w3.org/TR/SVG2/struct.html#elementdef-use" id="ref-for-elementdef-use①" data-link-type="element"><code>use</code></a>.

any other SVG elements  
<a href="#propdef-display" id="ref-for-propdef-display⑤⓪" class="css" data-link-type="propdesc">display: contents</a> computes to <span id="ref-for-propdef-display⑤①" class="css">display: none</span>.

<div class="note" role="note">

The intention here is that the <a href="#propdef-display" id="ref-for-propdef-display⑤②" class="css" data-link-type="propdesc">display: none</a> behavior applies whenever the "rendering context" inside the element is different than the context outside of it. If the element’s child elements would not be valid children of the element’s parent, you cannot simply hoist them up the formatting tree.

For example, text content and text formatting elements in SVG require a <a href="https://www.w3.org/TR/SVG2/text.html#elementdef-text" id="ref-for-elementdef-text" data-link-type="element"><code>text</code></a> element context; if you remove a <a href="https://www.w3.org/TR/SVG2/text.html#elementdef-text" id="ref-for-elementdef-text①" data-link-type="element"><code>text</code></a>, its child text content and elements are no longer valid. For that reason, <a href="#propdef-display" id="ref-for-propdef-display⑤③" class="css" data-link-type="propdesc">display: contents</a> on <a href="https://www.w3.org/TR/SVG2/text.html#elementdef-text" id="ref-for-elementdef-text②" data-link-type="element"><code>text</code></a> prevents the entire text element from being rendered. In contrast, any valid content inside a <a href="https://www.w3.org/TR/SVG2/text.html#elementdef-tspan" id="ref-for-elementdef-tspan" data-link-type="element"><code>tspan</code></a> or <a href="https://www.w3.org/TR/SVG2/text.html#elementdef-textPath" id="ref-for-elementdef-textPath" data-link-type="element"><code>textPath</code></a> is also valid content inside the parent text formatting context, so the hoisting behavior applies for these elements.

Similarly, if hoisting would convert the children from <a href="https://www.w3.org/TR/SVG2/render.html#TermNonRenderedElement" id="ref-for-TermNonRenderedElement" data-link-type="dfn">non-rendered elements</a> (e.g., a shape inside a <a href="https://www.w3.org/TR/SVG2/pservers.html#elementdef-pattern" id="ref-for-elementdef-pattern" data-link-type="element"><code>pattern</code></a> or <a href="https://www.w3.org/TR/SVG2/struct.html#elementdef-symbol" id="ref-for-elementdef-symbol" data-link-type="element"><code>symbol</code></a>) to <a href="https://www.w3.org/TR/SVG2/render.html#TermRenderedElement" id="ref-for-TermRenderedElement" data-link-type="dfn">rendered elements</a> (e.g., a shape that is a direct child of the <a href="https://www.w3.org/TR/SVG2/struct.html#elementdef-svg" id="ref-for-elementdef-svg②" data-link-type="element"><code>svg</code></a>), that is an invalid change of rendering context. Never-rendered container elements therefore cannot be "un-boxed" by <a href="#propdef-display" id="ref-for-propdef-display⑤④" class="css" data-link-type="propdesc">display: contents</a>.

</div>

When an element is stripped from the formatting tree, then any SVG attributes on that element that control layout and visual formatting are ignored when rendering the contents. However, SVG <a href="https://www.w3.org/TR/SVG2/styling.html#TermPresentationAttribute" id="ref-for-TermPresentationAttribute" data-link-type="dfn">presentation attributes</a>—which map to CSS properties—continue to affect value processing and inheritance <a href="#biblio-css-cascade-3" data-link-type="biblio" title="CSS Cascading and Inheritance Level 3">[CSS-CASCADE-3]</a>; thus such attributes can affect the layout and visual formatting of the element’s descendants by influencing the values of such properties on those descendants.

### <span class="content">MathML Elements</span><a href="#unbox-mathml" class="self-link"></a>

For all MathML elements, <a href="#propdef-display" id="ref-for-propdef-display⑤⑤" class="css" data-link-type="propdesc">display: contents</a> computes to <span id="ref-for-propdef-display⑤⑥" class="css">display: none</span>.

## <span class="content"> Appendix C: Box Construction Guidelines for Spec Authors</span><a href="#box-guidelines" class="self-link"></a>

*This section is non-normative guidance for specification authors.*

- A box cannot be <a href="#blockify" id="ref-for-blockify⑧" data-link-type="dfn">blockified</a> and <a href="#inlinify" id="ref-for-inlinify⑦" data-link-type="dfn">inlinified</a> at the same time; if such a thing would occur, define which wins over the other.

- Non-principal non-anonymous boxes can’t be <a href="#blockify" id="ref-for-blockify⑨" data-link-type="dfn">blockified</a>: blockification affects the element’s computed values and thus determines the type of its <a href="#principal-box" id="ref-for-principal-box①②" data-link-type="dfn">principal box</a>.

- Boxes which <a href="#blockify" id="ref-for-blockify①⓪" data-link-type="dfn">blockify</a> their contents can’t directly contain <a href="#inline-level" id="ref-for-inline-level⑦" data-link-type="dfn">inline-level</a> content; any boxes or text sequences generated within such an element must be <span id="ref-for-blockify①①">blockified</span> or wrapped in an <a href="#anonymous" id="ref-for-anonymous③" data-link-type="dfn">anonymous</a> <a href="#block-container" id="ref-for-block-container①⑥" data-link-type="dfn">block container</a>.

- Boxes which <a href="#inlinify" id="ref-for-inlinify⑧" data-link-type="dfn">inlinify</a> their contents can’t directly contain <a href="#block-level" id="ref-for-block-level⑦" data-link-type="dfn">block-level</a> boxes; any boxes generated within such an element must be <a href="#inline-level" id="ref-for-inline-level⑧" data-link-type="dfn">inline-level</a>.

- Boxes that fundamentally cannot establish an <a href="#independent-formatting-context" id="ref-for-independent-formatting-context⑥" data-link-type="dfn">independent formatting context</a> (such as non-replaced inlines) must not be asked to <a href="#establish-an-independent-formatting-context" id="ref-for-establish-an-independent-formatting-context⑤" data-link-type="dfn">establish an independent formatting context</a>. Blockify them first, or otherwise change their box type to one that can establish an <span id="ref-for-independent-formatting-context⑦">independent formatting context</span>.

## <span class="content"> Acknowledgments</span><a href="#acknowledgments" class="self-link"></a>

We would like to thank the many people who have attempted to separate out the disparate details of box generation over the years, most particularly Bert Bos, whose last attempt with <span class="property css" link-type="property">display-model</span> and <span class="property">display-role</span> didn’t get anywhere, but primed us for the current spec; Anton Prowse, whose relentless assault on CSS2.1 Chapter 9 forced some order out of the chaos; and Oriol Brufau, who teased apart dozens of fine distinctions and errors in this spec. Honorable mentions also go to David Baron, Mats Palmgren, Ilya Streltsyn, and Boris Zbarsky for their feedback.

## <span class="content"> Changes</span><a href="#changes" class="self-link"></a>

### <span class="content"> Changes Since 2020 Candidate Recommendation</span><a href="#changes-2020" class="self-link"></a>

A [Disposition of Comments](https://drafts.csswg.org/css-display-3/issues-cr-2020) since the [19 May 2020 Candidate Recommendation](https://www.w3.org/TR/2020/CR-css-display-3-20200519/) is available.

Changes since the [19 May 2020 Candidate Recommendation](https://www.w3.org/TR/2020/CR-css-display-3-20200519/) include:

- <span id="change-text-run-sequence"><a href="#change-text-run-sequence" class="self-link"></a> Renamed “text run” to “<a href="#css-text-sequence" id="ref-for-css-text-sequence①⓪" data-link-type="dfn">text sequence</a>”. ([Issue 7768](https://github.com/w3c/csswg-drafts/issues/7768))</span>

- <span id="change-root-layout"><a href="#change-root-layout" class="self-link"></a> Defined <a href="#root-element" id="ref-for-root-element②" data-link-type="dfn">root element</a> and clarified its layout as a <a href="#block-level" id="ref-for-block-level⑧" data-link-type="dfn">block-level</a> in [§ 2.8 The Root Element’s Principal Box](#root) and the definition of <a href="#initial-containing-block" id="ref-for-initial-containing-block④" data-link-type="dfn">initial containing block</a>. ([PR 8095](https://github.com/w3c/csswg-drafts/pull/8095), [Issue 7207](https://github.com/w3c/csswg-drafts/issues/7207), [Issue 6480](https://github.com/w3c/csswg-drafts/issues/6480), [Issue 7786](https://github.com/w3c/csswg-drafts/issues/7786))</span>

- <span id="change-move-order"><a href="#change-move-order" class="self-link"></a> Pulled in the <a href="#propdef-order" id="ref-for-propdef-order①⑥" class="property css" data-link-type="property">order</a> property definition from <a href="#biblio-css-flexbox-1" data-link-type="biblio" title="CSS Flexible Box Layout Module Level 1">[CSS-FLEXBOX-1]</a>, since it also applies to <a href="https://www.w3.org/TR/css-grid-2/#grid-item" id="ref-for-grid-item⑤" data-link-type="dfn">grid items</a>. ([Issue 5865](https://github.com/w3c/csswg-drafts/issues/5865))</span>

- <span id="change-import-visibility"><a href="#change-import-visibility" class="self-link"></a> Imported the <a href="#propdef-visibility" id="ref-for-propdef-visibility⑤" class="property css" data-link-type="property">visibility</a> property definition from <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a> and updated it to be more thorough and complete. ([Issue 6123](https://github.com/w3c/csswg-drafts/issues/6123))</span>

- <span id="change-internal-replaced"><a href="#change-internal-replaced" class="self-link"></a> Defined that <a href="#replaced-element" id="ref-for-replaced-element⑧" data-link-type="dfn">replaced elements</a> with a <a href="#layout-internal" id="ref-for-layout-internal⑤" data-link-type="dfn">layout-internal</a> <a href="#propdef-display" id="ref-for-propdef-display⑤⑦" class="property css" data-link-type="property">display</a> are treated as <span id="ref-for-propdef-display⑤⑧" class="css">display: inline</span>. ([Issue 6000](https://github.com/w3c/csswg-drafts/issues/6000))</span>

- <span id="change-legacy-computation"><a href="#change-legacy-computation" class="self-link"></a> Clarified that the <a href="#typedef-display-legacy" id="ref-for-typedef-display-legacy②" class="production css" data-link-type="type" title="Expands to: inline-block | inline-flex | inline-grid | inline-table">&lt;display-legacy&gt;</a> values actually <a href="https://www.w3.org/TR/css-cascade-5/#computed-value" id="ref-for-computed-value③" data-link-type="dfn">compute</a> to the same value as their two-keyword equivalents. ([Issue 5575](https://github.com/w3c/csswg-drafts/issues/5575))</span>

  > inline-…  
  > ~~Behaves as~~ <u>Computes to</u> <span class="css">inline …</span>.
  >
  > <u>Note: Although these keywords and their equivalents compute to the same value, their <a href="https://www.w3.org/TR/css-cascade-5/#specified-value" id="ref-for-specified-value①" data-link-type="dfn">specified values</a> remain distinct.</u>
  >
  > <u>Note: The <a href="https://www.w3.org/TR/cssom-1/#dom-window-getcomputedstyle" id="ref-for-dom-window-getcomputedstyle②" data-link-type="idl"><code class="idl">getComputedStyle()</code></a> serialization rules will always output these precomposed keywords rather than the equivalent two-keyword pairs due to the [shortest, most backwards-compatible serialization principle](https://www.w3.org/TR/cssom-1/#serializing-css-values).</u>

- <span id="change-blockification-computed"><a href="#change-blockification-computed" class="self-link"></a> Clarified that <a href="#blockify" id="ref-for-blockify①②" data-link-type="dfn">blockification</a> and <a href="#inlinify" id="ref-for-inlinify⑨" data-link-type="dfn">inlinification</a> are <a href="https://www.w3.org/TR/css-cascade-5/#computed-value" id="ref-for-computed-value④" data-link-type="dfn">computed value</a> changes. ([Issue 6251](https://github.com/w3c/csswg-drafts/issues/6251))</span>

  > Some layout effects require <a href="#blockify" id="ref-for-blockify①③" data-link-type="dfn">blockification</a> or <a href="#inlinify" id="ref-for-inlinify①⓪" data-link-type="dfn">inlinification</a> of the box type, which sets the box’s <u><a href="https://www.w3.org/TR/css-cascade-5/#computed-value" id="ref-for-computed-value⑤" data-link-type="dfn">computed</a></u> <a href="#outer-display-type" id="ref-for-outer-display-type①①" data-link-type="dfn">outer display type</a> to <a href="#valdef-display-block" id="ref-for-valdef-display-block⑨" class="css" data-link-type="maybe">block</a> or <a href="#valdef-display-inline" id="ref-for-valdef-display-inline⑧" class="css" data-link-type="maybe">inline</a> (respectively).

- <span id="change-block-layout-def"><a href="#change-block-layout-def" class="self-link"></a> Added definition for <a href="#block-layout" id="ref-for-block-layout①" data-link-type="dfn">block layout</a> to glossary, for convenience.</span>

- <span id="change-grid-refs"><a href="#change-grid-refs" class="self-link"></a> Updated references to [CSS Grid Layout](https://www.w3.org/TR/css-grid/).</span>

- <span id="change-2020-editorial"><a href="#change-2020-editorial" class="self-link"></a> Various minor editorial clarifications and cross-linking improvements.</span>

### <span class="content"> Changes Since 2019 Candidate Recommendation</span><a href="#changes-2019" class="self-link"></a>

Changes since the [11 July 2019 Candidate Recommendation](https://www.w3.org/TR/2019/CR-css-display-3-20190711/) include:

- <span id="change-containing-block"><a href="#change-containing-block" class="self-link"></a> Merged in additional prose from <a href="#biblio-css2" data-link-type="biblio" title="Cascading Style Sheets Level 2 Revision 1 (CSS 2.1) Specification">[CSS2]</a> into the definition of <a href="#containing-block" id="ref-for-containing-block①②" data-link-type="dfn">containing block</a>.</span>

- <span id="change-dom-ignore"><a href="#change-dom-ignore" class="self-link"></a> Clarified that, for the purpose of CSS, DOM nodes other than elements and text are ignored.</span>

  > <u>(Some source documents start from more complex trees, such as the DOM, which can have comment nodes and other types of things. For the purposes of CSS, all of these additional types of nodes are ignored, as if they didn’t exist.)</u>

- <span id="change-abspos-glossary"><a href="#change-abspos-glossary" class="self-link"></a> Improved/moved glossary definitions relating to <a href="https://www.w3.org/TR/css-position-3/#absolute-position" id="ref-for-absolute-position②" data-link-type="dfn">absolute positioning</a>.</span>

Changes since the [28 August 2018 Candidate Recommendation](https://www.w3.org/TR/2018/CR-css-display-3-20180828/) include:

- <span id="change-parent"><a href="#change-parent" class="self-link"></a> Defined box tree parentage; see <a href="#css-parent-box" id="ref-for-css-parent-box" data-link-type="dfn">parent box</a>.</span>
- <span id="change-abspos"><a href="#change-abspos" class="self-link"></a> Added definition of <a href="https://www.w3.org/TR/css-position-3/#absolute-position" id="ref-for-absolute-position③" data-link-type="dfn">absolutely positioned</a> to the glossary; [copied from CSS2](https://www.w3.org/TR/CSS2/visuren.html#absolutely-positioned) for easier referencing.</span>
- <span id="change-bidi-fragment"><a href="#change-bidi-fragment" class="self-link"></a> Added cross-references to various forms of fragmentation in [§ 1 Introduction](#intro).</span>
- <span id="change-table-grid-box"><a href="#change-table-grid-box" class="self-link"></a> Renamed “table box” to “table grid box” to more easily distinguish from “table wrapper box”.</span>
- <span id="change-body-propagation"><a href="#change-body-propagation" class="self-link"></a> Added “unless otherwise specified” to root → initial containing block propagation, since there are some regrettable special exceptions for the HTML <a href="https://html.spec.whatwg.org/multipage/sections.html#the-body-element" id="ref-for-the-body-element" data-link-type="element"><code>body</code></a> element.</span>

### <span class="content"> Changes Prior to Candidate Recommendation Status</span><a href="#changes-wd" class="self-link"></a>

A [Disposition of Comments](https://drafts.csswg.org/css-display-3/issues-wd-2017) is available.

Changes since the [20 April 2018 Working Draft](https://www.w3.org/TR/2018/WD-css-display-3-20180420/) include:

- Elements with <a href="#propdef-display" id="ref-for-propdef-display⑤⑨" class="css" data-link-type="propdesc">display: contents</a> that behave as <span id="ref-for-propdef-display⑥⓪" class="css">display: none</span> now *compute to* <span id="ref-for-propdef-display⑥①" class="css">display: none</span>. ([Issue 2755](https://github.com/w3c/csswg-drafts/issues/2755))
- Distinguished “new” <a href="#formatting-context" id="ref-for-formatting-context①⑦" data-link-type="dfn">formatting context</a> from <a href="#independent-formatting-context" id="ref-for-independent-formatting-context⑧" data-link-type="dfn">independent formatting context</a> since certain formatting contexts layer. ([Issue 2597](https://github.com/w3c/csswg-drafts/issues/2597), [Issue 1457](https://github.com/w3c/csswg-drafts/issues/1457))
- Defined that <a href="#block-box" id="ref-for-block-box⑨" data-link-type="dfn">block boxes</a> that establish an <a href="#independent-formatting-context" id="ref-for-independent-formatting-context⑨" data-link-type="dfn">independent formatting context</a> have a used <a href="#propdef-display" id="ref-for-propdef-display⑥②" class="property css" data-link-type="property">display</a> of <a href="#valdef-display-flow-root" id="ref-for-valdef-display-flow-root⑧" class="css" data-link-type="maybe">flow-root</a>, to provide an easier point of reference. ([Issue 1550](https://github.com/w3c/csswg-drafts/issues/1550))
- Clarified that <a href="#propdef-display" id="ref-for-propdef-display⑥③" class="property css" data-link-type="property">display</a> is not animatable (as opposed to discretely animatable). ([Issue 2938](https://github.com/w3c/csswg-drafts/issues/2938))
- Minor editorial fixes.

Changes since the [20 July 2017 Working Draft](https://www.w3.org/TR/2017/WD-css-display-3-20170720/) include:

- Tightened up rules for the <a href="#blockify" id="ref-for-blockify①④" data-link-type="dfn">blockification</a> of <a href="#valdef-display-inline-block" id="ref-for-valdef-display-inline-block②" class="css" data-link-type="maybe">inline-block</a> / <span class="css">inline flow-root</span> to ensure compatibility with CSS2. ([Issue 1246](https://github.com/w3c/csswg-drafts/issues/1246)) Updated handling of <span class="css">run-in flow-root</span> to match. ([Issue 1715](https://github.com/w3c/csswg-drafts/issues/1715))

- Adjusted grammar of <a href="#propdef-display" id="ref-for-propdef-display⑥④" class="property css" data-link-type="property">display</a> to list the <a href="#valdef-display-list-item" id="ref-for-valdef-display-list-item⑤" class="css" data-link-type="maybe">list-item</a> keyword last. This affects the expected serialization order. ([Issue 1621](https://github.com/w3c/csswg-drafts/issues/1621))

- Added better definition of interaction between <a href="#block-formatting-context" id="ref-for-block-formatting-context②⑥" data-link-type="dfn">block formatting contexts</a> and <a href="#inline-formatting-context" id="ref-for-inline-formatting-context⑨" data-link-type="dfn">inline formatting contexts</a> in block containers that establish inline formatting contexts. ([Issue 1553](https://github.com/w3c/csswg-drafts/issues/1553))

- More clearly defined the way property values are reflected between an element and its boxes (in the case of an element generating multiple boxes). ([Issue 1643](https://github.com/w3c/csswg-drafts/issues/1643))

- Clarified that empty text objects are ignored for CSS rendering. ([Issue 1808](https://github.com/w3c/csswg-drafts/issues/1808))

- Clarified that <a href="#propdef-display" id="ref-for-propdef-display⑥⑤" class="property css" data-link-type="property">display</a> has no effect on document semantics, since this is a common bug in UAs. ([Issue 2355](https://github.com/w3c/csswg-drafts/issues/2355))

- Fixed error in definition of <a href="#propdef-display" id="ref-for-propdef-display⑥⑥" class="property css" data-link-type="property">display</a>’s <a href="https://www.w3.org/TR/css-cascade-5/#computed-value" id="ref-for-computed-value⑥" data-link-type="dfn">computed value</a> (which is definitely not “as specified”, due to <a href="#blockify" id="ref-for-blockify①⑤" data-link-type="dfn">blockification</a> and <a href="#inlinify" id="ref-for-inlinify①①" data-link-type="dfn">inlinification</a> rules triggered by various properties). ([Issue 1716](https://github.com/w3c/csswg-drafts/issues/1716))

- Added definition for <a href="#document-order" id="ref-for-document-order" data-link-type="dfn">document order</a>.

- Added missing SVG elements to [Appendix B](#unbox)’s details on <a href="#propdef-display" id="ref-for-propdef-display⑥⑦" class="css" data-link-type="propdesc">display: contents</a> ([Issue 2118](https://github.com/w3c/csswg-drafts/issues/2118)), clarified effect of SVG attributes ([Issue 2502](https://github.com/w3c/csswg-drafts/issues/2502)), and defined behavior for MathML ([Issue 2167](https://github.com/w3c/csswg-drafts/issues/2167)).

- Added some [guidance](#box-guidelines) to future spec authors of anonymous box construction rules. ([Issue 1643](https://github.com/w3c/csswg-drafts/issues/1643))

- Pushed the section about “becoming a formatting context” back to [CSS Containment](https://www.w3.org/TR/css-contain-1/) where it is used.

- Various minor wording fixes and clarifications.

Changes since the [26 January 2017 Working Draft](https://www.w3.org/TR/2017/WD-css-display-3-20170126/) include:

- Remove <span class="css">inline-list-item</span> value that is equivalent to <span class="css">inline list-item</span>.

- Added the notion of “<a href="#text-nodes" id="ref-for-text-nodes⑥" data-link-type="dfn">text nodes</a>” to the <a href="#element-tree" id="ref-for-element-tree②" data-link-type="dfn">element tree</a>, and “<a href="#css-text-sequence" id="ref-for-css-text-sequence①①" data-link-type="dfn">text runs</a>” to the <a href="#box-tree" id="ref-for-box-tree⑨" data-link-type="dfn">box tree</a> to define behavior in the context of <a href="#propdef-display" id="ref-for-propdef-display⑥⑧" class="css" data-link-type="propdesc">display: contents</a>. ([Issue 19](https://drafts.csswg.org/css-display-3/issues-wd-2017#issue-19), [Issue 32](https://drafts.csswg.org/css-display-3/issues-wd-2017#issue-32))

- Defined that the root element is “in flow”. ([Issue 3](https://drafts.csswg.org/css-display-3/issues-wd-2017#issue-3))

- Defined interaction of <a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-first-line" id="ref-for-selectordef-first-line" class="css" data-link-type="maybe">::first-line</a>/<a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-first-letter" id="ref-for-selectordef-first-letter②" class="css" data-link-type="maybe">::first-letter</a> and <a href="#valdef-display-run-in" id="ref-for-valdef-display-run-in⑤" class="css" data-link-type="maybe">run-in</a>. ([Issue 5](https://drafts.csswg.org/css-display-3/issues-wd-2017#issue-5), [Issue 42](https://drafts.csswg.org/css-display-3/issues-wd-2017#issue-42))

- Clarified that block/inline/run-in only dictates behavior in <a href="#flow-layout" id="ref-for-flow-layout⑥" data-link-type="dfn">flow layout</a>; it is ignored in other contexts.

- Run-ins are a type of inline box, not just "like" an inline box.

- Fixed the lack of recursion in of run-in’s box-tree munging. ([Issue 45](https://drafts.csswg.org/css-display-3/issues-wd-2017#issue-45))

- Added an appendix on how <a href="#propdef-display" id="ref-for-propdef-display⑥⑨" class="css" data-link-type="propdesc">display: contents</a> works on “unusual elements”. ([Issue 8](https://drafts.csswg.org/css-display-3/issues-wd-2017#issue-8), [Issue 18](https://drafts.csswg.org/css-display-3/issues-wd-2017#issue-18))

- Fix <a href="#blockify" id="ref-for-blockify①⑥" data-link-type="dfn">blockification</a> and <a href="#inlinify" id="ref-for-inlinify①②" data-link-type="dfn">inlinification</a> rules, particularly handling of layout-internal types. ([Issue 35](https://drafts.csswg.org/css-display-3/issues-wd-2017#issue-35), [Issue 57](https://drafts.csswg.org/css-display-3/issues-wd-2017#issue-57))

- Clarified interaction of various box tree fixups. ([Issue 38](https://drafts.csswg.org/css-display-3/issues-wd-2017#issue-38), [Issue 48](https://drafts.csswg.org/css-display-3/issues-wd-2017#issue-48))

- Added the definition of “becoming a formatting context”.

- Miscellaneous minor fixes and minor clarifications.

A [Disposition of Comments](https://drafts.csswg.org/css-display-3/issues-wd-2017) is also available.

Changes since the [15 October 2015 Working Draft](https://www.w3.org/TR/2015/WD-css-display-3-20151015/) include:

- Deferred the <span class="css">box-suppress/display-or-not</span> property to the next level of Display, in order to provide time for further discussion of use cases.
- Specified the effects of <a href="#propdef-display" id="ref-for-propdef-display⑦⓪" class="css" data-link-type="propdesc">display: contents</a> on unusual elements such as replaced elements and form controls.
- Clarified that an element’s <a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-before" id="ref-for-selectordef-before②" class="css" data-link-type="maybe">::before</a> and <a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-after" id="ref-for-selectordef-after①" class="css" data-link-type="maybe">::after</a> pseudo-elements still exist if its own box is not generated due to <a href="#propdef-display" id="ref-for-propdef-display⑦①" class="css" data-link-type="propdesc">display: contents</a>.
- Clarified that event bubbling is not affected by <a href="#propdef-display" id="ref-for-propdef-display⑦②" class="css" data-link-type="propdesc">display: contents</a>.
- Clarified interaction of run-ins with out-of-flow elements and <a href="https://www.w3.org/TR/css-pseudo-4/#selectordef-first-letter" id="ref-for-selectordef-first-letter③" class="css" data-link-type="maybe">::first-letter</a>.
- Switched <a href="#valdef-display-table-caption" id="ref-for-valdef-display-table-caption①" class="css" data-link-type="maybe">table-caption</a> and <a href="#valdef-display-table-cell" id="ref-for-valdef-display-table-cell②" class="css" data-link-type="maybe">table-cell</a> to use <a href="#valdef-display-flow-root" id="ref-for-valdef-display-flow-root⑨" class="css" data-link-type="maybe">flow-root</a> as their <a href="#inner-display-type" id="ref-for-inner-display-type①⑧" data-link-type="dfn">inner display type</a>, since they always form a formatting context root.
- Closed off remaining issues and added at-risk list.

Changes since the [21 July 2015 Working Draft](https://www.w3.org/TR/2015/WD-css-display-3-20150721/) include:

- Added definitions for <a href="#in-flow" id="ref-for-in-flow①" data-link-type="dfn">in-flow</a> and <a href="#out-of-flow" id="ref-for-out-of-flow④" data-link-type="dfn">out-of-flow</a> to glossary.

Changes since the [11 September 2014 Working Draft](https://www.w3.org/TR/2014/WD-css-display-3-20140911/) include:

- Removed <span class="css">display-inside</span>, <span class="css">display-outside</span>, and <span class="css">display-extras</span> longhands, in favor of just making <a href="#propdef-display" id="ref-for-propdef-display⑦③" class="property css" data-link-type="property">display</a> multi-value. (This was done to impose constraints on what can be combined. Future levels of this specification may relax some or all of those restrictions if they become unnecessary or unwanted.)
- Created the <a href="#valdef-display-flow" id="ref-for-valdef-display-flow⑨" class="css" data-link-type="maybe">flow</a> and <a href="#valdef-display-flow-root" id="ref-for-valdef-display-flow-root①⓪" class="css" data-link-type="maybe">flow-root</a> <a href="#inner-display-type" id="ref-for-inner-display-type①⑨" data-link-type="dfn">inner display types</a> to better express flow layout <a href="#display-type" id="ref-for-display-type③" data-link-type="dfn">display types</a> and to create an explicit switch for making an element a <a href="#bfc" id="ref-for-bfc①" data-link-type="dfn">BFC</a> root. (This should eliminate the need for hacks like <span class="css">::after { clear: both; }</span> and <a href="https://drafts.csswg.org/css2/#propdef-overflow" id="ref-for-propdef-overflow②" class="css" data-link-type="propdesc">overflow: hidden</a> that are intended to accomplish this purpose.)

## <span class="content"> Privacy Considerations</span><a href="#priv" class="self-link"></a>

This specification introduces no new privacy considerations.

### <span class="content"> Security Considerations</span><a href="#sec" class="self-link"></a>

This specification introduces no new security considerations.

### <span class="content"> Self-Review Questionaire</span><a href="#security-privacy-self-review" class="self-link"></a>

Per the [Self-Review Questionnaire: Security and Privacy: Questions to Consider](https://www.w3.org/TR/security-privacy-questionnaire/#questions)

1.  Does this specification deal with personally-identifiable information?

    No.

2.  Does this specification deal with high-value data?

    No.

3.  Does this specification introduce new state for an origin that persists across browsing sessions?

    No.

4.  Does this specification expose persistent, cross-origin state to the web?

    No.

5.  Does this specification expose any other data to an origin that it doesn’t currently have access to?

    No.

6.  Does this specification enable new script execution/loading mechanisms?

    No.

7.  Does this specification allow an origin access to a user’s location?

    No.

8.  Does this specification allow an origin access to sensors on a user’s device?

    No.

9.  Does this specification allow an origin access to aspects of a user’s local computing environment?

    No.

10. Does this specification allow an origin access to other devices?

    No.

11. Does this specification allow an origin some measure of control over a user agent’s native UI?

    No.

12. Does this specification expose temporary identifiers to the web?

    No.

13. Does this specification distinguish between behavior in first-party and third-party contexts?

    No.

14. How should this specification work in the context of a user agent’s "incognito" mode?

    No differently.

15. Does this specification persist data to a user’s local device?

    No.

16. Does this specification have a "Security Considerations" and "Privacy Considerations" section?

    Yes.

17. Does this specification allow downgrading default security characteristics?

    No.
<!-- END VERBATIM SPEC: DO NOT EDIT ABOVE. -->


## Documentation and coding standards
## Documentation and coding standards


- All public functions must include spec links with exact section anchors.
- All public functions must include spec links with exact section anchors.
- Modules mirror spec chapters (`anonymous_blocks.rs`, `inline_formatting.rs`, etc.).
- Modules mirror spec chapters (`anonymous_blocks.rs`, `inline_formatting.rs`, etc.).
- Files kept under ~500 lines; imports at the top; avoid fully qualified paths (use imports/aliases).
- Files kept under ~500 lines; imports at the top; avoid fully qualified paths (use imports/aliases).
- Mark non-production behavior `[MVP]`, `[Approximation]`, or `[Heuristic]` and link back here.
- Mark non-production behavior `[MVP]`, `[Approximation]`, or `[Heuristic]` and link back here.


## Future work
## Future work


- [ ] Implement anonymous block synthesis and export to layouter.
- [ ] Implement anonymous block synthesis and export to layouter.
- [ ] Implement inline formatting context with line boxes.
- [ ] Implement inline formatting context with line boxes.
- [ ] Add whitespace collapsing and inline flow edge cases.
- [ ] Add whitespace collapsing and inline flow edge cases.
